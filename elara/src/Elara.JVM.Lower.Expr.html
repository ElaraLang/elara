<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Expr.html"><span class="hs-identifier">Elara.JVM.Lower.Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.JVM.Lower.Expr.html#lowerExpr"><span class="hs-identifier">lowerExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful</span></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.Error.Static</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Name.html"><span class="hs-identifier">Elara.AST.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier">Qualified</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#unqualified"><span class="hs-identifier">unqualified</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html"><span class="hs-identifier">Elara.AST.VarRef</span></a></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Core.html"><span class="hs-identifier">Elara.Core</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Core.Analysis.html"><span class="hs-identifier">Elara.Core.Analysis</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Core.Generic.html"><span class="hs-identifier">Elara.Core.Generic</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.JVM.Error.html"><span class="hs-identifier">Elara.JVM.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.JVM.Error.html#JVMLoweringError"><span class="hs-identifier">JVMLoweringError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.JVM.IR.html"><span class="hs-identifier">Elara.JVM.IR</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IR</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Function.html"><span class="hs-identifier">Elara.JVM.Lower.Function</span></a></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Match.html"><span class="hs-identifier">Elara.JVM.Lower.Match</span></a></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Monad.html"><span class="hs-identifier">Elara.JVM.Lower.Monad</span></a></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Util.html"><span class="hs-identifier">Elara.JVM.Lower.Util</span></a></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Logging.html"><span class="hs-identifier">Elara.Logging</span></a></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">JVM.Data.Abstract.Descriptor</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JVM</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">JVM.Data.Abstract.Type</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">JVM</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">JVM.Data.Convert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">jloName</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Print.html"><span class="hs-identifier">Print</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Print.html#showPretty"><span class="hs-identifier">showPretty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span id="local-6989586621680176211"><span class="annot"><a href="Elara.JVM.Lower.Expr.html#lowerExpr"><span class="hs-identifier hs-type">lowerExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Monad.html#InnerLower"><span class="hs-identifier hs-type">InnerLower</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176211"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Core.html#CoreExpr"><span class="hs-identifier hs-type">Core.CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680176211"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.JVM.IR.html#Expr"><span class="hs-identifier hs-type">IR.Expr</span></a></span></span><span>
</span><span id="line-23"></span><span id="lowerExpr"><span class="annot"><span class="annottext">lowerExpr :: forall (r :: [Effect]). InnerLower r =&gt; CoreExpr -&gt; Eff r Expr
</span><a href="Elara.JVM.Lower.Expr.html#lowerExpr"><span class="hs-identifier hs-var hs-var">lowerExpr</span></a></span></span><span> </span><span id="local-6989586621680176335"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176335"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176335"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-comment">-- Erase type applications</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Elara.Core.html#TyApp"><span class="hs-identifier hs-type">Core.TyApp</span></a></span><span> </span><span id="local-6989586621680176337"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176337"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Eff r Expr
forall (r :: [Effect]). InnerLower r =&gt; CoreExpr -&gt; Eff r Expr
</span><a href="Elara.JVM.Lower.Expr.html#lowerExpr"><span class="hs-identifier hs-var">lowerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176337"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Elara.Core.html#Lit"><span class="hs-identifier hs-type">Core.Lit</span></a></span><span> </span><span id="local-6989586621680176339"><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621680176339"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Eff r Expr
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Literal -&gt; Expr
</span><a href="Elara.JVM.Lower.Util.html#lowerLiteral"><span class="hs-identifier hs-var">lowerLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Literal
</span><a href="#local-6989586621680176339"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Elara.Core.html#Var"><span class="hs-identifier hs-type">Core.Var</span></a></span><span> </span><span class="annot"><span class="annottext">Var
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Expr] -&gt; Eff r Expr
forall (r :: [Effect]).
InnerLower r =&gt;
CoreExpr -&gt; [Expr] -&gt; Eff r Expr
</span><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-var">unwindCall</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176335"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Elara.Core.html#App"><span class="hs-identifier hs-type">Core.App</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Expr] -&gt; Eff r Expr
forall (r :: [Effect]).
InnerLower r =&gt;
CoreExpr -&gt; [Expr] -&gt; Eff r Expr
</span><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-var">unwindCall</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176335"><span class="hs-identifier hs-var">expr</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Elara.Core.html#Let"><span class="hs-identifier hs-type">Core.Let</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.Generic.html#NonRecursive"><span class="hs-identifier hs-type">Core.NonRecursive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#Id"><span class="hs-identifier hs-type">Core.Id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span id="local-6989586621680176348"><span class="annot"><span class="annottext">VarRefImpl UnlocatedVarRefKind (Unique Text)
</span><a href="#local-6989586621680176348"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680176349"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680176349"><span class="hs-identifier hs-var">idType</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe DataCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680176350"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176350"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680176351"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176351"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-30"></span><span>        </span><span id="local-6989586621680176352"><span class="annot"><a href="#local-6989586621680176352"><span class="hs-identifier hs-var">valExpr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Eff r Expr
forall (r :: [Effect]). InnerLower r =&gt; CoreExpr -&gt; Eff r Expr
</span><a href="Elara.JVM.Lower.Expr.html#lowerExpr"><span class="hs-identifier hs-var">lowerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176350"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-31"></span><span>        </span><span class="hs-comment">-- If the value is a closure/wrapper, use the interface type, otherwise use the variable type</span><span>
</span><span id="line-32"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680176353"><span class="annot"><a href="#local-6989586621680176353"><span class="hs-identifier hs-var hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680176352"><span class="hs-identifier hs-var">valExpr</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-33"></span><span>                </span><span class="annot"><a href="Elara.JVM.IR.html#MakeClosure"><span class="hs-identifier hs-type">IR.MakeClosure</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">closureInterface :: Expr -&gt; QualifiedClassName
</span><a href="Elara.JVM.IR.html#closureInterface"><span class="hs-identifier hs-var">IR.closureInterface</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680176356"><span class="annot"><span class="annottext">QualifiedClassName
</span><a href="#local-6989586621680176356"><span class="hs-identifier hs-var">iface</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QualifiedClassName -&gt; FieldType
</span><span class="hs-identifier hs-var">JVM.ObjectFieldType</span></span><span> </span><span class="annot"><span class="annottext">QualifiedClassName
</span><a href="#local-6989586621680176356"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-34"></span><span>                </span><span class="annot"><a href="Elara.JVM.IR.html#MakeConstructorClosure"><span class="hs-identifier hs-type">IR.MakeConstructorClosure</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">ctorClosureInterface :: Expr -&gt; QualifiedClassName
</span><a href="Elara.JVM.IR.html#ctorClosureInterface"><span class="hs-identifier hs-var">IR.ctorClosureInterface</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680176360"><span class="annot"><span class="annottext">QualifiedClassName
</span><a href="#local-6989586621680176360"><span class="hs-identifier hs-var">iface</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QualifiedClassName -&gt; FieldType
</span><span class="hs-identifier hs-var">JVM.ObjectFieldType</span></span><span> </span><span class="annot"><span class="annottext">QualifiedClassName
</span><a href="#local-6989586621680176360"><span class="hs-identifier hs-var">iface</span></a></span><span>
</span><span id="line-35"></span><span>                </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FieldType
</span><a href="Elara.JVM.Lower.Util.html#lowerType"><span class="hs-identifier hs-var">lowerType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680176349"><span class="hs-identifier hs-var">idType</span></a></span><span>
</span><span id="line-36"></span><span>        </span><span class="annot"><a href="Elara.JVM.Lower.Monad.html#emitInst"><span class="hs-identifier hs-type">emitInst</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.JVM.IR.html#Assign"><span class="hs-identifier hs-type">IR.Assign</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176348"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176353"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176352"><span class="hs-identifier hs-type">valExpr</span></a></span><span>
</span><span id="line-37"></span><span>        </span><span class="annot"><a href="Elara.JVM.Lower.Expr.html#lowerExpr"><span class="hs-identifier hs-type">lowerExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176351"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Elara.Core.html#Match"><span class="hs-identifier hs-type">Core.Match</span></a></span><span> </span><span id="local-6989586621680176365"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176365"><span class="hs-identifier hs-var">scrutinee</span></a></span></span><span> </span><span id="local-6989586621680176366"><span class="annot"><span class="annottext">Maybe Var
</span><a href="#local-6989586621680176366"><span class="hs-identifier hs-var">binder</span></a></span></span><span> </span><span id="local-6989586621680176367"><span class="annot"><span class="annottext">[Alt Var]
</span><a href="#local-6989586621680176367"><span class="hs-identifier hs-var">alts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-39"></span><span>        </span><span id="local-6989586621680176368"><span class="annot"><a href="#local-6989586621680176368"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TraceableFn &quot;guesstimateExprType&quot; CoreExpr Type
-&gt; CoreExpr -&gt; Eff r Type
forall (name :: Symbol) a b (r :: [Effect]).
(Pretty a, Pretty b, StructuredDebug :&gt; r, KnownSymbol name,
 HasCallStack) =&gt;
TraceableFn name a b -&gt; a -&gt; Eff r b
</span><a href="Elara.Logging.html#traceFn"><span class="hs-identifier hs-var">traceFn</span></a></span><span> </span><span class="annot"><span class="annottext">TraceableFn &quot;guesstimateExprType&quot; CoreExpr Type
(HasCallStack, Pretty Type, Pretty CoreExpr) =&gt;
TraceableFn &quot;guesstimateExprType&quot; CoreExpr Type
</span><a href="Elara.Core.Analysis.html#guesstimateExprType"><span class="hs-identifier hs-var">guesstimateExprType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176335"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-40"></span><span>        </span><span class="annot"><a href="Elara.JVM.Lower.Match.html#lowerMatch"><span class="hs-identifier hs-type">lowerMatch</span></a></span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Expr.html#lowerExpr"><span class="hs-identifier hs-type">lowerExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176368"><span class="hs-identifier hs-type">ty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176365"><span class="hs-identifier hs-type">scrutinee</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176366"><span class="hs-identifier hs-type">binder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176367"><span class="hs-identifier hs-type">alts</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span id="local-6989586621680176374"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176374"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">JVMLoweringError -&gt; Eff r Expr
forall e (es :: [Effect]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(JVMLoweringError -&gt; Eff r Expr) -&gt; JVMLoweringError -&gt; Eff r Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; JVMLoweringError
</span><a href="Elara.JVM.Error.html#UnsupportedExpressionType"><span class="hs-identifier hs-var">UnsupportedExpressionType</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176374"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="annot"><span class="hs-comment">{- | Recursively unwind an application chain to find the function being called and the arguments,
then lower the call appropriately.

For example, given the expression: @f x y z@, this function will extract @f@ and the arguments @[x, y, z]@,
and lower the call to @f@ with those arguments.
-}</span></span><span>
</span><span id="line-49"></span><span id="local-6989586621680176238"><span class="annot"><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-type">unwindCall</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Monad.html#InnerLower"><span class="hs-identifier hs-type">InnerLower</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176238"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Core.html#CoreExpr"><span class="hs-identifier hs-type">Core.CoreExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.JVM.IR.html#Expr"><span class="hs-identifier hs-type">IR.Expr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680176238"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.JVM.IR.html#Expr"><span class="hs-identifier hs-type">IR.Expr</span></a></span></span><span>
</span><span id="line-50"></span><span id="unwindCall"><span class="annot"><span class="annottext">unwindCall :: forall (r :: [Effect]).
InnerLower r =&gt;
CoreExpr -&gt; [Expr] -&gt; Eff r Expr
</span><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-var hs-var">unwindCall</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#App"><span class="hs-identifier hs-type">Core.App</span></a></span><span> </span><span id="local-6989586621680176399"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176399"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680176400"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176400"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680176401"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680176401"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-51"></span><span>    </span><span id="local-6989586621680176402"><span class="annot"><a href="#local-6989586621680176402"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; Eff r Expr
forall (r :: [Effect]). InnerLower r =&gt; CoreExpr -&gt; Eff r Expr
</span><a href="Elara.JVM.Lower.Expr.html#lowerExpr"><span class="hs-identifier hs-var">lowerExpr</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176400"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-type">unwindCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176399"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680176402"><span class="hs-identifier hs-type">x'</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621680176401"><span class="hs-identifier hs-type">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="annot"><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-var">unwindCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#TyApp"><span class="hs-identifier hs-type">Core.TyApp</span></a></span><span> </span><span id="local-6989586621680176403"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176403"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680176404"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680176404"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CoreExpr -&gt; [Expr] -&gt; Eff r Expr
forall (r :: [Effect]).
InnerLower r =&gt;
CoreExpr -&gt; [Expr] -&gt; Eff r Expr
</span><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-var">unwindCall</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176403"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680176404"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-54"></span><span class="annot"><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-var">unwindCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#Var"><span class="hs-identifier hs-type">Core.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#Id"><span class="hs-identifier hs-type">Core.Id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span id="local-6989586621680176405"><span class="annot"><span class="annottext">VarRefImpl UnlocatedVarRefKind (Unique Text)
</span><a href="#local-6989586621680176405"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680176406"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680176406"><span class="hs-identifier hs-var">type_</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe DataCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-comment">-- no arguments, just a local variable</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-comment">-- so we just return it directly</span><span>
</span><span id="line-57"></span><span>    </span><span class="annot"><span class="annottext">Expr -&gt; Eff r Expr
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Eff r Expr) -&gt; Expr -&gt; Eff r Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unique Text -&gt; FieldType -&gt; Expr
</span><a href="Elara.JVM.IR.html#LocalVar"><span class="hs-identifier hs-var">IR.LocalVar</span></a></span><span> </span><span class="annot"><span class="annottext">Unique Text
VarRefImpl UnlocatedVarRefKind (Unique Text)
</span><a href="#local-6989586621680176405"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; FieldType
</span><a href="Elara.JVM.Lower.Util.html#lowerType"><span class="hs-identifier hs-var">lowerType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680176406"><span class="hs-identifier hs-var">type_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="annot"><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-var">unwindCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#Var"><span class="hs-identifier hs-type">Core.Var</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#Id"><span class="hs-identifier hs-type">Core.Id</span></a></span><span> </span><span id="local-6989586621680176408"><span class="annot"><span class="annottext">VarRef' UnlocatedVarRefKind Text
</span><a href="#local-6989586621680176408"><span class="hs-identifier hs-var">source</span></a></span></span><span> </span><span id="local-6989586621680176409"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680176409"><span class="hs-identifier hs-var">type_</span></a></span></span><span> </span><span id="local-6989586621680176410"><span class="annot"><span class="annottext">Maybe DataCon
</span><a href="#local-6989586621680176410"><span class="hs-identifier hs-var">dataCon</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680176411"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621680176411"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680176412"><span class="annot"><span class="annottext">argTys :: [FieldType]
</span><a href="#local-6989586621680176412"><span class="hs-identifier hs-var hs-var hs-var">argTys</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Type -&gt; FieldType) -&gt; [Type] -&gt; [FieldType]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Type -&gt; FieldType
</span><a href="Elara.JVM.Lower.Util.html#lowerType"><span class="hs-identifier hs-var">lowerType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; [Type]
</span><a href="Elara.Core.html#functionTypeArgs"><span class="hs-identifier hs-var">Core.functionTypeArgs</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680176409"><span class="hs-identifier hs-var">type_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680176414"><span class="annot"><span class="annottext">retTy :: FieldType
</span><a href="#local-6989586621680176414"><span class="hs-identifier hs-var hs-var hs-var">retTy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type -&gt; FieldType
</span><a href="Elara.JVM.Lower.Util.html#lowerType"><span class="hs-identifier hs-var">lowerType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Elara.Core.html#functionTypeResult"><span class="hs-identifier hs-var">Core.functionTypeResult</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621680176409"><span class="hs-identifier hs-var">type_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680176416"><span class="annot"><span class="annottext">desc :: MethodDescriptor
</span><a href="#local-6989586621680176416"><span class="hs-identifier hs-var hs-var hs-var">desc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldType] -&gt; ReturnDescriptor -&gt; MethodDescriptor
</span><span class="hs-identifier hs-var">JVM.MethodDescriptor</span></span><span> </span><span class="annot"><span class="annottext">[FieldType]
</span><a href="#local-6989586621680176412"><span class="hs-identifier hs-var">argTys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldType -&gt; ReturnDescriptor
</span><span class="hs-identifier hs-var">JVM.TypeReturn</span></span><span> </span><span class="annot"><span class="annottext">FieldType
</span><a href="#local-6989586621680176414"><span class="hs-identifier hs-var">retTy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680176419"><span class="annot"><span class="annottext">fullArity :: Int
</span><a href="#local-6989586621680176419"><span class="hs-identifier hs-var hs-var hs-var">fullArity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldType] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[FieldType]
</span><a href="#local-6989586621680176412"><span class="hs-identifier hs-var">argTys</span></a></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span>    </span><span id="local-6989586621680176421"><span class="annot"><a href="#local-6989586621680176421"><span class="hs-identifier hs-var">target</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarRef' UnlocatedVarRefKind Text
</span><a href="#local-6989586621680176408"><span class="hs-identifier hs-var">source</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DataCon
</span><a href="#local-6989586621680176410"><span class="hs-identifier hs-var">dataCon</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-65"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarRef' UnlocatedVarRefKind Text
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#DataCon"><span class="hs-identifier hs-type">Core.DataCon</span></a></span><span> </span><span id="local-6989586621680176423"><span class="annot"><span class="annottext">Qualified Text
</span><a href="#local-6989586621680176423"><span class="hs-identifier hs-var">conName</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TyCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-66"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680176424"><span class="annot"><span class="annottext">constructorDesc :: MethodDescriptor
</span><a href="#local-6989586621680176424"><span class="hs-identifier hs-var hs-var">constructorDesc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldType] -&gt; ReturnDescriptor -&gt; MethodDescriptor
</span><span class="hs-identifier hs-var">JVM.MethodDescriptor</span></span><span> </span><span class="annot"><span class="annottext">[FieldType]
</span><a href="#local-6989586621680176412"><span class="hs-identifier hs-var">argTys</span></a></span><span> </span><span class="annot"><span class="annottext">ReturnDescriptor
</span><span class="hs-identifier hs-var">JVM.VoidReturn</span></span><span>
</span><span id="line-67"></span><span>            </span><span class="annot"><span class="annottext">CallableTarget -&gt; Eff r CallableTarget
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CallableTarget -&gt; Eff r CallableTarget)
-&gt; CallableTarget -&gt; Eff r CallableTarget
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QualifiedClassName -&gt; MethodDescriptor -&gt; CallableTarget
</span><a href="Elara.JVM.Lower.Function.html#Constructor"><span class="hs-identifier hs-var">Constructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Qualified Text -&gt; QualifiedClassName
</span><a href="Elara.JVM.Lower.Util.html#qualifiedTextToClass"><span class="hs-identifier hs-var">qualifiedTextToClass</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified Text
</span><a href="#local-6989586621680176423"><span class="hs-identifier hs-var">conName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621680176424"><span class="hs-identifier hs-var">constructorDesc</span></a></span><span>
</span><span id="line-68"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Global"><span class="hs-identifier hs-type">Global</span></a></span><span> </span><span id="local-6989586621680176429"><span class="annot"><span class="annottext">VarRefImpl UnlocatedVarRefKind (Qualified Text)
</span><a href="#local-6989586621680176429"><span class="hs-identifier hs-var">qn</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DataCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-69"></span><span>            </span><span class="annot"><span class="annottext">CallableTarget -&gt; Eff r CallableTarget
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CallableTarget -&gt; Eff r CallableTarget)
-&gt; CallableTarget -&gt; Eff r CallableTarget
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">QualifiedClassName -&gt; Text -&gt; MethodDescriptor -&gt; CallableTarget
</span><a href="Elara.JVM.Lower.Function.html#StaticMethod"><span class="hs-identifier hs-var">StaticMethod</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; QualifiedClassName
</span><a href="Elara.JVM.Lower.Util.html#moduleNameToQualifiedClassName"><span class="hs-identifier hs-var">moduleNameToQualifiedClassName</span></a></span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; QualifiedClassName)
-&gt; ModuleName -&gt; QualifiedClassName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Qualified Text -&gt; ModuleName
forall name. Qualified name -&gt; ModuleName
</span><a href="Elara.AST.Name.html#qualifier"><span class="hs-identifier hs-var">qualifier</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified Text
VarRefImpl UnlocatedVarRefKind (Qualified Text)
</span><a href="#local-6989586621680176429"><span class="hs-identifier hs-var">qn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Qualified Text
VarRefImpl UnlocatedVarRefKind (Qualified Text)
</span><a href="#local-6989586621680176429"><span class="hs-identifier hs-var">qn</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified Text -&gt; Optic' A_Lens NoIx (Qualified Text) Text -&gt; Text
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx (Qualified Text) Text
forall name. Lens' (Qualified name) name
</span><a href="Elara.AST.Name.html#unqualified"><span class="hs-identifier hs-var">unqualified</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621680176416"><span class="hs-identifier hs-var">desc</span></a></span><span>
</span><span id="line-70"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span id="local-6989586621680176434"><span class="annot"><span class="annottext">VarRefImpl UnlocatedVarRefKind (Unique Text)
</span><a href="#local-6989586621680176434"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe DataCon
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-71"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680176435"><span class="annot"><span class="annottext">localVar :: Expr
</span><a href="#local-6989586621680176435"><span class="hs-identifier hs-var hs-var">localVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique Text -&gt; FieldType -&gt; Expr
</span><a href="Elara.JVM.IR.html#LocalVar"><span class="hs-identifier hs-var">IR.LocalVar</span></a></span><span> </span><span class="annot"><span class="annottext">Unique Text
VarRefImpl UnlocatedVarRefKind (Unique Text)
</span><a href="#local-6989586621680176434"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QualifiedClassName -&gt; FieldType
</span><span class="hs-identifier hs-var">JVM.ObjectFieldType</span></span><span> </span><span class="annot"><span class="annottext">QualifiedClassName
</span><span class="hs-identifier hs-var">jloName</span></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>            </span><span class="annot"><span class="annottext">CallableTarget -&gt; Eff r CallableTarget
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(CallableTarget -&gt; Eff r CallableTarget)
-&gt; CallableTarget -&gt; Eff r CallableTarget
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; MethodDescriptor -&gt; CallableTarget
</span><a href="Elara.JVM.Lower.Function.html#InstanceMethod"><span class="hs-identifier hs-var">InstanceMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621680176435"><span class="hs-identifier hs-var">localVar</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDescriptor
</span><a href="#local-6989586621680176416"><span class="hs-identifier hs-var">desc</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680176437"><span class="annot"><a href="#local-6989586621680176437"><span class="hs-identifier hs-var hs-var">callable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CallableTarget -&gt; FieldType -&gt; Int -&gt; CallableInfo
</span><a href="Elara.JVM.Lower.Function.html#CallableInfo"><span class="hs-identifier hs-var">CallableInfo</span></a></span><span> </span><span class="annot"><span class="annottext">CallableTarget
</span><a href="#local-6989586621680176421"><span class="hs-identifier hs-var">target</span></a></span><span> </span><span class="annot"><span class="annottext">FieldType
</span><a href="#local-6989586621680176414"><span class="hs-identifier hs-var">retTy</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621680176419"><span class="hs-identifier hs-var">fullArity</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Elara.JVM.Lower.Function.html#lowerCallable"><span class="hs-identifier hs-type">lowerCallable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176437"><span class="hs-identifier hs-type">callable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680176411"><span class="hs-identifier hs-type">args</span></a></span><span> </span><span class="annot"><a href="Elara.JVM.Lower.Function.html#AsCall"><span class="hs-identifier hs-type">AsCall</span></a></span><span>
</span><span id="line-76"></span><span class="annot"><a href="Elara.JVM.Lower.Expr.html#unwindCall"><span class="hs-identifier hs-var">unwindCall</span></a></span><span> </span><span id="local-6989586621680176441"><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176441"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">JVMLoweringError -&gt; Eff r Expr
forall e (es :: [Effect]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(JVMLoweringError -&gt; Eff r Expr) -&gt; JVMLoweringError -&gt; Eff r Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; JVMLoweringError
</span><a href="Elara.JVM.Error.html#AppOfNonFunction"><span class="hs-identifier hs-var">AppOfNonFunction</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CoreExpr -&gt; Text
forall a. Pretty a =&gt; a -&gt; Text
</span><a href="Print.html#showPretty"><span class="hs-identifier hs-var">showPretty</span></a></span><span> </span><span class="annot"><span class="annottext">CoreExpr
</span><a href="#local-6989586621680176441"><span class="hs-identifier hs-var">other</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span></pre></body></html>