<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE QuantifiedConstraints #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeData #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilyDependencies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="annot"><span class="hs-comment">{- |
Module: Elara.Query
Description: This module defines the queries used in the Elara compiler.

    Queries are the way the compiler requests information between stages.
    Queries are lazy and memoised.

    This module defines the queries, and the main implementation is in 'Elara.Rules'
-}</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Elara.Query.html"><span class="hs-identifier">Elara.Query</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.FileSystem</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">FileSystem</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.TH.html"><span class="hs-identifier">Elara.Query.TH</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(:~:)</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Refl</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.GADT.Compare</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Graph</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">SCC</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Constraint</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.Error.Static</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Error</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.Writer.Static.Local</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Generic.html"><span class="hs-identifier">Elara.AST.Generic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Annotation"><span class="hs-identifier">Annotation</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Declaration"><span class="hs-identifier">Declaration</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Select"><span class="hs-identifier">Select</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Module.html"><span class="hs-identifier">Elara.AST.Module</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Name.html"><span class="hs-identifier">Elara.AST.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier">ModuleName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier">Qualified</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier">TypeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier">VarName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Region.html"><span class="hs-identifier">Elara.AST.Region</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#SourceRegion"><span class="hs-identifier">SourceRegion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Select.html"><span class="hs-identifier">Elara.AST.Select</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Typed.html"><span class="hs-identifier">Elara.AST.Typed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Typed.html#TypedExpr"><span class="hs-identifier">TypedExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html"><span class="hs-identifier">Elara.AST.VarRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#IgnoreLocVarRef"><span class="hs-identifier">IgnoreLocVarRef</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Core.html"><span class="hs-identifier">Elara.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.html#CoreBind"><span class="hs-identifier">CoreBind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Core.html#DataCon"><span class="hs-identifier">DataCon</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Core.html#TyCon"><span class="hs-identifier">TyCon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Core.html"><span class="hs-identifier">Elara.Core</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Core</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Core.ANF.html"><span class="hs-identifier">Elara.Core.ANF</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ANF</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Core.LiftClosures.Error.html"><span class="hs-identifier">Elara.Core.LiftClosures.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.LiftClosures.Error.html#ClosureLiftError"><span class="hs-identifier">ClosureLiftError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Core.Module.html"><span class="hs-identifier">Elara.Core.Module</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.Module.html#CoreModule"><span class="hs-identifier">CoreModule</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html"><span class="hs-identifier">Elara.Data.Kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier">KindVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Pretty.html"><span class="hs-identifier">Elara.Data.Pretty</span></a></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Desugar.Error.html"><span class="hs-identifier">Elara.Desugar.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Desugar.Error.html#DesugarError"><span class="hs-identifier">DesugarError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Error.html"><span class="hs-identifier">Elara.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Error.Effect.html#DiagnosticWriter"><span class="hs-identifier">DiagnosticWriter</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.JVM.Error.html"><span class="hs-identifier">Elara.JVM.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.JVM.Error.html#JVMLoweringError"><span class="hs-identifier">JVMLoweringError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.JVM.IR.html"><span class="hs-identifier">Elara.JVM.IR</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IR</span></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Lexer.Token.html"><span class="hs-identifier">Elara.Lexer.Token</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Lexer.Utils.html"><span class="hs-identifier">Elara.Lexer.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Lexer.Utils.html#LexerError"><span class="hs-identifier">LexerError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.ModuleIndex.html"><span class="hs-identifier">Elara.ModuleIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.ModuleIndex.html#ModuleIndex"><span class="hs-identifier">ModuleIndex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Parse.Error.html"><span class="hs-identifier">Elara.Parse.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Parse.Error.html#ElaraParseError"><span class="hs-identifier">ElaraParseError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Parse.Error.html#WParseErrorBundle"><span class="hs-identifier">WParseErrorBundle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Parse.Stream.html"><span class="hs-identifier">Elara.Parse.Stream</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Parse.Stream.html#TokenStream"><span class="hs-identifier">TokenStream</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html"><span class="hs-identifier">Elara.Query.Effects</span></a></span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.Errors.html"><span class="hs-identifier">Elara.Query.Errors</span></a></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.ReadFile.html"><span class="hs-identifier">Elara.ReadFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.ReadFile.html#FileContents"><span class="hs-identifier">FileContents</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.ReadFile.html#ModulePathError"><span class="hs-identifier">ModulePathError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.ReadFile.html#ReadFileError"><span class="hs-identifier">ReadFileError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Rename.Error.html"><span class="hs-identifier">Elara.Rename.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.Error.html#RenameError"><span class="hs-identifier">RenameError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.SCC.Type.html"><span class="hs-identifier">Elara.SCC.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.SCC.Type.html#ReachableSubgraph"><span class="hs-identifier">ReachableSubgraph</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.SCC.Type.html#SCCKey"><span class="hs-identifier">SCCKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Settings.html"><span class="hs-identifier">Elara.Settings</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Settings.html#CompilerSettings"><span class="hs-identifier">CompilerSettings</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Shunt.Error.html"><span class="hs-identifier">Elara.Shunt.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Shunt.Error.html#ShuntError"><span class="hs-identifier">ShuntError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Shunt.Error.html#ShuntWarning"><span class="hs-identifier">ShuntWarning</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Shunt.Operator.html"><span class="hs-identifier">Elara.Shunt.Operator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Shunt.Operator.html#OpInfo"><span class="hs-identifier">OpInfo</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Shunt.Operator.html#OpTable"><span class="hs-identifier">OpTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.TypeInfer.Environment.html"><span class="hs-identifier">Elara.TypeInfer.Environment</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.TypeInfer.Environment.html#TypeEnvKey"><span class="hs-identifier">TypeEnvKey</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.TypeInfer.Type.html"><span class="hs-identifier">Elara.TypeInfer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.TypeInfer.Type.html#Polytype"><span class="hs-identifier">Polytype</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.TypeInfer.Type.html#Type"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.TypeInfer.Unique.html"><span class="hs-identifier">Elara.TypeInfer.Unique</span></a></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">JVM.Data.Abstract.ClassFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ClassFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">JVM.Data.Convert.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">CodeConverterError</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Rock.html"><span class="hs-identifier">Rock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier">Rock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">type</span><span> </span><span id="WithRock"><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-var">WithRock</span></a></span></span><span> </span><span id="local-6989586621680197553"><span class="annot"><a href="#local-6989586621680197553"><span class="hs-identifier hs-type">effects</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680197553"><span class="hs-identifier hs-type">effects</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="annot"><span class="hs-comment">{- | The effects required to run a specific query
| This should probably be moved to the 'SupportsQuery' class as an associated type
-}</span></span><span>
</span><span id="line-73"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="QueryEffectsOf"><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-var">QueryEffectsOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197554"><span class="annot"><a href="#local-6989586621680197554"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Query.html#QueryType"><span class="hs-identifier hs-type">QueryType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680197555"><span class="annot"><a href="#local-6989586621680197555"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680197556"><span class="annot"><a href="#local-6989586621680197556"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>    </span><span id="QueryEffectsOf"><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-var">QueryEffectsOf</span></a></span></span><span> </span><span id="local-6989586621680197557"><span id="local-6989586621680197558"><span class="annot"><a href="#local-6989586621680197557"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197558"><span class="hs-identifier hs-type">ast</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QuerySpecificEffectsOf"><span class="hs-identifier hs-type">QuerySpecificEffectsOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197557"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197558"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">data</span><span> </span><span id="Query"><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-var">Query</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197560"><span class="annot"><a href="#local-6989586621680197560"><span class="hs-identifier hs-type">es</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Effect</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680197561"><span class="annot"><a href="#local-6989586621680197561"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">-- \* Input Queries</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Query to get the compiler settings</span></span><span>
</span><span id="line-80"></span><span>    </span><span id="GetCompilerSettings"><span class="annot"><a href="Elara.Query.html#GetCompilerSettings"><span class="hs-identifier hs-var">GetCompilerSettings</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.Effects.html#MinimumQueryEffects"><span class="hs-identifier hs-type">MinimumQueryEffects</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Settings.html#CompilerSettings"><span class="hs-identifier hs-type">CompilerSettings</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Query to get all the required input files to be passed to the compiler</span></span><span>
</span><span id="line-82"></span><span>    </span><span id="InputFiles"><span class="annot"><a href="Elara.Query.html#InputFiles"><span class="hs-identifier hs-var">InputFiles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsMinimumQueryEffects"><span class="hs-identifier hs-type">ConsMinimumQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FileSystem</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Query to get the module index (bidirectional mapping between file paths and module names)</span></span><span>
</span><span id="line-84"></span><span>    </span><span id="ModuleIndex"><span class="annot"><a href="Elara.Query.html#ModuleIndex"><span class="hs-identifier hs-var">ModuleIndex</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsMinimumQueryEffects"><span class="hs-identifier hs-type">ConsMinimumQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FileSystem</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.ModuleIndex.html#ModuleIndex"><span class="hs-identifier hs-type">ModuleIndex</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Query to get the contents of a specific file</span></span><span>
</span><span id="line-86"></span><span>    </span><span id="GetFileContents"><span class="annot"><a href="Elara.Query.html#GetFileContents"><span class="hs-identifier hs-var">GetFileContents</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsMinimumQueryEffects"><span class="hs-identifier hs-type">ConsMinimumQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">FileSystem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.ReadFile.html#ReadFileError"><span class="hs-identifier hs-type">ReadFileError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Error.Effect.html#DiagnosticWriter"><span class="hs-identifier hs-type">DiagnosticWriter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnsiStyle</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.ReadFile.html#FileContents"><span class="hs-identifier hs-type">FileContents</span></a></span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Query to get the file path of a module</span></span><span>
</span><span id="line-88"></span><span>    </span><span id="ModulePath"><span class="annot"><a href="Elara.Query.html#ModulePath"><span class="hs-identifier hs-var">ModulePath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.ReadFile.html#ModulePathError"><span class="hs-identifier hs-type">ModulePathError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">-- \* Lexing and Parsing Queries</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Query to get the lexed tokens of a specific file</span></span><span>
</span><span id="line-92"></span><span>    </span><span id="LexedFile"><span class="annot"><a href="Elara.Query.html#LexedFile"><span class="hs-identifier hs-var">LexedFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.Lexer.Utils.html#LexerError"><span class="hs-identifier hs-type">LexerError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.Lexer.Token.html#Lexeme"><span class="hs-identifier hs-type">Lexeme</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Query to get the parsed module from a file's contents and lexed tokens</span></span><span>
</span><span id="line-94"></span><span>    </span><span id="ParsedFile"><span class="annot"><a href="Elara.Query.html#ParsedFile"><span class="hs-identifier hs-var">ParsedFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Parse.Error.html#WParseErrorBundle"><span class="hs-identifier hs-type">WParseErrorBundle</span></a></span><span> </span><span class="annot"><a href="Elara.Parse.Stream.html#TokenStream"><span class="hs-identifier hs-type">TokenStream</span></a></span><span> </span><span class="annot"><a href="Elara.Parse.Error.html#ElaraParseError"><span class="hs-identifier hs-type">ElaraParseError</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Frontend"><span class="hs-identifier hs-type">Frontend</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Query to get a parsed module by module name</span></span><span>
</span><span id="line-96"></span><span>    </span><span id="ParsedModule"><span class="annot"><a href="Elara.Query.html#ParsedModule"><span class="hs-identifier hs-var">ParsedModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-97"></span><span>        </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span>
</span><span id="line-99"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Parse.Error.html#WParseErrorBundle"><span class="hs-identifier hs-type">WParseErrorBundle</span></a></span><span> </span><span class="annot"><a href="Elara.Parse.Stream.html#TokenStream"><span class="hs-identifier hs-type">TokenStream</span></a></span><span> </span><span class="annot"><a href="Elara.Parse.Error.html#ElaraParseError"><span class="hs-identifier hs-type">ElaraParseError</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Frontend"><span class="hs-identifier hs-type">Frontend</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- \* Desugaring and Renaming Queries</span><span>
</span><span id="line-102"></span><span>    </span><span id="DesugaredModule"><span class="annot"><a href="Elara.Query.html#DesugaredModule"><span class="hs-identifier hs-var">DesugaredModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.Desugar.Error.html#DesugarError"><span class="hs-identifier hs-type">DesugarError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span id="RenamedModule"><span class="annot"><a href="Elara.Query.html#RenamedModule"><span class="hs-identifier hs-var">RenamedModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.Rename.Error.html#RenameError"><span class="hs-identifier hs-type">RenameError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Lookup a module by name</span></span><span>
</span><span id="line-107"></span><span>    </span><span id="ModuleByName"><span class="annot"><a href="Elara.Query.html#ModuleByName"><span class="hs-identifier hs-var">ModuleByName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197573"><span class="annot"><a href="#local-6989586621680197573"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier hs-type">LocatedAST</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680197573"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-type">SupportsQuery</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-type">QueryModuleByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197573"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-111"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html#HasMinimumQueryEffects"><span class="hs-identifier hs-type">HasMinimumQueryEffects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-type">QueryModuleByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197573"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-type">QueryModuleByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197573"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-type">QueryReturnTypeOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-type">QueryModuleByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197573"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-comment">--  | Lookup a declaration by name, which may not exist</span><span>
</span><span id="line-115"></span><span>    </span><span id="DeclarationByName"><span class="annot"><a href="Elara.Query.html#DeclarationByName"><span class="hs-identifier hs-var">DeclarationByName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-116"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197575"><span class="annot"><a href="#local-6989586621680197575"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier hs-type">LocatedAST</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-117"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680197575"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-118"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-type">SupportsQuery</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryDeclarationByName"><span class="hs-identifier hs-type">QueryDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197575"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-119"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-120"></span><span>        </span><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-type">QueryArgsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryDeclarationByName"><span class="hs-identifier hs-type">QueryDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197575"><span class="hs-identifier hs-type">ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>        </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span>
</span><span id="line-122"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryDeclarationByName"><span class="hs-identifier hs-type">QueryDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197575"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-type">QueryReturnTypeOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryDeclarationByName"><span class="hs-identifier hs-type">QueryDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197575"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-comment">--  | Lookup a declaration by name, which must exist, throwing an 'InternalError' if not found</span><span>
</span><span id="line-125"></span><span>    </span><span id="RequiredDeclarationByName"><span class="annot"><a href="Elara.Query.html#RequiredDeclarationByName"><span class="hs-identifier hs-var">RequiredDeclarationByName</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-126"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197577"><span class="annot"><a href="#local-6989586621680197577"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier hs-type">LocatedAST</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680197577"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-type">SupportsQuery</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryRequiredDeclarationByName"><span class="hs-identifier hs-type">QueryRequiredDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197577"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-129"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-130"></span><span>        </span><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-type">QueryArgsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryRequiredDeclarationByName"><span class="hs-identifier hs-type">QueryRequiredDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197577"><span class="hs-identifier hs-type">ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>        </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span>
</span><span id="line-132"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryRequiredDeclarationByName"><span class="hs-identifier hs-type">QueryRequiredDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197577"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-type">QueryReturnTypeOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryRequiredDeclarationByName"><span class="hs-identifier hs-type">QueryRequiredDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197577"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Looks up the declaration for a data constructor</span></span><span>
</span><span id="line-135"></span><span>    </span><span id="ConstructorDeclaration"><span class="annot"><a href="Elara.Query.html#ConstructorDeclaration"><span class="hs-identifier hs-var">ConstructorDeclaration</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197579"><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier hs-type">LocatedAST</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-137"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Select"><span class="hs-identifier hs-type">Select</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#ConRef"><span class="hs-identifier hs-type">ConRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Select"><span class="hs-identifier hs-type">Select</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#ConRef"><span class="hs-identifier hs-type">ConRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Select"><span class="hs-identifier hs-type">Select</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#ConRef"><span class="hs-identifier hs-type">ConRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-type">SupportsQuery</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryConstructorDeclaration"><span class="hs-identifier hs-type">QueryConstructorDeclaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-type">QueryArgsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryConstructorDeclaration"><span class="hs-identifier hs-type">QueryConstructorDeclaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryConstructorDeclaration"><span class="hs-identifier hs-type">QueryConstructorDeclaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-type">QueryReturnTypeOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryConstructorDeclaration"><span class="hs-identifier hs-type">QueryConstructorDeclaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197579"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span id="DeclarationAnnotations"><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-var">DeclarationAnnotations</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-141"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197581"><span class="annot"><a href="#local-6989586621680197581"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier hs-type">LocatedAST</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680197581"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-type">SupportsQuery</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-type">DeclarationAnnotations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197581"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-143"></span><span>        </span><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-type">QueryArgsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryDeclarationByName"><span class="hs-identifier hs-type">QueryDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197581"><span class="hs-identifier hs-type">ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>        </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-type">DeclarationAnnotations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197581"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-type">QueryReturnTypeOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-type">DeclarationAnnotations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197581"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span id="DeclarationAnnotationsOfType"><span class="annot"><a href="Elara.Query.html#DeclarationAnnotationsOfType"><span class="hs-identifier hs-var">DeclarationAnnotationsOfType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197583"><span class="annot"><a href="#local-6989586621680197583"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier hs-type">LocatedAST</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-147"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680197583"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-type">SupportsQuery</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#DeclarationAnnotationsOfType"><span class="hs-identifier hs-type">DeclarationAnnotationsOfType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197583"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-type">QueryArgsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#DeclarationAnnotationsOfType"><span class="hs-identifier hs-type">DeclarationAnnotationsOfType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197583"><span class="hs-identifier hs-type">ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span>
</span><span id="line-152"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-type">DeclarationAnnotations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197583"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-type">QueryReturnTypeOf</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-type">DeclarationAnnotations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197583"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-comment">-- \* Shunting Queries</span><span>
</span><span id="line-155"></span><span>    </span><span id="GetOpInfo"><span class="annot"><a href="Elara.Query.html#GetOpInfo"><span class="hs-identifier hs-var">GetOpInfo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#IgnoreLocVarRef"><span class="hs-identifier hs-type">IgnoreLocVarRef</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Writer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Elara.Shunt.Error.html#ShuntWarning"><span class="hs-identifier hs-type">ShuntWarning</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.Shunt.Error.html#ShuntError"><span class="hs-identifier hs-type">ShuntError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.Shunt.Operator.html#OpInfo"><span class="hs-identifier hs-type">OpInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>    </span><span id="GetOpTableIn"><span class="annot"><a href="Elara.Query.html#GetOpTableIn"><span class="hs-identifier hs-var">GetOpTableIn</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Shunt.Operator.html#OpTable"><span class="hs-identifier hs-type">OpTable</span></a></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-comment">-- \* Pre-Inference Queries</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-comment">-- These are related to preparing SCCs etc for type inference</span><span>
</span><span id="line-159"></span><span>    </span><span id="FreeVarsOf"><span class="annot"><a href="Elara.Query.html#FreeVarsOf"><span class="hs-identifier hs-var">FreeVarsOf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HashSet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span id="ReachableSubgraphOf"><span class="annot"><a href="Elara.Query.html#ReachableSubgraphOf"><span class="hs-identifier hs-var">ReachableSubgraphOf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.SCC.Type.html#ReachableSubgraph"><span class="hs-identifier hs-type">ReachableSubgraph</span></a></span><span>
</span><span id="line-161"></span><span>    </span><span id="GetSCCsOf"><span class="annot"><a href="Elara.Query.html#GetSCCsOf"><span class="hs-identifier hs-var">GetSCCsOf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SCC</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-162"></span><span>    </span><span id="SCCKeyOf"><span class="annot"><a href="Elara.Query.html#SCCKeyOf"><span class="hs-identifier hs-var">SCCKeyOf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.SCC.Type.html#SCCKey"><span class="hs-identifier hs-type">SCCKey</span></a></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- \* Type and Kind Inference Queries</span><span>
</span><span id="line-164"></span><span>    </span><span id="TypeCheckedModule"><span class="annot"><a href="Elara.Query.html#TypeCheckedModule"><span class="hs-identifier hs-var">TypeCheckedModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Typed"><span class="hs-identifier hs-type">Typed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span id="TypeCheckedExpr"><span class="annot"><a href="Elara.Query.html#TypeCheckedExpr"><span class="hs-identifier hs-var">TypeCheckedExpr</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.AST.Typed.html#TypedExpr"><span class="hs-identifier hs-type">TypedExpr</span></a></span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621680197592"><span id="TypeOf"><span class="annot"><a href="Elara.Query.html#TypeOf"><span class="hs-identifier hs-var">TypeOf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680197592"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#SourceRegion"><span class="hs-identifier hs-type">SourceRegion</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.TypeInfer.Environment.html#TypeEnvKey"><span class="hs-identifier hs-type">TypeEnvKey</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197592"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.TypeInfer.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197592"><span class="hs-identifier hs-type">loc</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-167"></span><span>    </span><span id="InferSCC"><span class="annot"><a href="Elara.Query.html#InferSCC"><span class="hs-identifier hs-var">InferSCC</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.SCC.Type.html#SCCKey"><span class="hs-identifier hs-type">SCCKey</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.TypeInfer.Type.html#Polytype"><span class="hs-identifier hs-type">Polytype</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#SourceRegion"><span class="hs-identifier hs-type">SourceRegion</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span id="KindOf"><span class="annot"><a href="Elara.Query.html#KindOf"><span class="hs-identifier hs-var">KindOf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Get Information about a type alias</span></span><span>
</span><span id="line-170"></span><span>    </span><span id="GetTypeAlias"><span class="annot"><a href="Elara.Query.html#GetTypeAlias"><span class="hs-identifier hs-var">GetTypeAlias</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-171"></span><span>        </span><span class="annot"><span class="hs-comment">-- | The name of the type alias</span></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>        </span><span class="annot"><span class="hs-comment">{- | The type alias's type variables and body, if it exists
        \* To Core Queries
        -}</span></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="Elara.TypeInfer.Unique.html#UniqueTyVar"><span class="hs-identifier hs-type">UniqueTyVar</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.TypeInfer.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#SourceRegion"><span class="hs-identifier hs-type">SourceRegion</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- \* Core Queries</span><span>
</span><span id="line-178"></span><span>    </span><span id="GetCoreModule"><span class="annot"><a href="Elara.Query.html#GetCoreModule"><span class="hs-identifier hs-var">GetCoreModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.Module.html#CoreModule"><span class="hs-identifier hs-type">CoreModule</span></a></span><span> </span><span class="annot"><a href="Elara.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span id="GetTyCon"><span class="annot"><a href="Elara.Query.html#GetTyCon"><span class="hs-identifier hs-var">GetTyCon</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.Core.html#TyCon"><span class="hs-identifier hs-type">TyCon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span id="GetDataCon"><span class="annot"><a href="Elara.Query.html#GetDataCon"><span class="hs-identifier hs-var">GetDataCon</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.Core.html#DataCon"><span class="hs-identifier hs-type">DataCon</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span id="TypeCheckedDeclaration"><span class="annot"><a href="Elara.Query.html#TypeCheckedDeclaration"><span class="hs-identifier hs-var">TypeCheckedDeclaration</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Typed"><span class="hs-identifier hs-type">Typed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- \* Core To Core</span><span>
</span><span id="line-183"></span><span>    </span><span id="GetOptimisedCoreModule"><span class="annot"><a href="Elara.Query.html#GetOptimisedCoreModule"><span class="hs-identifier hs-var">GetOptimisedCoreModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.Module.html#CoreModule"><span class="hs-identifier hs-type">CoreModule</span></a></span><span> </span><span class="annot"><a href="Elara.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span id="GetANFCoreModule"><span class="annot"><a href="Elara.Query.html#GetANFCoreModule"><span class="hs-identifier hs-var">GetANFCoreModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.Module.html#CoreModule"><span class="hs-identifier hs-type">CoreModule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.ANF.html#TopLevelBind"><span class="hs-identifier hs-type">ANF.TopLevelBind</span></a></span><span> </span><span class="annot"><a href="Elara.Core.html#Var"><span class="hs-identifier hs-type">Core.Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span id="GetClosureLiftedModule"><span class="annot"><a href="Elara.Query.html#GetClosureLiftedModule"><span class="hs-identifier hs-var">GetClosureLiftedModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.Core.LiftClosures.Error.html#ClosureLiftError"><span class="hs-identifier hs-type">ClosureLiftError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.Module.html#CoreModule"><span class="hs-identifier hs-type">CoreModule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.ANF.html#TopLevelBind"><span class="hs-identifier hs-type">ANF.TopLevelBind</span></a></span><span> </span><span class="annot"><a href="Elara.Core.html#Var"><span class="hs-identifier hs-type">Core.Var</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span id="GetFinalisedCoreModule"><span class="annot"><a href="Elara.Query.html#GetFinalisedCoreModule"><span class="hs-identifier hs-var">GetFinalisedCoreModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Core.Module.html#CoreModule"><span class="hs-identifier hs-type">CoreModule</span></a></span><span> </span><span class="annot"><a href="Elara.Core.html#CoreBind"><span class="hs-identifier hs-type">CoreBind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">-- \* JVM Backend Queries</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Core &#8594; JVM IR (per module)</span></span><span>
</span><span id="line-190"></span><span>    </span><span id="GetJVMIRModule"><span class="annot"><a href="Elara.Query.html#GetJVMIRModule"><span class="hs-identifier hs-var">GetJVMIRModule</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.JVM.Error.html#JVMLoweringError"><span class="hs-identifier hs-type">JVMLoweringError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.JVM.IR.html#Module"><span class="hs-identifier hs-type">IR.Module</span></a></span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="hs-comment">-- | JVM IR &#8594; ClassFiles (per module)</span></span><span>
</span><span id="line-192"></span><span>    </span><span id="GetJVMClassFiles"><span class="annot"><a href="Elara.Query.html#GetJVMClassFiles"><span class="hs-identifier hs-var">GetJVMClassFiles</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.JVM.Error.html#JVMLoweringError"><span class="hs-identifier hs-type">JVMLoweringError</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">ClassFile</span></span><span class="hs-special">]</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="hs-comment">-- | ClassFiles &#8594; Serialized bytes (per module)</span></span><span>
</span><span id="line-194"></span><span>    </span><span id="GetJVMClassBytes"><span class="annot"><a href="Elara.Query.html#GetJVMClassBytes"><span class="hs-identifier hs-var">GetJVMClassBytes</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#WithRock"><span class="hs-identifier hs-type">WithRock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.JVM.Error.html#JVMLoweringError"><span class="hs-identifier hs-type">JVMLoweringError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CodeConverterError</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LByteString</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><span class="hs-comment">-- | List of query kinds at the type level</span></span><span>
</span><span id="line-197"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">data</span><span> </span><span id="QueryType"><span class="annot"><a href="Elara.Query.html#QueryType"><span class="hs-identifier hs-var">QueryType</span></a></span></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="QueryRequiredDeclarationByName"><span class="annot"><a href="Elara.Query.html#QueryRequiredDeclarationByName"><span class="hs-identifier hs-var">QueryRequiredDeclarationByName</span></a></span></span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="QueryDeclarationByName"><span class="annot"><a href="Elara.Query.html#QueryDeclarationByName"><span class="hs-identifier hs-var">QueryDeclarationByName</span></a></span></span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="QueryModuleByName"><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-var">QueryModuleByName</span></a></span></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="QueryConstructorDeclaration"><span class="annot"><a href="Elara.Query.html#QueryConstructorDeclaration"><span class="hs-identifier hs-var">QueryConstructorDeclaration</span></a></span></span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DeclarationAnnotations"><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-var">DeclarationAnnotations</span></a></span></span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="DeclarationAnnotationsOfType"><span class="annot"><a href="Elara.Query.html#DeclarationAnnotationsOfType"><span class="hs-identifier hs-var">DeclarationAnnotationsOfType</span></a></span></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="QueryReturnTypeOf"><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-var">QueryReturnTypeOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197608"><span class="annot"><a href="#local-6989586621680197608"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Query.html#QueryType"><span class="hs-identifier hs-type">QueryType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680197609"><span class="annot"><a href="#local-6989586621680197609"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621680197610"><span class="annot"><a href="#local-6989586621680197610"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-206"></span><span>    </span><span id="QueryReturnTypeOf"><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-var">QueryReturnTypeOf</span></a></span></span><span> </span><span id="local-6989586621680197611"><span class="annot"><a href="Elara.Query.html#QueryDeclarationByName"><span class="hs-identifier hs-type">QueryDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197611"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197611"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span id="QueryReturnTypeOf"><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-var">QueryReturnTypeOf</span></a></span></span><span> </span><span id="local-6989586621680197612"><span class="annot"><a href="Elara.Query.html#QueryRequiredDeclarationByName"><span class="hs-identifier hs-type">QueryRequiredDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197612"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197612"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span id="QueryReturnTypeOf"><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-var">QueryReturnTypeOf</span></a></span></span><span> </span><span id="local-6989586621680197613"><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-type">QueryModuleByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197613"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197613"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span id="QueryReturnTypeOf"><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-var">QueryReturnTypeOf</span></a></span></span><span> </span><span id="local-6989586621680197614"><span class="annot"><a href="Elara.Query.html#QueryConstructorDeclaration"><span class="hs-identifier hs-type">QueryConstructorDeclaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197614"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197614"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span id="QueryReturnTypeOf"><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-var">QueryReturnTypeOf</span></a></span></span><span> </span><span id="local-6989586621680197615"><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-type">DeclarationAnnotations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197615"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197615"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-211"></span><span>    </span><span id="QueryReturnTypeOf"><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-var">QueryReturnTypeOf</span></a></span></span><span> </span><span id="local-6989586621680197616"><span class="annot"><a href="Elara.Query.html#DeclarationAnnotationsOfType"><span class="hs-identifier hs-type">DeclarationAnnotationsOfType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197616"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197616"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="QueryArgsOf"><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-var">QueryArgsOf</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197617"><span class="annot"><a href="#local-6989586621680197617"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Query.html#QueryType"><span class="hs-identifier hs-type">QueryType</span></a></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680197618"><span class="annot"><a href="#local-6989586621680197618"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-214"></span><span>    </span><span id="QueryArgsOf"><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-var">QueryArgsOf</span></a></span></span><span> </span><span id="local-6989586621680197619"><span class="annot"><a href="Elara.Query.html#QueryDeclarationByName"><span class="hs-identifier hs-type">QueryDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197619"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span id="QueryArgsOf"><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-var">QueryArgsOf</span></a></span></span><span> </span><span id="local-6989586621680197620"><span class="annot"><a href="Elara.Query.html#QueryRequiredDeclarationByName"><span class="hs-identifier hs-type">QueryRequiredDeclarationByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197620"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-216"></span><span>    </span><span id="QueryArgsOf"><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-var">QueryArgsOf</span></a></span></span><span> </span><span id="local-6989586621680197621"><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-type">QueryModuleByName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197621"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span id="QueryArgsOf"><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-var">QueryArgsOf</span></a></span></span><span> </span><span id="local-6989586621680197622"><span class="annot"><a href="Elara.Query.html#QueryConstructorDeclaration"><span class="hs-identifier hs-type">QueryConstructorDeclaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197622"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Select"><span class="hs-identifier hs-type">Select</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#ConRef"><span class="hs-identifier hs-type">ConRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197622"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span id="QueryArgsOf"><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-var">QueryArgsOf</span></a></span></span><span> </span><span id="local-6989586621680197623"><span class="annot"><a href="Elara.Query.html#DeclarationAnnotations"><span class="hs-identifier hs-type">DeclarationAnnotations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197623"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- \| Args are (declaration name, type name)</span><span>
</span><span id="line-220"></span><span>    </span><span id="QueryArgsOf"><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-var">QueryArgsOf</span></a></span></span><span> </span><span id="local-6989586621680197624"><span class="annot"><a href="Elara.Query.html#DeclarationAnnotationsOfType"><span class="hs-identifier hs-type">DeclarationAnnotationsOfType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197624"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-221"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span>
</span><span id="line-222"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span>
</span><span id="line-223"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="hs-keyword">class</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621680197210"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html#HasMinimumQueryEffects"><span class="hs-identifier hs-type">HasMinimumQueryEffects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197209"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197210"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-229"></span><span>    </span><span id="SupportsQuery"><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-var">SupportsQuery</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197209"><span class="annot"><a href="#local-6989586621680197209"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Query.html#QueryType"><span class="hs-identifier hs-type">QueryType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197210"><span class="annot"><a href="#local-6989586621680197210"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier hs-type">LocatedAST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">{- | Effects that are &quot;unique&quot; to this query.
    Effects included in 'MinimumQueryEffects' should not be included here as they are expected to always be present
    -}</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="QuerySpecificEffectsOf"><span class="annot"><a href="Elara.Query.html#QuerySpecificEffectsOf"><span class="hs-identifier hs-var">QuerySpecificEffectsOf</span></a></span></span><span> </span><span id="local-6989586621680197209"><span class="annot"><a href="#local-6989586621680197209"><span class="hs-identifier hs-type">q</span></a></span></span><span> </span><span id="local-6989586621680197210"><span class="annot"><a href="#local-6989586621680197210"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Effect</span></span><span class="hs-special">]</span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="QuerySpecificEffectsOf"><span class="annot"><a href="Elara.Query.html#QuerySpecificEffectsOf"><span class="hs-identifier hs-var">QuerySpecificEffectsOf</span></a></span></span><span> </span><span id="local-6989586621680197627"><span id="local-6989586621680197628"><span class="annot"><a href="#local-6989586621680197627"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197628"><span class="hs-identifier hs-type">ast</span></a></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.Query.Errors.html#StandardQueryError"><span class="hs-identifier hs-type">StandardQueryError</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197628"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span>    </span><span id="query"><span class="annot"><a href="Elara.Query.html#query"><span class="hs-identifier hs-type">query</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Query.html#QueryArgsOf"><span class="hs-identifier hs-type">QueryArgsOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197209"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197210"><span class="hs-identifier hs-type">ast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryEffectsOf"><span class="hs-identifier hs-type">QueryEffectsOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197209"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197210"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryReturnTypeOf"><span class="hs-identifier hs-type">QueryReturnTypeOf</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197209"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197210"><span class="hs-identifier hs-type">ast</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="SupportsQueries"><span class="annot"><a href="Elara.Query.html#SupportsQueries"><span class="hs-identifier hs-var">SupportsQueries</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197633"><span class="annot"><a href="#local-6989586621680197633"><span class="hs-identifier hs-type">qs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.Query.html#QueryType"><span class="hs-identifier hs-type">QueryType</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197634"><span class="annot"><a href="#local-6989586621680197634"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier hs-type">LocatedAST</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680197635"><span class="annot"><a href="#local-6989586621680197635"><span class="hs-identifier hs-type">c</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-241"></span><span>    </span><span id="SupportsQueries"><span class="annot"><a href="Elara.Query.html#SupportsQueries"><span class="hs-identifier hs-var">SupportsQueries</span></a></span></span><span> </span><span id="local-6989586621680197636"><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621680197636"><span class="hs-identifier hs-type">ast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>    </span><span id="SupportsQueries"><span class="annot"><a href="Elara.Query.html#SupportsQueries"><span class="hs-identifier hs-var">SupportsQueries</span></a></span></span><span> </span><span id="local-6989586621680197637"><span id="local-6989586621680197638"><span id="local-6989586621680197639"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680197637"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621680197638"><span class="hs-identifier hs-type">qs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680197639"><span class="hs-identifier hs-type">ast</span></a></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-243"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-type">SupportsQuery</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197637"><span class="hs-identifier hs-type">q</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197639"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-244"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQueries"><span class="hs-identifier hs-type">SupportsQueries</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197638"><span class="hs-identifier hs-type">qs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197639"><span class="hs-identifier hs-type">ast</span></a></span><span>
</span><span id="line-245"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680197215"><span id="local-6989586621680197216"><span id="local-6989586621680197643"><span class="annot"><span class="hs-identifier hs-type">GEq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197215"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197215"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197216"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>    </span><span id="local-6989586621680197648"><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680197648"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680197649"><span class="annot"><span class="annottext">== :: Query es a -&gt; Query es a -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621680197650"><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680197650"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Query es a -&gt; Query es a -&gt; Maybe (a :~: a)
forall a b. Query es a -&gt; Query es b -&gt; Maybe (a :~: b)
forall k (f :: k -&gt; *) (a :: k) (b :: k).
GEq f =&gt;
f a -&gt; f b -&gt; Maybe (a :~: b)
</span><span class="hs-identifier hs-var">geq</span></span><span> </span><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680197648"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680197650"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-249"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-250"></span><span>        </span><span class="annot"><span class="annottext">Maybe (a :~: a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-special">$</span><span id="tagQuery"><span class="hs-special">(</span><span class="hs-identifier">makeTag</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Query</span><span class="hs-special">)</span></span><span>
</span><span id="line-253"></span><span class="hs-special">$</span><span id="local-6989586621680197233"><span id="local-6989586621680197234"><span id="local-6989586621680197235"><span id="sameCtor"><span class="hs-special">(</span><span class="hs-identifier">deriveSameCtor</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Query</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span id="local-6989586621680197244"><span id="local-6989586621680197245"><span id="local-6989586621680198190"><span id="local-6989586621680198192"><span id="local-6989586621680198195"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197244"><span class="hs-identifier hs-type">es</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197245"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680197299"><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197299"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">GEq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197299"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-258"></span><span>    </span><span id="local-6989586621680198204"><span class="annot"><span class="annottext">geq :: forall a b. Query es a -&gt; Query es b -&gt; Maybe (a :~: b)
</span><span class="hs-identifier hs-var hs-var hs-var">geq</span></span></span><span> </span><span id="local-6989586621680198205"><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680198205"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680198206"><span class="annot"><span class="annottext">Query es b
</span><a href="#local-6989586621680198206"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Query es a -&gt; Query es b -&gt; GOrdering a b
forall a b. Query es a -&gt; Query es b -&gt; GOrdering a b
forall k (f :: k -&gt; *) (a :: k) (b :: k).
GCompare f =&gt;
f a -&gt; f b -&gt; GOrdering a b
</span><span class="hs-identifier hs-var">gcompare</span></span><span> </span><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680198205"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Query es b
</span><a href="#local-6989586621680198206"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><span class="annottext">GOrdering a b
</span><span class="hs-identifier hs-var">GEQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(a :~: b) -&gt; Maybe (a :~: b)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~: a
a :~: b
forall {k} (a :: k). a :~: a
</span><span class="hs-identifier hs-var">Refl</span></span><span>
</span><span id="line-260"></span><span>        </span><span class="annot"><span class="annottext">GOrdering a b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (a :~: b)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680197309"><span class="annot"><span class="hs-identifier hs-type">GCompare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680197309"><span class="hs-identifier hs-type">es</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621680198218"><span class="annot"><span class="annottext">gcompare :: forall a b. Query es a -&gt; Query es b -&gt; GOrdering a b
</span><span class="hs-identifier hs-var hs-var hs-var">gcompare</span></span></span><span> </span><span id="local-6989586621680198219"><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680198219"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680198220"><span class="annot"><span class="annottext">Query es b
</span><a href="#local-6989586621680198220"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query es a -&gt; Int
forall {w :: [Effect]} {w}. Query w w -&gt; Int
</span><a href="Elara.Query.html#tagQuery"><span class="hs-identifier hs-var">tagQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680198219"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Query es b -&gt; Int
forall {w :: [Effect]} {w}. Query w w -&gt; Int
</span><a href="Elara.Query.html#tagQuery"><span class="hs-identifier hs-var">tagQuery</span></a></span><span> </span><span class="annot"><span class="annottext">Query es b
</span><a href="#local-6989586621680198220"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GLT</span></span><span>
</span><span id="line-266"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GOrdering a b
forall {k} (a :: k) (b :: k). GOrdering a b
</span><span class="hs-identifier hs-var">GGT</span></span><span>
</span><span id="line-267"></span><span>            </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (es :: [Effect]) a b.
HasCallStack =&gt;
Query es a -&gt; Query es b -&gt; GOrdering a b
Query es a -&gt; Query es b -&gt; GOrdering a b
forall (es :: [Effect]) a b.
Query es a -&gt; Query es b -&gt; GOrdering a b
</span><a href="Elara.Query.html#sameCtor"><span class="hs-identifier hs-var">sameCtor</span></a></span><span> </span><span class="annot"><span class="annottext">Query es a
</span><a href="#local-6989586621680198219"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Query es b
</span><a href="#local-6989586621680198220"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-special">$</span><span id="local-6989586621680197315"><span id="local-6989586621680197316"><span id="local-6989586621680198225"><span id="local-6989586621680198227"><span class="hs-special">(</span><span class="hs-identifier">deriveHashableInstance</span><span> </span><span class="hs-special">''</span><span class="hs-identifier">Query</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-270"></span></pre></body></html>