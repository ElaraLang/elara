<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621680143559"><span id="local-6989586621680143560"><span id="local-6989586621680143561"><span id="local-6989586621680143562"><span id="local-6989586621680143563"><span id="local-6989586621680143564"><span id="local-6989586621680143565"><span id="local-6989586621680143566"><span id="local-6989586621680143567"><span id="local-6989586621680143568"><span id="local-6989586621680143569"></span></span></span></span></span></span></span></span></span></span></span><span class="hs-pragma">{-# LANGUAGE OverloadedLabels #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{- | Performs kind inference on a type.
Algorithm inspired by https://gilmi.me/blog/post/2023/09/30/kind-inference

&gt;&gt; infer &quot;type alias Identity a = a&quot;
&quot;k -&gt; k&quot;

&gt;&gt; infer &quot;type Maybe a = Either a Unit&quot;
Type -&gt; Type

&gt;&gt; infer &quot;type Either a b = Left a | Right b&quot;
Type -&gt; Type -&gt; Type

&gt;&gt; infer &quot;type Proxy a = Proxy&quot;
k -&gt; Type

TODO: this is extremely basic and needs some nicer error messages, no support for polykinds or higher-kinded types yet
-}</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html"><span class="hs-identifier">Elara.Data.Kind.Infer</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInferError"><span class="hs-identifier">KindInferError</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#inferKind"><span class="hs-identifier">inferKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#inferTypeKind"><span class="hs-identifier">inferTypeKind</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#initialInferState"><span class="hs-identifier">initialInferState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#lookupKindVarMaybe"><span class="hs-identifier">lookupKindVarMaybe</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#lookupNameKindVar"><span class="hs-identifier">lookupNameKindVar</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#preRegisterType"><span class="hs-identifier">preRegisterType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier">InferState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldM</span></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Data</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Data</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics.Wrapped</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.Error.Static</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.State.Static.Local</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Generic.html"><span class="hs-identifier">Elara.AST.Generic</span></a></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Common.html"><span class="hs-identifier">Elara.AST.Generic.Common</span></a></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html"><span class="hs-identifier">Elara.AST.Kinded</span></a></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Name.html"><span class="hs-identifier">Elara.AST.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier">LowerAlphaName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier">Qualified</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier">TypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Region.html"><span class="hs-identifier">Elara.AST.Region</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#HasSourceRegion"><span class="hs-identifier">HasSourceRegion</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier">sourceRegion</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier">Located</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#sourceRegionToDiagnosePosition"><span class="hs-identifier">sourceRegionToDiagnosePosition</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier">unlocated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Select.html"><span class="hs-identifier">Elara.AST.Select</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Shunted.html"><span class="hs-identifier">Elara.AST.Shunted</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html"><span class="hs-identifier">Elara.Data.Kind</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Pretty.html"><span class="hs-identifier">Elara.Data.Pretty</span></a></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Unique.html"><span class="hs-identifier">Elara.Data.Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Unique.html#Unique"><span class="hs-identifier">Unique</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html"><span class="hs-identifier">Elara.Data.Unique.Effect</span></a></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Error.html"><span class="hs-identifier">Elara.Error</span></a></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Logging.html"><span class="hs-identifier">Elara.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Logging.html#debugWith"><span class="hs-identifier">debugWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Logging.html#logDebug"><span class="hs-identifier">logDebug</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Prim.html"><span class="hs-identifier">Elara.Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Prim.html#primKindCheckContext"><span class="hs-identifier">primKindCheckContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.html"><span class="hs-identifier">Elara.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html"><span class="hs-identifier">Elara.Query.Effects</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#QueryEffects"><span class="hs-identifier">QueryEffects</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Error.Diagnose</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">set</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">traverseOf_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">universeOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Rock.html"><span class="hs-identifier">Rock</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><span class="hs-comment">{- | Tracks the origin of a kind constraint for better error messages.
This represents the &quot;why&quot; of why a constraint was added.
-}</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">data</span><span> </span><span id="ConstraintOrigin"><span class="annot"><a href="Elara.Data.Kind.Infer.html#ConstraintOrigin"><span class="hs-identifier hs-var">ConstraintOrigin</span></a></span></span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | A (type-level) function was applied to an argument</span></span><span>
</span><span id="line-64"></span><span>      </span><span id="FunctionApplication"><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionApplication"><span class="hs-identifier hs-var">FunctionApplication</span></a></span></span><span>
</span><span id="line-65"></span><span>        </span><span class="hs-special">{</span><span> </span><span id="functionType"><span class="annot"><span class="annottext">ConstraintOrigin -&gt; Located ShuntedType'
</span><a href="Elara.Data.Kind.Infer.html#functionType"><span class="hs-identifier hs-var hs-var">functionType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Shunted.html#ShuntedType%27"><span class="hs-identifier hs-type">ShuntedType'</span></a></span><span>
</span><span id="line-66"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ The function being applied</span></span><span>
</span><span id="line-67"></span><span>        </span><span class="hs-special">,</span><span> </span><span id="functionArg"><span class="annot"><span class="annottext">ConstraintOrigin -&gt; (ShuntedType, MidKindedType)
</span><a href="Elara.Data.Kind.Infer.html#functionArg"><span class="hs-identifier hs-var hs-var">functionArg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Shunted.html#ShuntedType"><span class="hs-identifier hs-type">ShuntedType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#MidKindedType"><span class="hs-identifier hs-type">MidKindedType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>        </span><span class="annot"><span class="hs-comment">-- ^ The argument type</span></span><span>
</span><span id="line-69"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | The result of a function application must be of kind Type</span></span><span>
</span><span id="line-71"></span><span>      </span><span id="FunctionResult"><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionResult"><span class="hs-identifier hs-var">FunctionResult</span></a></span></span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Elements of a list must be of kind Type</span></span><span>
</span><span id="line-73"></span><span>      </span><span id="ListElement"><span class="annot"><a href="Elara.Data.Kind.Infer.html#ListElement"><span class="hs-identifier hs-var">ListElement</span></a></span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Field of a record must be of kind Type</span></span><span>
</span><span id="line-75"></span><span>      </span><span id="RecordField"><span class="annot"><a href="Elara.Data.Kind.Infer.html#RecordField"><span class="hs-identifier hs-var">RecordField</span></a></span></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier hs-type">LowerAlphaName</span></a></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Input to a function -&gt; must be of kind Type</span></span><span>
</span><span id="line-77"></span><span>      </span><span id="FunctionParameter"><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionParameter"><span class="hs-identifier hs-var">FunctionParameter</span></a></span></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | The inferred kind of a definition must match its signature</span></span><span>
</span><span id="line-79"></span><span>      </span><span id="DefinitionKind"><span class="annot"><a href="Elara.Data.Kind.Infer.html#DefinitionKind"><span class="hs-identifier hs-var">DefinitionKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Generic primitive constraint, e.g. &quot;Unit must be of kind Type&quot;. This should be replaced with more specific origins where possible.</span></span><span>
</span><span id="line-81"></span><span>      </span><span id="PrimitiveConstraint"><span class="annot"><a href="Elara.Data.Kind.Infer.html#PrimitiveConstraint"><span class="hs-identifier hs-var">PrimitiveConstraint</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | The declaration of a user defined type</span></span><span>
</span><span id="line-83"></span><span>      </span><span id="UserDefinedTypeConstraint"><span class="annot"><a href="Elara.Data.Kind.Infer.html#UserDefinedTypeConstraint"><span class="hs-identifier hs-var">UserDefinedTypeConstraint</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680143597"><span id="local-6989586621680143620"><span id="local-6989586621680143624"><span class="annot"><span class="annottext">Int -&gt; ConstraintOrigin -&gt; ShowS
[ConstraintOrigin] -&gt; ShowS
ConstraintOrigin -&gt; String
(Int -&gt; ConstraintOrigin -&gt; ShowS)
-&gt; (ConstraintOrigin -&gt; String)
-&gt; ([ConstraintOrigin] -&gt; ShowS)
-&gt; Show ConstraintOrigin
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; ConstraintOrigin -&gt; ShowS
showsPrec :: Int -&gt; ConstraintOrigin -&gt; ShowS
$cshow :: ConstraintOrigin -&gt; String
show :: ConstraintOrigin -&gt; String
$cshowList :: [ConstraintOrigin] -&gt; ShowS
showList :: [ConstraintOrigin] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680143661"><span id="local-6989586621680143681"><span class="annot"><span class="annottext">ConstraintOrigin -&gt; ConstraintOrigin -&gt; Bool
(ConstraintOrigin -&gt; ConstraintOrigin -&gt; Bool)
-&gt; (ConstraintOrigin -&gt; ConstraintOrigin -&gt; Bool)
-&gt; Eq ConstraintOrigin
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: ConstraintOrigin -&gt; ConstraintOrigin -&gt; Bool
== :: ConstraintOrigin -&gt; ConstraintOrigin -&gt; Bool
$c/= :: ConstraintOrigin -&gt; ConstraintOrigin -&gt; Bool
/= :: ConstraintOrigin -&gt; ConstraintOrigin -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680143720"><span id="local-6989586621680143736"><span id="local-6989586621680143750"><span id="local-6989586621680143752"><span id="local-6989586621680143754"><span id="local-6989586621680143760"><span id="local-6989586621680143765"><span id="local-6989586621680143768"><span id="local-6989586621680143771"><span id="local-6989586621680143774"><span id="local-6989586621680143777"><span id="local-6989586621680143780"><span id="local-6989586621680143785"><span id="local-6989586621680143790"><span class="annot"><span class="annottext">Typeable ConstraintOrigin
Typeable ConstraintOrigin =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; ConstraintOrigin -&gt; c ConstraintOrigin)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ConstraintOrigin)
-&gt; (ConstraintOrigin -&gt; Constr)
-&gt; (ConstraintOrigin -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ConstraintOrigin))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c ConstraintOrigin))
-&gt; ((forall b. Data b =&gt; b -&gt; b)
    -&gt; ConstraintOrigin -&gt; ConstraintOrigin)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ConstraintOrigin -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ConstraintOrigin -&gt; r)
-&gt; (forall u.
    (forall d. Data d =&gt; d -&gt; u) -&gt; ConstraintOrigin -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ConstraintOrigin -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; ConstraintOrigin -&gt; m ConstraintOrigin)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; ConstraintOrigin -&gt; m ConstraintOrigin)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d)
    -&gt; ConstraintOrigin -&gt; m ConstraintOrigin)
-&gt; Data ConstraintOrigin
ConstraintOrigin -&gt; Constr
ConstraintOrigin -&gt; DataType
(forall b. Data b =&gt; b -&gt; b)
-&gt; ConstraintOrigin -&gt; ConstraintOrigin
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ConstraintOrigin -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ConstraintOrigin -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ConstraintOrigin -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ConstraintOrigin -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ConstraintOrigin -&gt; m ConstraintOrigin
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ConstraintOrigin -&gt; m ConstraintOrigin
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ConstraintOrigin
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ConstraintOrigin -&gt; c ConstraintOrigin
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ConstraintOrigin)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ConstraintOrigin)
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ConstraintOrigin -&gt; c ConstraintOrigin
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; ConstraintOrigin -&gt; c ConstraintOrigin
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ConstraintOrigin
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c ConstraintOrigin
$ctoConstr :: ConstraintOrigin -&gt; Constr
toConstr :: ConstraintOrigin -&gt; Constr
$cdataTypeOf :: ConstraintOrigin -&gt; DataType
dataTypeOf :: ConstraintOrigin -&gt; DataType
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ConstraintOrigin)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c ConstraintOrigin)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ConstraintOrigin)
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e))
-&gt; Maybe (c ConstraintOrigin)
$cgmapT :: (forall b. Data b =&gt; b -&gt; b)
-&gt; ConstraintOrigin -&gt; ConstraintOrigin
gmapT :: (forall b. Data b =&gt; b -&gt; b)
-&gt; ConstraintOrigin -&gt; ConstraintOrigin
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ConstraintOrigin -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ConstraintOrigin -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ConstraintOrigin -&gt; r
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; ConstraintOrigin -&gt; r
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ConstraintOrigin -&gt; [u]
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; ConstraintOrigin -&gt; [u]
$cgmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ConstraintOrigin -&gt; u
gmapQi :: forall u.
Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; ConstraintOrigin -&gt; u
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ConstraintOrigin -&gt; m ConstraintOrigin
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ConstraintOrigin -&gt; m ConstraintOrigin
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ConstraintOrigin -&gt; m ConstraintOrigin
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ConstraintOrigin -&gt; m ConstraintOrigin
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ConstraintOrigin -&gt; m ConstraintOrigin
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d)
-&gt; ConstraintOrigin -&gt; m ConstraintOrigin
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680143890"><span id="local-6989586621680143892"><span class="annot"><span class="annottext">(forall x. ConstraintOrigin -&gt; Rep ConstraintOrigin x)
-&gt; (forall x. Rep ConstraintOrigin x -&gt; ConstraintOrigin)
-&gt; Generic ConstraintOrigin
forall x. Rep ConstraintOrigin x -&gt; ConstraintOrigin
forall x. ConstraintOrigin -&gt; Rep ConstraintOrigin x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. ConstraintOrigin -&gt; Rep ConstraintOrigin x
from :: forall x. ConstraintOrigin -&gt; Rep ConstraintOrigin x
$cto :: forall x. Rep ConstraintOrigin x -&gt; ConstraintOrigin
to :: forall x. Rep ConstraintOrigin x -&gt; ConstraintOrigin
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Elara.Data.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#ConstraintOrigin"><span class="hs-identifier hs-type">ConstraintOrigin</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>    </span><span id="local-6989586621680143948"><span class="annot"><span class="annottext">pretty :: ConstraintOrigin -&gt; Doc AnsiStyle
</span><a href="#local-6989586621680143948"><span class="hs-identifier hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionApplication"><span class="hs-identifier hs-type">FunctionApplication</span></a></span><span> </span><span id="local-6989586621680143950"><span class="annot"><span class="annottext">Located ShuntedType'
</span><a href="#local-6989586621680143950"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680143951"><span class="annot"><span class="annottext">(ShuntedType, MidKindedType)
</span><a href="#local-6989586621680143951"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Application of type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShuntedType' -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located ShuntedType'
</span><a href="#local-6989586621680143950"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Located ShuntedType'
-&gt; Optic' A_Lens NoIx (Located ShuntedType') ShuntedType'
-&gt; ShuntedType'
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx (Located ShuntedType') ShuntedType'
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;to argument of kind&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MidKindedType -&gt; ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-var">getAnn'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ShuntedType, MidKindedType) -&gt; MidKindedType
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(ShuntedType, MidKindedType)
</span><a href="#local-6989586621680143951"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>        </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="Elara.Data.Kind.Infer.html#FunctionResult"><span class="hs-identifier hs-var">FunctionResult</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Result of function application&quot;</span></span><span>
</span><span id="line-90"></span><span>        </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="Elara.Data.Kind.Infer.html#ListElement"><span class="hs-identifier hs-var">ListElement</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;List element&quot;</span></span><span>
</span><span id="line-91"></span><span>        </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#RecordField"><span class="hs-identifier hs-type">RecordField</span></a></span><span> </span><span id="local-6989586621680143956"><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680143956"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Record field&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">LowerAlphaName -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680143956"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-92"></span><span>        </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="Elara.Data.Kind.Infer.html#FunctionParameter"><span class="hs-identifier hs-var">FunctionParameter</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Function parameter&quot;</span></span><span>
</span><span id="line-93"></span><span>        </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#DefinitionKind"><span class="hs-identifier hs-type">DefinitionKind</span></a></span><span> </span><span id="local-6989586621680143957"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680143957"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Definition of&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680143957"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-94"></span><span>        </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#PrimitiveConstraint"><span class="hs-identifier hs-type">PrimitiveConstraint</span></a></span><span> </span><span id="local-6989586621680143958"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680143958"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680143958"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-95"></span><span>        </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#UserDefinedTypeConstraint"><span class="hs-identifier hs-type">UserDefinedTypeConstraint</span></a></span><span> </span><span id="local-6989586621680143959"><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680143959"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;User defined type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680143959"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Optic'
     A_Lens NoIx (Located (Qualified TypeName)) (Qualified TypeName)
-&gt; Qualified TypeName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens NoIx (Located (Qualified TypeName)) (Qualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span class="annot"><a href="Elara.Data.Kind.Infer.html#originPositions"><span class="hs-identifier hs-type">originPositions</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#ConstraintOrigin"><span class="hs-identifier hs-type">ConstraintOrigin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Position</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Marker</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Doc</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AnsiStyle</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-98"></span><span id="originPositions"><span class="annot"><span class="annottext">originPositions :: ConstraintOrigin -&gt; [(Position, Marker (Doc AnsiStyle))]
</span><a href="Elara.Data.Kind.Infer.html#originPositions"><span class="hs-identifier hs-var hs-var">originPositions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionApplication"><span class="hs-identifier hs-type">FunctionApplication</span></a></span><span> </span><span id="local-6989586621680143965"><span class="annot"><span class="annottext">Located ShuntedType'
</span><a href="#local-6989586621680143965"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="annottext">(ShuntedType, MidKindedType)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Position
</span><a href="Elara.AST.Region.html#sourceRegionToDiagnosePosition"><span class="hs-identifier hs-var">sourceRegionToDiagnosePosition</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located ShuntedType'
</span><a href="#local-6989586621680143965"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Located ShuntedType'
-&gt; Optic' A_Lens NoIx (Located ShuntedType') SourceRegion
-&gt; SourceRegion
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx (Located ShuntedType') SourceRegion
forall a. HasSourceRegion a =&gt; Lens' a SourceRegion
</span><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier hs-var">sourceRegion</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Marker (Doc AnsiStyle)
forall msg. msg -&gt; Marker msg
</span><span class="hs-identifier hs-var">This</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Function application&quot;</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">data</span><span> </span><span id="InferState"><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-var">InferState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="InferState"><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-var">InferState</span></a></span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="env"><span class="annot"><span class="annottext">InferState
-&gt; Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
</span><a href="Elara.Data.Kind.Infer.html#env"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span>
</span><span id="line-104"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ a mapping from type variables and named types to their kind variables</span></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="kindEnv"><span class="annot"><span class="annottext">InferState -&gt; Map (Qualified TypeName) ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#kindEnv"><span class="hs-identifier hs-var hs-var">kindEnv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ predefined kinds for named types</span></span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="constraints"><span class="annot"><span class="annottext">InferState -&gt; [(ElaraKind, ElaraKind, ConstraintOrigin)]
</span><a href="Elara.Data.Kind.Infer.html#constraints"><span class="hs-identifier hs-var hs-var">constraints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#ConstraintOrigin"><span class="hs-identifier hs-type">ConstraintOrigin</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="substitution"><span class="annot"><span class="annottext">InferState -&gt; Map UniqueId ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#substitution"><span class="hs-identifier hs-var hs-var">substitution</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680143975"><span id="local-6989586621680143988"><span class="annot"><span class="annottext">InferState -&gt; InferState -&gt; Bool
(InferState -&gt; InferState -&gt; Bool)
-&gt; (InferState -&gt; InferState -&gt; Bool) -&gt; Eq InferState
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: InferState -&gt; InferState -&gt; Bool
== :: InferState -&gt; InferState -&gt; Bool
$c/= :: InferState -&gt; InferState -&gt; Bool
/= :: InferState -&gt; InferState -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680143999"><span id="local-6989586621680144013"><span id="local-6989586621680144017"><span class="annot"><span class="annottext">Int -&gt; InferState -&gt; ShowS
[InferState] -&gt; ShowS
InferState -&gt; String
(Int -&gt; InferState -&gt; ShowS)
-&gt; (InferState -&gt; String)
-&gt; ([InferState] -&gt; ShowS)
-&gt; Show InferState
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; InferState -&gt; ShowS
showsPrec :: Int -&gt; InferState -&gt; ShowS
$cshow :: InferState -&gt; String
show :: InferState -&gt; String
$cshowList :: [InferState] -&gt; ShowS
showList :: [InferState] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680144027"><span id="local-6989586621680144029"><span class="annot"><span class="annottext">(forall x. InferState -&gt; Rep InferState x)
-&gt; (forall x. Rep InferState x -&gt; InferState) -&gt; Generic InferState
forall x. Rep InferState x -&gt; InferState
forall x. InferState -&gt; Rep InferState x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. InferState -&gt; Rep InferState x
from :: forall x. InferState -&gt; Rep InferState x
$cto :: forall x. Rep InferState x -&gt; InferState
to :: forall x. Rep InferState x -&gt; InferState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680144034"><span id="local-6989586621680144050"><span id="local-6989586621680144064"><span id="local-6989586621680144066"><span id="local-6989586621680144068"><span id="local-6989586621680144074"><span id="local-6989586621680144079"><span id="local-6989586621680144082"><span id="local-6989586621680144085"><span id="local-6989586621680144088"><span id="local-6989586621680144091"><span id="local-6989586621680144094"><span id="local-6989586621680144099"><span id="local-6989586621680144104"><span class="annot"><span class="annottext">Typeable InferState
Typeable InferState =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; InferState -&gt; c InferState)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c InferState)
-&gt; (InferState -&gt; Constr)
-&gt; (InferState -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c InferState))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e))
    -&gt; Maybe (c InferState))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; InferState -&gt; InferState)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; InferState -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r)
    -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; InferState -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; InferState -&gt; [u])
-&gt; (forall u.
    Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; InferState -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState)
-&gt; Data InferState
InferState -&gt; Constr
InferState -&gt; DataType
(forall b. Data b =&gt; b -&gt; b) -&gt; InferState -&gt; InferState
forall a.
Typeable a =&gt;
(forall (c :: * -&gt; *).
 (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
 -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; InferState -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; InferState -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; InferState -&gt; r
forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; InferState -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c InferState
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; InferState -&gt; c InferState
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c InferState)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c InferState)
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; InferState -&gt; c InferState
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; InferState -&gt; c InferState
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c InferState
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c InferState
$ctoConstr :: InferState -&gt; Constr
toConstr :: InferState -&gt; Constr
$cdataTypeOf :: InferState -&gt; DataType
dataTypeOf :: InferState -&gt; DataType
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c InferState)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c InferState)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c InferState)
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c InferState)
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; InferState -&gt; InferState
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; InferState -&gt; InferState
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; InferState -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; InferState -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; InferState -&gt; r
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r)
-&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; InferState -&gt; r
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; InferState -&gt; [u]
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; InferState -&gt; [u]
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; InferState -&gt; u
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; InferState -&gt; u
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; InferState -&gt; m InferState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-keyword">type</span><span> </span><span id="KindInfer"><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-var">KindInfer</span></a></span></span><span> </span><span id="local-6989586621680144131"><span class="annot"><a href="#local-6989586621680144131"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680144131"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInferError"><span class="hs-identifier hs-type">KindInferError</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680144131"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680144131"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html#QueryEffects"><span class="hs-identifier hs-type">QueryEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144131"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680144131"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Elara.Data.Kind.Infer.html#initialInferState"><span class="hs-identifier hs-type">initialInferState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span>
</span><span id="line-122"></span><span id="initialInferState"><span class="annot"><span class="annottext">initialInferState :: InferState
</span><a href="Elara.Data.Kind.Infer.html#initialInferState"><span class="hs-identifier hs-var hs-var">initialInferState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span>
</span><span id="line-124"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">kindEnv :: Map (Qualified TypeName) ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#kindEnv"><span class="hs-identifier hs-var">kindEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Qualified TypeName) ElaraKind
</span><a href="Elara.Prim.html#primKindCheckContext"><span class="hs-identifier hs-var">primKindCheckContext</span></a></span><span>
</span><span id="line-125"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">env :: Map (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
</span><a href="Elara.Data.Kind.Infer.html#env"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-126"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">constraints :: [(ElaraKind, ElaraKind, ConstraintOrigin)]
</span><a href="Elara.Data.Kind.Infer.html#constraints"><span class="hs-identifier hs-var">constraints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ElaraKind, ElaraKind, ConstraintOrigin)]
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-127"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">substitution :: Map UniqueId ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#substitution"><span class="hs-identifier hs-var">substitution</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map UniqueId ElaraKind
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-128"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">data</span><span> </span><span id="KindInferError"><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInferError"><span class="hs-identifier hs-var">KindInferError</span></a></span></span><span>
</span><span id="line-131"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span id="UnknownKind"><span class="annot"><a href="Elara.Data.Kind.Infer.html#UnknownKind"><span class="hs-identifier hs-var">UnknownKind</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="UnboundVar"><span class="annot"><a href="Elara.Data.Kind.Infer.html#UnboundVar"><span class="hs-identifier hs-var">UnboundVar</span></a></span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="CannotUnify"><span class="annot"><a href="Elara.Data.Kind.Infer.html#CannotUnify"><span class="hs-identifier hs-var">CannotUnify</span></a></span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#ConstraintOrigin"><span class="hs-identifier hs-type">ConstraintOrigin</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="NotFunctionKind"><span class="annot"><a href="Elara.Data.Kind.Infer.html#NotFunctionKind"><span class="hs-identifier hs-var">NotFunctionKind</span></a></span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="OccursCheckFailed"><span class="annot"><a href="Elara.Data.Kind.Infer.html#OccursCheckFailed"><span class="hs-identifier hs-var">OccursCheckFailed</span></a></span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621680144149"><span id="local-6989586621680144151"><span class="annot"><span class="annottext">(forall x. KindInferError -&gt; Rep KindInferError x)
-&gt; (forall x. Rep KindInferError x -&gt; KindInferError)
-&gt; Generic KindInferError
forall x. Rep KindInferError x -&gt; KindInferError
forall x. KindInferError -&gt; Rep KindInferError x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. KindInferError -&gt; Rep KindInferError x
from :: forall x. KindInferError -&gt; Rep KindInferError x
$cto :: forall x. Rep KindInferError x -&gt; KindInferError
to :: forall x. Rep KindInferError x -&gt; KindInferError
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680144154"><span id="local-6989586621680144176"><span id="local-6989586621680144180"><span class="annot"><span class="annottext">Int -&gt; KindInferError -&gt; ShowS
[KindInferError] -&gt; ShowS
KindInferError -&gt; String
(Int -&gt; KindInferError -&gt; ShowS)
-&gt; (KindInferError -&gt; String)
-&gt; ([KindInferError] -&gt; ShowS)
-&gt; Show KindInferError
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; KindInferError -&gt; ShowS
showsPrec :: Int -&gt; KindInferError -&gt; ShowS
$cshow :: KindInferError -&gt; String
show :: KindInferError -&gt; String
$cshowList :: [KindInferError] -&gt; ShowS
showList :: [KindInferError] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680144183"><span class="annot"><a href="Elara.Data.Pretty.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInferError"><span class="hs-identifier hs-type">KindInferError</span></a></span></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621680144262"><span id="local-6989586621680144266"><span class="annot"><a href="Elara.Error.html#ReportableError"><span class="hs-identifier hs-type">ReportableError</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInferError"><span class="hs-identifier hs-type">KindInferError</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621680144322"><span class="annot"><span class="annottext">report :: forall (r :: [Effect]).
(DiagnosticWriter (Doc AnsiStyle) :&gt; r) =&gt;
KindInferError -&gt; Eff r ()
</span><a href="#local-6989586621680144322"><span class="hs-identifier hs-var hs-var hs-var">report</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#UnknownKind"><span class="hs-identifier hs-type">UnknownKind</span></a></span><span> </span><span id="local-6989586621680144324"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144324"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680144325"><span class="annot"><span class="annottext">Map (Qualified TypeName) ElaraKind
</span><a href="#local-6989586621680144325"><span class="hs-identifier hs-var">kinds</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>        </span><span class="annot"><span class="annottext">Report (Doc AnsiStyle) -&gt; Eff r ()
forall t (es :: [Effect]).
(HasCallStack, DiagnosticWriter t :&gt; es) =&gt;
Report t -&gt; Eff es ()
</span><a href="Elara.Error.Effect.html#writeReport"><span class="hs-identifier hs-var">writeReport</span></a></span><span> </span><span class="annot"><span class="annottext">(Report (Doc AnsiStyle) -&gt; Eff r ())
-&gt; Report (Doc AnsiStyle) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-143"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Doc AnsiStyle)
-&gt; Doc AnsiStyle
-&gt; [(Position, Marker (Doc AnsiStyle))]
-&gt; [Note (Doc AnsiStyle)]
-&gt; Report (Doc AnsiStyle)
forall msg.
Maybe msg
-&gt; msg -&gt; [(Position, Marker msg)] -&gt; [Note msg] -&gt; Report msg
</span><span class="hs-identifier hs-var">Err</span></span><span>
</span><span id="line-144"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Maybe (Doc AnsiStyle)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Unknown Kind of Type&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Doc AnsiStyle] -&gt; Doc AnsiStyle
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span>
</span><span id="line-146"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Unknown kind of type&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144324"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-147"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;We know kinds for:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set (Qualified TypeName) -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Qualified TypeName) ElaraKind -&gt; Set (Qualified TypeName)
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (Qualified TypeName) ElaraKind
</span><a href="#local-6989586621680144325"><span class="hs-identifier hs-var">kinds</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc AnsiStyle) -&gt; String -&gt; Doc AnsiStyle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; String
</span><span class="hs-identifier hs-var">prettyCallStack</span></span><span> </span><span class="annot"><span class="annottext">CallStack
HasCallStack =&gt; CallStack
</span><span class="hs-identifier hs-var">callStack</span></span><span>
</span><span id="line-149"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-150"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="Elara.Error.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#CannotUnify"><span class="hs-identifier hs-type">CannotUnify</span></a></span><span> </span><span id="local-6989586621680144332"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144332"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680144333"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144333"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680144334"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680144334"><span class="hs-identifier hs-var">origin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">Report (Doc AnsiStyle) -&gt; Eff r ()
forall t (es :: [Effect]).
(HasCallStack, DiagnosticWriter t :&gt; es) =&gt;
Report t -&gt; Eff es ()
</span><a href="Elara.Error.Effect.html#writeReport"><span class="hs-identifier hs-var">writeReport</span></a></span><span> </span><span class="annot"><span class="annottext">(Report (Doc AnsiStyle) -&gt; Eff r ())
-&gt; Report (Doc AnsiStyle) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-155"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Doc AnsiStyle)
-&gt; Doc AnsiStyle
-&gt; [(Position, Marker (Doc AnsiStyle))]
-&gt; [Note (Doc AnsiStyle)]
-&gt; Report (Doc AnsiStyle)
forall msg.
Maybe msg
-&gt; msg -&gt; [(Position, Marker msg)] -&gt; [Note msg] -&gt; Report msg
</span><span class="hs-identifier hs-var">Err</span></span><span>
</span><span id="line-156"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Maybe (Doc AnsiStyle)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Cannot Unify Kinds&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc AnsiStyle] -&gt; Doc AnsiStyle
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Cannot unify kinds&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144332"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;and&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144333"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Origin:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680144334"><span class="hs-identifier hs-var">origin</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ConstraintOrigin -&gt; [(Position, Marker (Doc AnsiStyle))]
</span><a href="Elara.Data.Kind.Infer.html#originPositions"><span class="hs-identifier hs-var">originPositions</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680144334"><span class="hs-identifier hs-var">origin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="Elara.Error.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#NotFunctionKind"><span class="hs-identifier hs-type">NotFunctionKind</span></a></span><span> </span><span id="local-6989586621680144335"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144335"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-161"></span><span>        </span><span class="annot"><span class="annottext">Report (Doc AnsiStyle) -&gt; Eff r ()
forall t (es :: [Effect]).
(HasCallStack, DiagnosticWriter t :&gt; es) =&gt;
Report t -&gt; Eff es ()
</span><a href="Elara.Error.Effect.html#writeReport"><span class="hs-identifier hs-var">writeReport</span></a></span><span> </span><span class="annot"><span class="annottext">(Report (Doc AnsiStyle) -&gt; Eff r ())
-&gt; Report (Doc AnsiStyle) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-162"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Doc AnsiStyle)
-&gt; Doc AnsiStyle
-&gt; [(Position, Marker (Doc AnsiStyle))]
-&gt; [Note (Doc AnsiStyle)]
-&gt; Report (Doc AnsiStyle)
forall msg.
Maybe msg
-&gt; msg -&gt; [(Position, Marker msg)] -&gt; [Note msg] -&gt; Report msg
</span><span class="hs-identifier hs-var">Err</span></span><span>
</span><span id="line-163"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Maybe (Doc AnsiStyle)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Not Function Kind&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc AnsiStyle] -&gt; Doc AnsiStyle
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Expected a function kind, got&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144335"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-166"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><a href="Elara.Error.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#UnboundVar"><span class="hs-identifier hs-type">UnboundVar</span></a></span><span> </span><span id="local-6989586621680144336"><span class="annot"><span class="annottext">Unique LowerAlphaName
</span><a href="#local-6989586621680144336"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621680144337"><span class="annot"><span class="annottext">Map (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
</span><a href="#local-6989586621680144337"><span class="hs-identifier hs-var">env</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">Report (Doc AnsiStyle) -&gt; Eff r ()
forall t (es :: [Effect]).
(HasCallStack, DiagnosticWriter t :&gt; es) =&gt;
Report t -&gt; Eff es ()
</span><a href="Elara.Error.Effect.html#writeReport"><span class="hs-identifier hs-var">writeReport</span></a></span><span> </span><span class="annot"><span class="annottext">(Report (Doc AnsiStyle) -&gt; Eff r ())
-&gt; Report (Doc AnsiStyle) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Doc AnsiStyle)
-&gt; Doc AnsiStyle
-&gt; [(Position, Marker (Doc AnsiStyle))]
-&gt; [Note (Doc AnsiStyle)]
-&gt; Report (Doc AnsiStyle)
forall msg.
Maybe msg
-&gt; msg -&gt; [(Position, Marker msg)] -&gt; [Note msg] -&gt; Report msg
</span><span class="hs-identifier hs-var">Err</span></span><span>
</span><span id="line-170"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Maybe (Doc AnsiStyle)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Unbound Variable&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">[Doc AnsiStyle] -&gt; Doc AnsiStyle
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span>
</span><span id="line-172"></span><span>                    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Unbound variable&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Unique LowerAlphaName -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Unique LowerAlphaName
</span><a href="#local-6989586621680144336"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-173"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Known variables:&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Set (Either (Qualified TypeName) (Unique LowerAlphaName))
-&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Map (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
-&gt; Set (Either (Qualified TypeName) (Unique LowerAlphaName))
forall k a. Map k a -&gt; Set k
</span><span class="hs-identifier hs-var">Map.keysSet</span></span><span> </span><span class="annot"><span class="annottext">Map (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
</span><a href="#local-6989586621680144337"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Doc AnsiStyle) -&gt; String -&gt; Doc AnsiStyle
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">CallStack -&gt; String
</span><span class="hs-identifier hs-var">prettyCallStack</span></span><span> </span><span class="annot"><span class="annottext">CallStack
HasCallStack =&gt; CallStack
</span><span class="hs-identifier hs-var">callStack</span></span><span>
</span><span id="line-175"></span><span>                    </span><span class="hs-special">]</span><span>
</span><span id="line-176"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-178"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="Elara.Error.html#report"><span class="hs-identifier hs-var">report</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#OccursCheckFailed"><span class="hs-identifier hs-type">OccursCheckFailed</span></a></span><span> </span><span id="local-6989586621680144338"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144338"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621680144339"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144339"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">Report (Doc AnsiStyle) -&gt; Eff r ()
forall t (es :: [Effect]).
(HasCallStack, DiagnosticWriter t :&gt; es) =&gt;
Report t -&gt; Eff es ()
</span><a href="Elara.Error.Effect.html#writeReport"><span class="hs-identifier hs-var">writeReport</span></a></span><span> </span><span class="annot"><span class="annottext">(Report (Doc AnsiStyle) -&gt; Eff r ())
-&gt; Report (Doc AnsiStyle) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Doc AnsiStyle)
-&gt; Doc AnsiStyle
-&gt; [(Position, Marker (Doc AnsiStyle))]
-&gt; [Note (Doc AnsiStyle)]
-&gt; Report (Doc AnsiStyle)
forall msg.
Maybe msg
-&gt; msg -&gt; [(Position, Marker msg)] -&gt; [Note msg] -&gt; Report msg
</span><span class="hs-identifier hs-var">Err</span></span><span>
</span><span id="line-182"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Maybe (Doc AnsiStyle)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Occurs Check Failed&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Doc AnsiStyle] -&gt; Doc AnsiStyle
forall ann. [Doc ann] -&gt; Doc ann
</span><span class="hs-identifier hs-var">vsep</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Occurs check failed for&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144338"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;and&quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><span class="hs-operator hs-var">&lt;+&gt;</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144339"><span class="hs-identifier hs-var">kind</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span id="local-6989586621680143147"><span class="annot"><a href="Elara.Data.Kind.Infer.html#declareTypeVar"><span class="hs-identifier hs-type">declareTypeVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143147"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143147"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-188"></span><span id="declareTypeVar"><span class="annot"><span class="annottext">declareTypeVar :: forall (r :: [Effect]).
(State InferState :&gt; r) =&gt;
Unique LowerAlphaName -&gt; UniqueId -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#declareTypeVar"><span class="hs-identifier hs-var hs-var">declareTypeVar</span></a></span></span><span> </span><span id="local-6989586621680144394"><span class="annot"><span class="annottext">Unique LowerAlphaName
</span><a href="#local-6989586621680144394"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621680144395"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144395"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InferState -&gt; InferState) -&gt; Eff r ()
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; s) -&gt; Eff es ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  InferState
  InferState
  (Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
  (Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
-&gt; (Map
      (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
    -&gt; Map
         (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
-&gt; InferState
-&gt; InferState
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  InferState
  InferState
  (Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
  (Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
</span><span class="">#env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either (Qualified TypeName) (Unique LowerAlphaName)
-&gt; UniqueId
-&gt; Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
-&gt; Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique LowerAlphaName
-&gt; Either (Qualified TypeName) (Unique LowerAlphaName)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">Unique LowerAlphaName
</span><a href="#local-6989586621680144394"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144395"><span class="hs-identifier hs-var">kindVar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621680143269"><span class="annot"><a href="Elara.Data.Kind.Infer.html#declareNamedType"><span class="hs-identifier hs-type">declareNamedType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143269"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143269"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-191"></span><span id="declareNamedType"><span class="annot"><span class="annottext">declareNamedType :: forall (r :: [Effect]).
(State InferState :&gt; r) =&gt;
Qualified TypeName -&gt; UniqueId -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#declareNamedType"><span class="hs-identifier hs-var hs-var">declareNamedType</span></a></span></span><span> </span><span id="local-6989586621680144441"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144441"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680144442"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144442"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InferState -&gt; InferState) -&gt; Eff r ()
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; s) -&gt; Eff es ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  InferState
  InferState
  (Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
  (Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
-&gt; (Map
      (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
    -&gt; Map
         (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
-&gt; InferState
-&gt; InferState
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  InferState
  InferState
  (Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
  (Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId)
</span><span class="">#env</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Either (Qualified TypeName) (Unique LowerAlphaName)
-&gt; UniqueId
-&gt; Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
-&gt; Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; Either (Qualified TypeName) (Unique LowerAlphaName)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144441"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144442"><span class="hs-identifier hs-var">kindVar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="annot"><span class="hs-comment">-- | Pass 1: Register a type name with a fresh kind variable (the &quot;hole&quot;).</span></span><span>
</span><span id="line-194"></span><span id="local-6989586621680143271"><span class="annot"><a href="Elara.Data.Kind.Infer.html#preRegisterType"><span class="hs-identifier hs-type">preRegisterType</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143271"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143271"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143271"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-200"></span><span id="preRegisterType"><span class="annot"><span class="annottext">preRegisterType :: forall (r :: [Effect]).
(State InferState :&gt; r, UniqueGen :&gt; r, HasCallStack) =&gt;
Qualified TypeName -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#preRegisterType"><span class="hs-identifier hs-var hs-var">preRegisterType</span></a></span></span><span> </span><span id="local-6989586621680144450"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144450"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-201"></span><span>    </span><span id="local-6989586621680144451"><span class="annot"><a href="#local-6989586621680144451"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r UniqueId
forall (r :: [Effect]). (UniqueGen :&gt; r) =&gt; Eff r UniqueId
</span><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-var">makeUniqueId</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#declareNamedType"><span class="hs-identifier hs-type">declareNamedType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144450"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144451"><span class="hs-identifier hs-type">kindVar</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621680143276"><span class="annot"><a href="Elara.Data.Kind.Infer.html#elaborate"><span class="hs-identifier hs-type">elaborate</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143276"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier hs-type">LowerAlphaName</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="Elara.AST.Shunted.html#ShuntedTypeDeclaration"><span class="hs-identifier hs-type">ShuntedTypeDeclaration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143276"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#MidKindedTypeDeclaration"><span class="hs-identifier hs-type">MidKindedTypeDeclaration</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-211"></span><span id="elaborate"><span class="annot"><span class="annottext">elaborate :: forall (r :: [Effect]).
KindInfer r =&gt;
Qualified TypeName
-&gt; [Located (Unique LowerAlphaName)]
-&gt; ShuntedTypeDeclaration
-&gt; Eff r (UniqueId, MidKindedTypeDeclaration)
</span><a href="Elara.Data.Kind.Infer.html#elaborate"><span class="hs-identifier hs-var hs-var">elaborate</span></a></span></span><span> </span><span id="local-6989586621680144514"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144514"><span class="hs-identifier hs-var">tName</span></a></span></span><span> </span><span id="local-6989586621680144515"><span class="annot"><span class="annottext">[Located (Unique LowerAlphaName)]
</span><a href="#local-6989586621680144515"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621680144516"><span class="annot"><span class="annottext">ShuntedTypeDeclaration
</span><a href="#local-6989586621680144516"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
-&gt; Eff r (UniqueId, MidKindedTypeDeclaration)
-&gt; Eff r (UniqueId, MidKindedTypeDeclaration)
forall (r :: [Effect]) a.
(HasCallStack, StructuredDebug :&gt; r) =&gt;
Doc AnsiStyle -&gt; Eff r a -&gt; Eff r a
</span><a href="Elara.Logging.html#debugWith"><span class="hs-identifier hs-var">debugWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;elaborate: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144514"><span class="hs-identifier hs-var">tName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff r (UniqueId, MidKindedTypeDeclaration)
 -&gt; Eff r (UniqueId, MidKindedTypeDeclaration))
-&gt; Eff r (UniqueId, MidKindedTypeDeclaration)
-&gt; Eff r (UniqueId, MidKindedTypeDeclaration)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-212"></span><span>    </span><span id="local-6989586621680144517"><span class="annot"><a href="#local-6989586621680144517"><span class="hs-identifier hs-var">varKinds</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located (Unique LowerAlphaName)]
-&gt; (Located (Unique LowerAlphaName) -&gt; Eff r UniqueId)
-&gt; Eff r [UniqueId]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[Located (Unique LowerAlphaName)]
</span><a href="#local-6989586621680144515"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="annot"><span class="annottext">((Located (Unique LowerAlphaName) -&gt; Eff r UniqueId)
 -&gt; Eff r [UniqueId])
-&gt; (Located (Unique LowerAlphaName) -&gt; Eff r UniqueId)
-&gt; Eff r [UniqueId]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680144519"><span class="annot"><span class="annottext">Located (Unique LowerAlphaName)
</span><a href="#local-6989586621680144519"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-213"></span><span>        </span><span id="local-6989586621680144520"><span class="annot"><a href="#local-6989586621680144520"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r UniqueId
forall (r :: [Effect]). (UniqueGen :&gt; r) =&gt; Eff r UniqueId
</span><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-var">makeUniqueId</span></a></span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#declareTypeVar"><span class="hs-identifier hs-type">declareTypeVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680144519"><span class="hs-identifier hs-type">tv</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680144520"><span class="hs-identifier hs-type">kindVar</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621680144520"><span class="hs-identifier hs-type">kindVar</span></a></span><span>
</span><span id="line-216"></span><span>
</span><span id="line-217"></span><span>    </span><span id="local-6989586621680144521"><span class="annot"><a href="#local-6989586621680144521"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621680144516"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-218"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Alias"><span class="hs-identifier hs-type">Alias</span></a></span><span> </span><span id="local-6989586621680144523"><span class="annot"><span class="annottext">Select Alias Shunted
</span><a href="#local-6989586621680144523"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>            </span><span id="local-6989586621680144524"><span class="annot"><a href="#local-6989586621680144524"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShuntedType -&gt; Eff r MidKindedType
forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r MidKindedType
</span><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-var">elaborateType</span></a></span><span> </span><span class="annot"><span class="annottext">ShuntedType
Select Alias Shunted
</span><a href="#local-6989586621680144523"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-220"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-type">getAnn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144524"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-type">TypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#DefinitionKind"><span class="hs-identifier hs-type">DefinitionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144514"><span class="hs-identifier hs-type">tName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Alias"><span class="hs-identifier hs-type">Alias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144524"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ADT"><span class="hs-identifier hs-type">ADT</span></a></span><span> </span><span id="local-6989586621680144529"><span class="annot"><span class="annottext">NonEmpty
  (ASTLocate Shunted (Select ConstructorName Shunted),
   [Select ADTParam Shunted])
</span><a href="#local-6989586621680144529"><span class="hs-identifier hs-var">constructors</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-223"></span><span>            </span><span id="local-6989586621680144530"><span class="annot"><a href="#local-6989586621680144530"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located (Qualified TypeName), [ShuntedType])
-&gt; ((Located (Qualified TypeName), [ShuntedType])
    -&gt; Eff r (Located (Qualified TypeName), [MidKindedType]))
-&gt; Eff r (NonEmpty (Located (Qualified TypeName), [MidKindedType]))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located (Qualified TypeName), [ShuntedType])
NonEmpty
  (ASTLocate Shunted (Select ConstructorName Shunted),
   [Select ADTParam Shunted])
</span><a href="#local-6989586621680144529"><span class="hs-identifier hs-var">constructors</span></a></span><span> </span><span class="annot"><span class="annottext">(((Located (Qualified TypeName), [ShuntedType])
  -&gt; Eff r (Located (Qualified TypeName), [MidKindedType]))
 -&gt; Eff
      r (NonEmpty (Located (Qualified TypeName), [MidKindedType])))
-&gt; ((Located (Qualified TypeName), [ShuntedType])
    -&gt; Eff r (Located (Qualified TypeName), [MidKindedType]))
-&gt; Eff r (NonEmpty (Located (Qualified TypeName), [MidKindedType]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680144531"><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680144531"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680144532"><span class="annot"><span class="annottext">[ShuntedType]
</span><a href="#local-6989586621680144532"><span class="hs-identifier hs-var">conArgs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-224"></span><span>                </span><span id="local-6989586621680144533"><span class="annot"><a href="#local-6989586621680144533"><span class="hs-identifier hs-var">conArgs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ShuntedType]
-&gt; (ShuntedType -&gt; Eff r MidKindedType) -&gt; Eff r [MidKindedType]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[ShuntedType]
</span><a href="#local-6989586621680144532"><span class="hs-identifier hs-var">conArgs</span></a></span><span> </span><span class="annot"><span class="annottext">((ShuntedType -&gt; Eff r MidKindedType) -&gt; Eff r [MidKindedType])
-&gt; (ShuntedType -&gt; Eff r MidKindedType) -&gt; Eff r [MidKindedType]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680144534"><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680144534"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-225"></span><span>                    </span><span id="local-6989586621680144535"><span class="annot"><a href="#local-6989586621680144535"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShuntedType -&gt; Eff r MidKindedType
forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r MidKindedType
</span><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-var">elaborateType</span></a></span><span> </span><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680144534"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-226"></span><span>                    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-type">getAnn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144535"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-type">TypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#DefinitionKind"><span class="hs-identifier hs-type">DefinitionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144514"><span class="hs-identifier hs-type">tName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621680144535"><span class="hs-identifier hs-type">arg'</span></a></span><span>
</span><span id="line-228"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680144531"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680144533"><span class="hs-identifier hs-type">conArgs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ADT"><span class="hs-identifier hs-type">ADT</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.AST.Select.html#MidKinded"><span class="hs-identifier hs-type">MidKinded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144530"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- We grab the kind variable of the data type</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- so we can add a constraint on it.</span><span>
</span><span id="line-233"></span><span>    </span><span id="local-6989586621680144536"><span class="annot"><a href="#local-6989586621680144536"><span class="hs-identifier hs-var">datatypeKindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#lookupNameKindVar"><span class="hs-identifier hs-type">lookupNameKindVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144514"><span class="hs-identifier hs-type">tName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#DefinitionKind"><span class="hs-identifier hs-type">DefinitionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144514"><span class="hs-identifier hs-type">tName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-comment">-- A type of the form `T a b c ... =` has the kind:</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-comment">-- `aKind -&gt; bKind -&gt; cKind -&gt; ... -&gt; Type`.</span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-comment">-- We add that as a constraint.</span><span>
</span><span id="line-238"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680144537"><span class="annot"><a href="#local-6989586621680144537"><span class="hs-identifier hs-var hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(UniqueId -&gt; ElaraKind -&gt; ElaraKind)
-&gt; ElaraKind -&gt; [UniqueId] -&gt; ElaraKind
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) a b.
Foldable t =&gt;
(a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ElaraKind -&gt; ElaraKind -&gt; ElaraKind
</span><a href="Elara.Data.Kind.html#FunctionKind"><span class="hs-identifier hs-var">FunctionKind</span></a></span><span> </span><span class="annot"><span class="annottext">(ElaraKind -&gt; ElaraKind -&gt; ElaraKind)
-&gt; (UniqueId -&gt; ElaraKind) -&gt; UniqueId -&gt; ElaraKind -&gt; ElaraKind
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind
</span><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-var">VarKind</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-var">TypeKind</span></a></span><span> </span><span class="annot"><span class="annottext">[UniqueId]
</span><a href="#local-6989586621680144517"><span class="hs-identifier hs-var">varKinds</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144536"><span class="hs-identifier hs-type">datatypeKindVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680144537"><span class="hs-identifier hs-type">kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#DefinitionKind"><span class="hs-identifier hs-type">DefinitionKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144514"><span class="hs-identifier hs-type">tName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680144536"><span class="hs-identifier hs-type">datatypeKindVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680144521"><span class="hs-identifier hs-type">t'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span id="local-6989586621680144542"><span class="annot"><a href="Elara.Data.Kind.Infer.html#inferKind"><span class="hs-identifier hs-type">inferKind</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The name of the type being inferred</span></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The type variables of the type being inferred</span></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The type declaration to infer the kind of</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><a href="Elara.AST.Shunted.html#ShuntedTypeDeclaration"><span class="hs-identifier hs-type">ShuntedTypeDeclaration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680144542"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#KindedTypeDeclaration"><span class="hs-identifier hs-type">KindedTypeDeclaration</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-252"></span><span id="inferKind"><span class="annot"><span class="annottext">inferKind :: Qualified TypeName
-&gt; [Located (Unique LowerAlphaName)]
-&gt; ShuntedTypeDeclaration
-&gt; Eff r (ElaraKind, KindedTypeDeclaration)
</span><a href="Elara.Data.Kind.Infer.html#inferKind"><span class="hs-identifier hs-var hs-var">inferKind</span></a></span></span><span> </span><span id="local-6989586621680144624"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144624"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680144625"><span class="annot"><span class="annottext">[Located (Unique LowerAlphaName)]
</span><a href="#local-6989586621680144625"><span class="hs-identifier hs-var">tvs</span></a></span></span><span> </span><span id="local-6989586621680144626"><span class="annot"><span class="annottext">ShuntedTypeDeclaration
</span><a href="#local-6989586621680144626"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Eff r ()
forall (r :: [Effect]).
(HasCallStack, StructuredDebug :&gt; r) =&gt;
Doc AnsiStyle -&gt; Eff r ()
</span><a href="Elara.Logging.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Inferring kind for type &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144624"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span id="local-6989586621680144627"><span class="annot"><a href="#local-6989586621680144627"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r UniqueId
forall (r :: [Effect]). (UniqueGen :&gt; r) =&gt; Eff r UniqueId
</span><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-var">makeUniqueId</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#declareNamedType"><span class="hs-identifier hs-type">declareNamedType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144624"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144627"><span class="hs-identifier hs-type">kindVar</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680144628"><span class="annot"><a href="#local-6989586621680144628"><span class="hs-identifier hs-var">kv</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680144629"><span class="annot"><a href="#local-6989586621680144629"><span class="hs-identifier hs-var">decl'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#elaborate"><span class="hs-identifier hs-type">elaborate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144624"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144625"><span class="hs-identifier hs-type">tvs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144626"><span class="hs-identifier hs-type">t</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-type">solveConstraints</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>    </span><span id="local-6989586621680144631"><span class="annot"><a href="#local-6989586621680144631"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#lookupKindVarInSubstitution"><span class="hs-identifier hs-type">lookupKindVarInSubstitution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144628"><span class="hs-identifier hs-type">kv</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="Elara.Logging.html#logDebug"><span class="hs-identifier hs-type">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Inferred kind for type &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144624"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144631"><span class="hs-identifier hs-type">kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span id="local-6989586621680144633"><span class="annot"><a href="#local-6989586621680144633"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621680144629"><span class="hs-identifier hs-type">decl'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Alias"><span class="hs-identifier hs-type">Alias</span></a></span><span> </span><span id="local-6989586621680144634"><span class="annot"><span class="annottext">Select Alias MidKinded
</span><a href="#local-6989586621680144634"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-264"></span><span>            </span><span id="local-6989586621680144635"><span class="annot"><a href="#local-6989586621680144635"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MidKindedType -&gt; Eff r KindedType
forall (r :: [Effect]).
KindInfer r =&gt;
MidKindedType -&gt; Eff r KindedType
</span><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-var">solveType</span></a></span><span> </span><span class="annot"><span class="annottext">MidKindedType
Select Alias MidKinded
</span><a href="#local-6989586621680144634"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-265"></span><span>            </span><span class="annot"><a href="Elara.Logging.html#logDebug"><span class="hs-identifier hs-type">logDebug</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-string">&quot;Inferred kind for alias &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144624"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;: &quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-type">pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144631"><span class="hs-identifier hs-type">kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Alias"><span class="hs-identifier hs-type">Alias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144635"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ADT"><span class="hs-identifier hs-type">ADT</span></a></span><span> </span><span id="local-6989586621680144637"><span class="annot"><span class="annottext">NonEmpty
  (CleanupLocated
     (ASTLocate' MidKinded (Select ConstructorName MidKinded)),
   [Select ADTParam MidKinded])
</span><a href="#local-6989586621680144637"><span class="hs-identifier hs-var">constructors</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-268"></span><span>            </span><span id="local-6989586621680144638"><span class="annot"><a href="#local-6989586621680144638"><span class="hs-identifier hs-var">constructors'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located (Qualified TypeName), [MidKindedType])
-&gt; ((Located (Qualified TypeName), [MidKindedType])
    -&gt; Eff r (Located (Qualified TypeName), [KindedType]))
-&gt; Eff r (NonEmpty (Located (Qualified TypeName), [KindedType]))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located (Qualified TypeName), [MidKindedType])
NonEmpty
  (CleanupLocated
     (ASTLocate' MidKinded (Select ConstructorName MidKinded)),
   [Select ADTParam MidKinded])
</span><a href="#local-6989586621680144637"><span class="hs-identifier hs-var">constructors</span></a></span><span> </span><span class="annot"><span class="annottext">(((Located (Qualified TypeName), [MidKindedType])
  -&gt; Eff r (Located (Qualified TypeName), [KindedType]))
 -&gt; Eff r (NonEmpty (Located (Qualified TypeName), [KindedType])))
-&gt; ((Located (Qualified TypeName), [MidKindedType])
    -&gt; Eff r (Located (Qualified TypeName), [KindedType]))
-&gt; Eff r (NonEmpty (Located (Qualified TypeName), [KindedType]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680144639"><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680144639"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680144640"><span class="annot"><span class="annottext">[MidKindedType]
</span><a href="#local-6989586621680144640"><span class="hs-identifier hs-var">conArgs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-269"></span><span>                </span><span id="local-6989586621680144641"><span class="annot"><a href="#local-6989586621680144641"><span class="hs-identifier hs-var">conArgs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[MidKindedType]
-&gt; (MidKindedType -&gt; Eff r KindedType) -&gt; Eff r [KindedType]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">[MidKindedType]
</span><a href="#local-6989586621680144640"><span class="hs-identifier hs-var">conArgs</span></a></span><span> </span><span class="annot"><span class="annottext">((MidKindedType -&gt; Eff r KindedType) -&gt; Eff r [KindedType])
-&gt; (MidKindedType -&gt; Eff r KindedType) -&gt; Eff r [KindedType]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680144642"><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680144642"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#MidKindedType"><span class="hs-identifier hs-type">MidKindedType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>                    </span><span class="annot"><span class="annottext">MidKindedType -&gt; Eff r KindedType
forall (r :: [Effect]).
KindInfer r =&gt;
MidKindedType -&gt; Eff r KindedType
</span><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-var">solveType</span></a></span><span> </span><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680144642"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680144639"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680144641"><span class="hs-identifier hs-type">conArgs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ADT"><span class="hs-identifier hs-type">ADT</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.AST.Select.html#Kinded"><span class="hs-identifier hs-type">Kinded</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144638"><span class="hs-identifier hs-type">constructors'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680144631"><span class="hs-identifier hs-type">kind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680144633"><span class="hs-identifier hs-type">body</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>
</span><span id="line-277"></span><span id="local-6989586621680143325"><span class="annot"><a href="Elara.Data.Kind.Infer.html#inferTypeKind"><span class="hs-identifier hs-type">inferTypeKind</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143325"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Shunted.html#ShuntedType"><span class="hs-identifier hs-type">ShuntedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143325"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#KindedType"><span class="hs-identifier hs-type">KindedType</span></a></span></span><span>
</span><span id="line-278"></span><span id="inferTypeKind"><span class="annot"><span class="annottext">inferTypeKind :: forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r KindedType
</span><a href="Elara.Data.Kind.Infer.html#inferTypeKind"><span class="hs-identifier hs-var hs-var">inferTypeKind</span></a></span></span><span> </span><span id="local-6989586621680144869"><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680144869"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><span class="annottext">[Located (Unique LowerAlphaName)]
-&gt; (Located (Unique LowerAlphaName) -&gt; Eff r ()) -&gt; Eff r ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f ()
</span><span class="hs-identifier hs-var">for_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ShuntedType -&gt; [ASTLocate Shunted (Select ASTTypeVar Shunted)]
forall {a1} {a2} (ast1 :: a1) {ast2 :: a2} {b}.
(CleanupLocated (ASTLocate' ast2 (Select ASTTypeVar ast2))
 ~ Located b,
 CleanupLocated (ASTLocate' ast1 (Select ASTTypeVar ast1))
 ~ Located b,
 CleanupLocated (ASTLocate' ast1 (Type' ast1))
 ~ Located (Type' ast2),
 Ord b, GPlateImpl (K1 R b) (Type' ast2),
 GPlateImpl (K1 R (Select TypeKind ast2)) (Type' ast2),
 GPlateImpl (K1 R (Select TupleType ast2)) (Type' ast2),
 GPlateImpl
   (K1
      R (CleanupLocated (ASTLocate' ast2 (Select UserDefinedType ast2))))
   (Type' ast2),
 GPlateImpl
   (K1 R (CleanupLocated (ASTLocate' ast2 (Type' ast2))))
   (Type' ast2),
 GPlateImpl
   (K1 R (CleanupLocated (ASTLocate' ast2 LowerAlphaName)))
   (Type' ast2)) =&gt;
Type ast1
-&gt; [CleanupLocated (ASTLocate' ast1 (Select ASTTypeVar ast1))]
</span><a href="Elara.AST.Generic.Types.html#freeTypeVars"><span class="hs-identifier hs-var">freeTypeVars</span></a></span><span> </span><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680144869"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Located (Unique LowerAlphaName) -&gt; Eff r ()) -&gt; Eff r ())
-&gt; (Located (Unique LowerAlphaName) -&gt; Eff r ()) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680144872"><span class="annot"><span class="annottext">Located (Unique LowerAlphaName)
</span><a href="#local-6989586621680144872"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>        </span><span id="local-6989586621680144873"><span class="annot"><a href="#local-6989586621680144873"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r UniqueId
forall (r :: [Effect]). (UniqueGen :&gt; r) =&gt; Eff r UniqueId
</span><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-var">makeUniqueId</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#declareTypeVar"><span class="hs-identifier hs-type">declareTypeVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680144872"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680144873"><span class="hs-identifier hs-type">kindVar</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span id="local-6989586621680144874"><span class="annot"><a href="#local-6989586621680144874"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShuntedType -&gt; Eff r MidKindedType
forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r MidKindedType
</span><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-var">elaborateType</span></a></span><span> </span><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680144869"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-type">solveConstraints</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-type">solveType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144874"><span class="hs-identifier hs-type">t'</span></a></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span id="local-6989586621680143321"><span class="annot"><a href="Elara.Data.Kind.Infer.html#lookupKindVarInSubstitution"><span class="hs-identifier hs-type">lookupKindVarInSubstitution</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143321"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143321"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span></span><span>
</span><span id="line-287"></span><span id="lookupKindVarInSubstitution"><span class="annot"><span class="annottext">lookupKindVarInSubstitution :: forall (r :: [Effect]). KindInfer r =&gt; UniqueId -&gt; Eff r ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#lookupKindVarInSubstitution"><span class="hs-identifier hs-var hs-var">lookupKindVarInSubstitution</span></a></span></span><span> </span><span id="local-6989586621680144885"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144885"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680144886"><span id="local-6989586621680144887"><span id="local-6989586621680144888"><span id="local-6989586621680144889"><span class="annot"><a href="Elara.Data.Kind.Infer.html#env"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r InferState
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
Eff es s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.lookup</span></span><span> </span><span class="annot"><a href="#local-6989586621680144885"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144889"><span class="hs-identifier hs-type">substitution</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-290"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680144892"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144892"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; Eff r ElaraKind
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144892"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span class="annot"><span class="annottext">Maybe ElaraKind
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; Eff r ElaraKind
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind
</span><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-var">VarKind</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144885"><span class="hs-identifier hs-var">var</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span id="local-6989586621680143307"><span class="annot"><a href="Elara.Data.Kind.Infer.html#lookupNameKindVar"><span class="hs-identifier hs-type">lookupNameKindVar</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143307"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143307"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInferError"><span class="hs-identifier hs-type">KindInferError</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143307"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html#QueryEffects"><span class="hs-identifier hs-type">QueryEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143307"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143307"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#ConstraintOrigin"><span class="hs-identifier hs-type">ConstraintOrigin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143307"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span></span><span>
</span><span id="line-301"></span><span id="lookupNameKindVar"><span class="annot"><span class="annottext">lookupNameKindVar :: forall (r :: [Effect]).
(State InferState :&gt; r, UniqueGen :&gt; r, Error KindInferError :&gt; r,
 QueryEffects r, Rock Query :&gt; r) =&gt;
Qualified TypeName -&gt; ConstraintOrigin -&gt; Eff r UniqueId
</span><a href="Elara.Data.Kind.Infer.html#lookupNameKindVar"><span class="hs-identifier hs-var hs-var">lookupNameKindVar</span></a></span></span><span> </span><span id="local-6989586621680144948"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144948"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680144949"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680144949"><span class="hs-identifier hs-var">origin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680144950"><span id="local-6989586621680144951"><span id="local-6989586621680144952"><span id="local-6989586621680144953"><span class="annot"><a href="Elara.Data.Kind.Infer.html#env"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r InferState
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
Eff es s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><a href="#local-6989586621680144948"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680144950"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-304"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680144954"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144954"><span class="hs-identifier hs-var">kv</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; Eff r UniqueId
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144954"><span class="hs-identifier hs-var">kv</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">Maybe UniqueId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-306"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; Map (Qualified TypeName) ElaraKind -&gt; Maybe ElaraKind
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144948"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Qualified TypeName) ElaraKind
</span><a href="#local-6989586621680144951"><span class="hs-identifier hs-var">kindEnv</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-307"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680144955"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680144955"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>                    </span><span id="local-6989586621680144956"><span class="annot"><a href="#local-6989586621680144956"><span class="hs-identifier hs-var">newKindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r UniqueId
forall (r :: [Effect]). (UniqueGen :&gt; r) =&gt; Eff r UniqueId
</span><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-var">makeUniqueId</span></a></span><span>
</span><span id="line-309"></span><span>                    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144956"><span class="hs-identifier hs-type">newKindVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680144955"><span class="hs-identifier hs-type">kindVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680144949"><span class="hs-identifier hs-type">origin</span></a></span><span>
</span><span id="line-310"></span><span>                    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621680144956"><span class="hs-identifier hs-type">newKindVar</span></a></span><span>
</span><span id="line-311"></span><span>                </span><span class="annot"><span class="annottext">Maybe ElaraKind
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>                    </span><span class="annot"><span class="annottext">Query (Rock Query : ConsQueryEffects '[]) (Maybe UniqueId)
-&gt; Eff r (Maybe UniqueId)
forall (xs :: [Effect]) (es :: [Effect]) (f :: [Effect] -&gt; * -&gt; *)
       a.
(Subset xs es, Rock f :&gt; es, HasCallStack,
 StructuredDebug :&gt; xs) =&gt;
f xs a -&gt; Eff es a
</span><a href="Rock.html#fetch"><span class="hs-identifier hs-var">Rock.fetch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; Query (Rock Query : ConsQueryEffects '[]) (Maybe UniqueId)
</span><a href="Elara.Query.html#KindOf"><span class="hs-identifier hs-var">Elara.Query.KindOf</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144948"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Eff r (Maybe UniqueId) -&gt; Eff r UniqueId -&gt; Eff r UniqueId
forall (m :: * -&gt; *) b. Monad m =&gt; m (Maybe b) -&gt; m b -&gt; m b
</span><a href="Prelude.html#%3F%3A%21"><span class="hs-operator hs-var">?:!</span></a></span><span> </span><span class="annot"><span class="annottext">KindInferError -&gt; Eff r UniqueId
forall e (es :: [Effect]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; Map (Qualified TypeName) ElaraKind -&gt; KindInferError
</span><a href="Elara.Data.Kind.Infer.html#UnknownKind"><span class="hs-identifier hs-var">UnknownKind</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680144948"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Qualified TypeName) ElaraKind
</span><a href="#local-6989586621680144951"><span class="hs-identifier hs-var">kindEnv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><span class="hs-comment">-- | Find the kind variable of a type variable in the environment.</span></span><span>
</span><span id="line-315"></span><span id="local-6989586621680143399"><span class="annot"><a href="Elara.Data.Kind.Infer.html#lookupVarKindVar"><span class="hs-identifier hs-type">lookupVarKindVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143399"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143399"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span></span><span>
</span><span id="line-316"></span><span id="lookupVarKindVar"><span class="annot"><span class="annottext">lookupVarKindVar :: forall (r :: [Effect]).
KindInfer r =&gt;
Unique LowerAlphaName -&gt; Eff r UniqueId
</span><a href="Elara.Data.Kind.Infer.html#lookupVarKindVar"><span class="hs-identifier hs-var hs-var">lookupVarKindVar</span></a></span></span><span> </span><span id="local-6989586621680144980"><span class="annot"><span class="annottext">Unique LowerAlphaName
</span><a href="#local-6989586621680144980"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680144981"><span id="local-6989586621680144982"><span id="local-6989586621680144983"><span id="local-6989586621680144984"><span class="annot"><a href="Elara.Data.Kind.Infer.html#env"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r InferState
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
Eff es s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-318"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.lookup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><a href="#local-6989586621680144980"><span class="hs-identifier hs-type">var</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680144981"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-319"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680144985"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144985"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; Eff r UniqueId
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680144985"><span class="hs-identifier hs-var">kindVar</span></a></span><span>
</span><span id="line-320"></span><span>        </span><span class="annot"><span class="annottext">Maybe UniqueId
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KindInferError -&gt; Eff r UniqueId
forall e (es :: [Effect]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(KindInferError -&gt; Eff r UniqueId)
-&gt; KindInferError -&gt; Eff r UniqueId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Unique LowerAlphaName
-&gt; Map
     (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
-&gt; KindInferError
</span><a href="Elara.Data.Kind.Infer.html#UnboundVar"><span class="hs-identifier hs-var">UnboundVar</span></a></span><span> </span><span class="annot"><span class="annottext">Unique LowerAlphaName
</span><a href="#local-6989586621680144980"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Map (Either (Qualified TypeName) (Unique LowerAlphaName)) UniqueId
</span><a href="#local-6989586621680144981"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span id="local-6989586621680143401"><span class="annot"><a href="Elara.Data.Kind.Infer.html#lookupKindVarMaybe"><span class="hs-identifier hs-type">lookupKindVarMaybe</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143401"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143401"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-323"></span><span id="lookupKindVarMaybe"><span class="annot"><span class="annottext">lookupKindVarMaybe :: forall (r :: [Effect]).
KindInfer r =&gt;
Either (Qualified TypeName) (Unique LowerAlphaName)
-&gt; Eff r (Maybe UniqueId)
</span><a href="Elara.Data.Kind.Infer.html#lookupKindVarMaybe"><span class="hs-identifier hs-var hs-var">lookupKindVarMaybe</span></a></span></span><span> </span><span id="local-6989586621680144999"><span class="annot"><span class="annottext">Either (Qualified TypeName) (Unique LowerAlphaName)
</span><a href="#local-6989586621680144999"><span class="hs-identifier hs-var">key</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680145000"><span id="local-6989586621680145001"><span id="local-6989586621680145002"><span id="local-6989586621680145003"><span class="annot"><a href="Elara.Data.Kind.Infer.html#env"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r InferState
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
Eff es s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.lookup</span></span><span> </span><span class="annot"><a href="#local-6989586621680144999"><span class="hs-identifier hs-type">key</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145000"><span class="hs-identifier hs-type">env</span></a></span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span id="local-6989586621680143299"><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143299"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#ConstraintOrigin"><span class="hs-identifier hs-type">ConstraintOrigin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143299"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-328"></span><span id="newEqualityConstraint"><span class="annot"><span class="annottext">newEqualityConstraint :: forall (r :: [Effect]).
(State InferState :&gt; r) =&gt;
ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-var hs-var">newEqualityConstraint</span></a></span></span><span> </span><span id="local-6989586621680145041"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145041"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680145042"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145042"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621680145043"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145043"><span class="hs-identifier hs-var">origin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(InferState -&gt; InferState) -&gt; Eff r ()
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; s) -&gt; Eff es ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  InferState
  InferState
  [(ElaraKind, ElaraKind, ConstraintOrigin)]
  [(ElaraKind, ElaraKind, ConstraintOrigin)]
-&gt; ([(ElaraKind, ElaraKind, ConstraintOrigin)]
    -&gt; [(ElaraKind, ElaraKind, ConstraintOrigin)])
-&gt; InferState
-&gt; InferState
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  InferState
  InferState
  [(ElaraKind, ElaraKind, ConstraintOrigin)]
  [(ElaraKind, ElaraKind, ConstraintOrigin)]
</span><span class="">#constraints</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145041"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145042"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145043"><span class="hs-identifier hs-var">origin</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ElaraKind, ElaraKind, ConstraintOrigin)
-&gt; [(ElaraKind, ElaraKind, ConstraintOrigin)]
-&gt; [(ElaraKind, ElaraKind, ConstraintOrigin)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span id="local-6989586621680143298"><span class="annot"><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-type">elaborateType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143298"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Shunted.html#ShuntedType"><span class="hs-identifier hs-type">ShuntedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143298"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#MidKindedType"><span class="hs-identifier hs-type">MidKindedType</span></a></span></span><span>
</span><span id="line-331"></span><span id="elaborateType"><span class="annot"><span class="annottext">elaborateType :: forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r MidKindedType
</span><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-var hs-var">elaborateType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680145172"><span class="annot"><span class="annottext">Located ShuntedType'
</span><a href="#local-6989586621680145172"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type%27"><span class="hs-identifier hs-type">Type'</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Shunted"><span class="hs-identifier hs-type">Shunted</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NoFieldValue
Select TypeKind Shunted
</span><a href="Elara.AST.Generic.Common.html#NoFieldValue"><span class="hs-identifier hs-var">NoFieldValue</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Located ShuntedType'
</span><a href="#local-6989586621680145172"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Located ShuntedType'
-&gt; Optic' A_Lens NoIx (Located ShuntedType') ShuntedType'
-&gt; ShuntedType'
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx (Located ShuntedType') ShuntedType'
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span id="local-6989586621680145175"><span class="annot"><span class="annottext">ASTLocate Shunted (Select ASTTypeVar Shunted)
</span><a href="#local-6989586621680145175"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-334"></span><span>            </span><span id="local-6989586621680145176"><span class="annot"><a href="#local-6989586621680145176"><span class="hs-identifier hs-var">kv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unique LowerAlphaName -&gt; Eff r UniqueId
forall (r :: [Effect]).
KindInfer r =&gt;
Unique LowerAlphaName -&gt; Eff r UniqueId
</span><a href="Elara.Data.Kind.Infer.html#lookupVarKindVar"><span class="hs-identifier hs-var">lookupVarKindVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (Unique LowerAlphaName)
ASTLocate Shunted (Select ASTTypeVar Shunted)
</span><a href="#local-6989586621680145175"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Unique LowerAlphaName)
-&gt; Optic'
     A_Lens
     NoIx
     (Located (Unique LowerAlphaName))
     (Unique LowerAlphaName)
-&gt; Unique LowerAlphaName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  NoIx
  (Located (Unique LowerAlphaName))
  (Unique LowerAlphaName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145175"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145172"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145176"><span class="hs-identifier hs-type">kv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><span class="annottext">ShuntedType'
</span><a href="Elara.AST.Generic.Types.html#UnitType"><span class="hs-identifier hs-var">UnitType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>            </span><span id="local-6989586621680145179"><span class="annot"><a href="#local-6989586621680145179"><span class="hs-identifier hs-var">kv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r UniqueId
forall (r :: [Effect]). (UniqueGen :&gt; r) =&gt; Eff r UniqueId
</span><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-var">makeUniqueId</span></a></span><span>
</span><span id="line-338"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145179"><span class="hs-identifier hs-type">kv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-type">TypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#PrimitiveConstraint"><span class="hs-identifier hs-type">PrimitiveConstraint</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Unit must be of kind Type&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#UnitType"><span class="hs-identifier hs-type">UnitType</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145172"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145179"><span class="hs-identifier hs-type">kv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-type">UserDefinedType</span></a></span><span> </span><span id="local-6989586621680145181"><span class="annot"><span class="annottext">ASTLocate Shunted (Select UserDefinedType Shunted)
</span><a href="#local-6989586621680145181"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-341"></span><span>            </span><span id="local-6989586621680145182"><span class="annot"><a href="#local-6989586621680145182"><span class="hs-identifier hs-var">kv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Qualified TypeName -&gt; ConstraintOrigin -&gt; Eff r UniqueId
forall (r :: [Effect]).
(State InferState :&gt; r, UniqueGen :&gt; r, Error KindInferError :&gt; r,
 QueryEffects r, Rock Query :&gt; r) =&gt;
Qualified TypeName -&gt; ConstraintOrigin -&gt; Eff r UniqueId
</span><a href="Elara.Data.Kind.Infer.html#lookupNameKindVar"><span class="hs-identifier hs-var">lookupNameKindVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (Qualified TypeName)
ASTLocate Shunted (Select UserDefinedType Shunted)
</span><a href="#local-6989586621680145181"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Optic'
     A_Lens NoIx (Located (Qualified TypeName)) (Qualified TypeName)
-&gt; Qualified TypeName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens NoIx (Located (Qualified TypeName)) (Qualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (Qualified TypeName) -&gt; ConstraintOrigin
</span><a href="Elara.Data.Kind.Infer.html#UserDefinedTypeConstraint"><span class="hs-identifier hs-var">UserDefinedTypeConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
ASTLocate Shunted (Select UserDefinedType Shunted)
</span><a href="#local-6989586621680145181"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-type">UserDefinedType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145181"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145172"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145182"><span class="hs-identifier hs-type">kv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-type">TypeConstructorApplication</span></a></span><span> </span><span id="local-6989586621680145184"><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145184"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680145185"><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145185"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-344"></span><span>            </span><span id="local-6989586621680145186"><span class="annot"><a href="#local-6989586621680145186"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShuntedType -&gt; Eff r MidKindedType
forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r MidKindedType
</span><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-var">elaborateType</span></a></span><span> </span><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145184"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-345"></span><span>            </span><span id="local-6989586621680145187"><span class="annot"><a href="#local-6989586621680145187"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-type">elaborateType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145185"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-346"></span><span>            </span><span id="local-6989586621680145188"><span class="annot"><a href="#local-6989586621680145188"><span class="hs-identifier hs-var">typeAppKindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-type">makeUniqueId</span></a></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span>
</span><span id="line-349"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-type">getAnn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145186"><span class="hs-identifier hs-type">f'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#FunctionKind"><span class="hs-identifier hs-type">FunctionKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-type">getAnn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145187"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145188"><span class="hs-identifier hs-type">typeAppKindVar</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionApplication"><span class="hs-identifier hs-type">FunctionApplication</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145172"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680145185"><span class="hs-identifier hs-type">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145187"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>
</span><span id="line-353"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-type">TypeConstructorApplication</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145186"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145187"><span class="hs-identifier hs-type">arg'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145172"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145188"><span class="hs-identifier hs-type">typeAppKindVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionType"><span class="hs-identifier hs-type">FunctionType</span></a></span><span> </span><span id="local-6989586621680145190"><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145190"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680145191"><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145191"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-355"></span><span>            </span><span id="local-6989586621680145192"><span class="annot"><a href="#local-6989586621680145192"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShuntedType -&gt; Eff r MidKindedType
forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r MidKindedType
</span><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-var">elaborateType</span></a></span><span> </span><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145190"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-356"></span><span>            </span><span id="local-6989586621680145193"><span class="annot"><a href="#local-6989586621680145193"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-type">elaborateType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145191"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-357"></span><span>            </span><span id="local-6989586621680145194"><span class="annot"><a href="#local-6989586621680145194"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-type">makeUniqueId</span></a></span><span>
</span><span id="line-358"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-type">getAnn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145192"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-type">TypeKind</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionParameter"><span class="hs-identifier hs-type">FunctionParameter</span></a></span><span>
</span><span id="line-359"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-type">getAnn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145193"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-type">TypeKind</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionResult"><span class="hs-identifier hs-type">FunctionResult</span></a></span><span>
</span><span id="line-360"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145194"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-type">TypeKind</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#FunctionResult"><span class="hs-identifier hs-type">FunctionResult</span></a></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionType"><span class="hs-identifier hs-type">FunctionType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145192"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145193"><span class="hs-identifier hs-type">b'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145172"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145194"><span class="hs-identifier hs-type">res</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListType"><span class="hs-identifier hs-type">ListType</span></a></span><span> </span><span id="local-6989586621680145196"><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145196"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-364"></span><span>            </span><span id="local-6989586621680145197"><span class="annot"><a href="#local-6989586621680145197"><span class="hs-identifier hs-var">t''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShuntedType -&gt; Eff r MidKindedType
forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r MidKindedType
</span><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-var">elaborateType</span></a></span><span> </span><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145196"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-365"></span><span>            </span><span id="local-6989586621680145198"><span class="annot"><a href="#local-6989586621680145198"><span class="hs-identifier hs-var">listKindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-type">makeUniqueId</span></a></span><span>
</span><span id="line-366"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-type">getAnn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145197"><span class="hs-identifier hs-type">t''</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-type">TypeKind</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#ListElement"><span class="hs-identifier hs-type">ListElement</span></a></span><span>
</span><span id="line-367"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145198"><span class="hs-identifier hs-type">listKindVar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-type">TypeKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#PrimitiveConstraint"><span class="hs-identifier hs-type">PrimitiveConstraint</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;List is a Type&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListType"><span class="hs-identifier hs-type">ListType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145197"><span class="hs-identifier hs-type">t''</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145172"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145198"><span class="hs-identifier hs-type">listKindVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#RecordType"><span class="hs-identifier hs-type">RecordType</span></a></span><span> </span><span id="local-6989586621680145200"><span class="annot"><span class="annottext">NonEmpty (ASTLocate Shunted LowerAlphaName, ShuntedType)
</span><a href="#local-6989586621680145200"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-370"></span><span>            </span><span id="local-6989586621680145201"><span class="annot"><a href="#local-6989586621680145201"><span class="hs-identifier hs-var">fields'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located LowerAlphaName, ShuntedType)
-&gt; ((Located LowerAlphaName, ShuntedType)
    -&gt; Eff r (Located LowerAlphaName, MidKindedType))
-&gt; Eff r (NonEmpty (Located LowerAlphaName, MidKindedType))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
t a -&gt; (a -&gt; f b) -&gt; f (t b)
</span><span class="hs-identifier hs-var">for</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located LowerAlphaName, ShuntedType)
NonEmpty (ASTLocate Shunted LowerAlphaName, ShuntedType)
</span><a href="#local-6989586621680145200"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">(((Located LowerAlphaName, ShuntedType)
  -&gt; Eff r (Located LowerAlphaName, MidKindedType))
 -&gt; Eff r (NonEmpty (Located LowerAlphaName, MidKindedType)))
-&gt; ((Located LowerAlphaName, ShuntedType)
    -&gt; Eff r (Located LowerAlphaName, MidKindedType))
-&gt; Eff r (NonEmpty (Located LowerAlphaName, MidKindedType))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680145202"><span class="annot"><span class="annottext">Located LowerAlphaName
</span><a href="#local-6989586621680145202"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145203"><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145203"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>                </span><span id="local-6989586621680145204"><span class="annot"><a href="#local-6989586621680145204"><span class="hs-identifier hs-var">t''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ShuntedType -&gt; Eff r MidKindedType
forall (r :: [Effect]).
KindInfer r =&gt;
ShuntedType -&gt; Eff r MidKindedType
</span><a href="Elara.Data.Kind.Infer.html#elaborateType"><span class="hs-identifier hs-var">elaborateType</span></a></span><span> </span><span class="annot"><span class="annottext">ShuntedType
</span><a href="#local-6989586621680145203"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-372"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680145202"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145204"><span class="hs-identifier hs-type">t''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>            </span><span id="local-6989586621680145205"><span class="annot"><a href="#local-6989586621680145205"><span class="hs-identifier hs-var">recordKindVar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-type">makeUniqueId</span></a></span><span>
</span><span id="line-374"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">traverseOf_</span></span><span>
</span><span id="line-375"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">each</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_2</span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>                </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680145210"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145210"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; Eff r ()
forall (r :: [Effect]).
(State InferState :&gt; r) =&gt;
ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-var">newEqualityConstraint</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind
</span><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-var">VarKind</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145205"><span class="hs-identifier hs-var">recordKindVar</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind
</span><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-var">VarKind</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145210"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ConstraintOrigin
</span><a href="Elara.Data.Kind.Infer.html#PrimitiveConstraint"><span class="hs-identifier hs-var">PrimitiveConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;Record is a Type&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>                </span><span class="annot"><a href="#local-6989586621680145201"><span class="hs-identifier hs-type">fields'</span></a></span><span>
</span><span id="line-378"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#RecordType"><span class="hs-identifier hs-type">RecordType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145201"><span class="hs-identifier hs-type">fields'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145172"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145205"><span class="hs-identifier hs-type">recordKindVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>
</span><span id="line-380"></span><span id="local-6989586621680143323"><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-type">solveType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143323"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#MidKindedType"><span class="hs-identifier hs-type">MidKindedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143323"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#KindedType"><span class="hs-identifier hs-type">KindedType</span></a></span></span><span>
</span><span id="line-381"></span><span id="solveType"><span class="annot"><span class="annottext">solveType :: forall (r :: [Effect]).
KindInfer r =&gt;
MidKindedType -&gt; Eff r KindedType
</span><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-var hs-var">solveType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680145258"><span class="annot"><span class="annottext">ASTLocate MidKinded (Type' MidKinded)
</span><a href="#local-6989586621680145258"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145259"><span class="annot"><span class="annottext">Select TypeKind MidKinded
</span><a href="#local-6989586621680145259"><span class="hs-identifier hs-var">kindVar</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-382"></span><span>    </span><span id="local-6989586621680145260"><span class="annot"><a href="#local-6989586621680145260"><span class="hs-identifier hs-var">kind'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; Eff r ElaraKind
forall (r :: [Effect]). KindInfer r =&gt; UniqueId -&gt; Eff r ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#lookupKindVarInSubstitution"><span class="hs-identifier hs-var">lookupKindVarInSubstitution</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
Select TypeKind MidKinded
</span><a href="#local-6989586621680145259"><span class="hs-identifier hs-var">kindVar</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621680145258"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-384"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span id="local-6989586621680145261"><span class="annot"><span class="annottext">ASTLocate MidKinded (Select ASTTypeVar MidKinded)
</span><a href="#local-6989586621680145261"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-385"></span><span>            </span><span class="annot"><span class="annottext">KindedType -&gt; Eff r KindedType
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(KindedType -&gt; Eff r KindedType) -&gt; KindedType -&gt; Eff r KindedType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ASTLocate Kinded (Type' Kinded), Select TypeKind Kinded)
-&gt; KindedType
forall {a} (ast :: a).
(ASTLocate ast (Type' ast), Select TypeKind ast) -&gt; Type ast
</span><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTLocate Kinded (Select ASTTypeVar Kinded) -&gt; Type' Kinded
forall {a} (ast :: a).
ASTLocate ast (Select ASTTypeVar ast) -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#TypeVar"><span class="hs-identifier hs-var">TypeVar</span></a></span><span> </span><span class="annot"><span class="annottext">ASTLocate MidKinded (Select ASTTypeVar MidKinded)
ASTLocate Kinded (Select ASTTypeVar Kinded)
</span><a href="#local-6989586621680145261"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Type' Kinded -&gt; Located (Type' MidKinded) -&gt; Located (Type' Kinded)
forall a b. a -&gt; Located b -&gt; Located a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Located (Type' MidKinded)
ASTLocate MidKinded (Type' MidKinded)
</span><a href="#local-6989586621680145258"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ElaraKind
Select TypeKind Kinded
</span><a href="#local-6989586621680145260"><span class="hs-identifier hs-var">kind'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>        </span><span class="annot"><span class="annottext">Type' MidKinded
</span><a href="Elara.AST.Generic.Types.html#UnitType"><span class="hs-identifier hs-var">UnitType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KindedType -&gt; Eff r KindedType
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(KindedType -&gt; Eff r KindedType) -&gt; KindedType -&gt; Eff r KindedType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ASTLocate Kinded (Type' Kinded), Select TypeKind Kinded)
-&gt; KindedType
forall {a} (ast :: a).
(ASTLocate ast (Type' ast), Select TypeKind ast) -&gt; Type ast
</span><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type' Kinded
forall {a} (ast :: a). Type' ast
</span><a href="Elara.AST.Generic.Types.html#UnitType"><span class="hs-identifier hs-var">UnitType</span></a></span><span> </span><span class="annot"><span class="annottext">Type' Kinded -&gt; Located (Type' MidKinded) -&gt; Located (Type' Kinded)
forall a b. a -&gt; Located b -&gt; Located a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Located (Type' MidKinded)
ASTLocate MidKinded (Type' MidKinded)
</span><a href="#local-6989586621680145258"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ElaraKind
Select TypeKind Kinded
</span><a href="#local-6989586621680145260"><span class="hs-identifier hs-var">kind'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-type">UserDefinedType</span></a></span><span> </span><span id="local-6989586621680145262"><span class="annot"><span class="annottext">ASTLocate MidKinded (Select UserDefinedType MidKinded)
</span><a href="#local-6989586621680145262"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KindedType -&gt; Eff r KindedType
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(KindedType -&gt; Eff r KindedType) -&gt; KindedType -&gt; Eff r KindedType
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ASTLocate Kinded (Type' Kinded), Select TypeKind Kinded)
-&gt; KindedType
forall {a} (ast :: a).
(ASTLocate ast (Type' ast), Select TypeKind ast) -&gt; Type ast
</span><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTLocate Kinded (Select UserDefinedType Kinded) -&gt; Type' Kinded
forall {a} (ast :: a).
ASTLocate ast (Select UserDefinedType ast) -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-var">UserDefinedType</span></a></span><span> </span><span class="annot"><span class="annottext">ASTLocate MidKinded (Select UserDefinedType MidKinded)
ASTLocate Kinded (Select UserDefinedType Kinded)
</span><a href="#local-6989586621680145262"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Type' Kinded -&gt; Located (Type' MidKinded) -&gt; Located (Type' Kinded)
forall a b. a -&gt; Located b -&gt; Located a
forall (f :: * -&gt; *) a b. Functor f =&gt; a -&gt; f b -&gt; f a
</span><span class="hs-operator hs-var">&lt;$</span></span><span> </span><span class="annot"><span class="annottext">Located (Type' MidKinded)
ASTLocate MidKinded (Type' MidKinded)
</span><a href="#local-6989586621680145258"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ElaraKind
Select TypeKind Kinded
</span><a href="#local-6989586621680145260"><span class="hs-identifier hs-var">kind'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-type">TypeConstructorApplication</span></a></span><span> </span><span id="local-6989586621680145263"><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680145263"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621680145264"><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680145264"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>            </span><span id="local-6989586621680145265"><span class="annot"><a href="#local-6989586621680145265"><span class="hs-identifier hs-var">f'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MidKindedType -&gt; Eff r KindedType
forall (r :: [Effect]).
KindInfer r =&gt;
MidKindedType -&gt; Eff r KindedType
</span><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-var">solveType</span></a></span><span> </span><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680145263"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-390"></span><span>            </span><span id="local-6989586621680145266"><span class="annot"><a href="#local-6989586621680145266"><span class="hs-identifier hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-type">solveType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145264"><span class="hs-identifier hs-type">arg</span></a></span><span>
</span><span id="line-391"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-type">TypeConstructorApplication</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145265"><span class="hs-identifier hs-type">f'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145266"><span class="hs-identifier hs-type">arg'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145258"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145260"><span class="hs-identifier hs-type">kind'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionType"><span class="hs-identifier hs-type">FunctionType</span></a></span><span> </span><span id="local-6989586621680145267"><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680145267"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680145268"><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680145268"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-393"></span><span>            </span><span id="local-6989586621680145269"><span class="annot"><a href="#local-6989586621680145269"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MidKindedType -&gt; Eff r KindedType
forall (r :: [Effect]).
KindInfer r =&gt;
MidKindedType -&gt; Eff r KindedType
</span><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-var">solveType</span></a></span><span> </span><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680145267"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-394"></span><span>            </span><span id="local-6989586621680145270"><span class="annot"><a href="#local-6989586621680145270"><span class="hs-identifier hs-var">b'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-type">solveType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145268"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-395"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionType"><span class="hs-identifier hs-type">FunctionType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145269"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145270"><span class="hs-identifier hs-type">b'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145258"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145260"><span class="hs-identifier hs-type">kind'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListType"><span class="hs-identifier hs-type">ListType</span></a></span><span> </span><span id="local-6989586621680145271"><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680145271"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-397"></span><span>            </span><span id="local-6989586621680145272"><span class="annot"><a href="#local-6989586621680145272"><span class="hs-identifier hs-var">t''</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MidKindedType -&gt; Eff r KindedType
forall (r :: [Effect]).
KindInfer r =&gt;
MidKindedType -&gt; Eff r KindedType
</span><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-var">solveType</span></a></span><span> </span><span class="annot"><span class="annottext">MidKindedType
</span><a href="#local-6989586621680145271"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-398"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListType"><span class="hs-identifier hs-type">ListType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145272"><span class="hs-identifier hs-type">t''</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145258"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145260"><span class="hs-identifier hs-type">kind'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#RecordType"><span class="hs-identifier hs-type">RecordType</span></a></span><span> </span><span id="local-6989586621680145273"><span class="annot"><span class="annottext">NonEmpty (ASTLocate MidKinded LowerAlphaName, MidKindedType)
</span><a href="#local-6989586621680145273"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-400"></span><span>            </span><span id="local-6989586621680145274"><span class="annot"><a href="#local-6989586621680145274"><span class="hs-identifier hs-var">fields'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Optic
  A_Traversal
  (Int : NoIx)
  (NonEmpty (Located LowerAlphaName, MidKindedType))
  (NonEmpty (Located LowerAlphaName, KindedType))
  MidKindedType
  KindedType
-&gt; (MidKindedType -&gt; Eff r KindedType)
-&gt; NonEmpty (Located LowerAlphaName, MidKindedType)
-&gt; Eff r (NonEmpty (Located LowerAlphaName, KindedType))
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IxTraversal
  Int
  (NonEmpty (Located LowerAlphaName, MidKindedType))
  (NonEmpty (Located LowerAlphaName, KindedType))
  (Located LowerAlphaName, MidKindedType)
  (Located LowerAlphaName, KindedType)
forall i s t a b. Each i s t a b =&gt; IxTraversal i s t a b
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">IxTraversal
  Int
  (NonEmpty (Located LowerAlphaName, MidKindedType))
  (NonEmpty (Located LowerAlphaName, KindedType))
  (Located LowerAlphaName, MidKindedType)
  (Located LowerAlphaName, KindedType)
-&gt; Optic
     A_Lens
     NoIx
     (Located LowerAlphaName, MidKindedType)
     (Located LowerAlphaName, KindedType)
     MidKindedType
     KindedType
-&gt; Optic
     A_Traversal
     (Int : NoIx)
     (NonEmpty (Located LowerAlphaName, MidKindedType))
     (NonEmpty (Located LowerAlphaName, KindedType))
     MidKindedType
     KindedType
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  (Located LowerAlphaName, MidKindedType)
  (Located LowerAlphaName, KindedType)
  MidKindedType
  KindedType
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MidKindedType -&gt; Eff r KindedType
forall (r :: [Effect]).
KindInfer r =&gt;
MidKindedType -&gt; Eff r KindedType
</span><a href="Elara.Data.Kind.Infer.html#solveType"><span class="hs-identifier hs-var">solveType</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located LowerAlphaName, MidKindedType)
NonEmpty (ASTLocate MidKinded LowerAlphaName, MidKindedType)
</span><a href="#local-6989586621680145273"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-401"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#RecordType"><span class="hs-identifier hs-type">RecordType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145274"><span class="hs-identifier hs-type">fields'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$</span></span><span> </span><span class="annot"><a href="#local-6989586621680145258"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680145260"><span class="hs-identifier hs-type">kind'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-type">getAnn'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Kinded.html#MidKindedType"><span class="hs-identifier hs-type">MidKindedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span>
</span><span id="line-404"></span><span id="getAnn%27"><span class="annot"><span class="annottext">getAnn' :: MidKindedType -&gt; ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#getAnn%27"><span class="hs-identifier hs-var hs-var">getAnn'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTLocate MidKinded (Type' MidKinded)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145276"><span class="annot"><span class="annottext">Select TypeKind MidKinded
</span><a href="#local-6989586621680145276"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind
</span><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-var">VarKind</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
Select TypeKind MidKinded
</span><a href="#local-6989586621680145276"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621680143320"><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-type">solveConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143320"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Error</span></span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInferError"><span class="hs-identifier hs-type">KindInferError</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143320"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143320"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-411"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html#QueryEffects"><span class="hs-identifier hs-type">QueryEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143320"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143320"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-414"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143320"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-415"></span><span id="solveConstraints"><span class="annot"><span class="annottext">solveConstraints :: forall (r :: [Effect]).
(State InferState :&gt; r, Error KindInferError :&gt; r, HasCallStack,
 UniqueGen :&gt; r, QueryEffects r, Rock Query :&gt; r) =&gt;
Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-var hs-var">solveConstraints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-416"></span><span>    </span><span id="local-6989586621680145395"><span class="annot"><a href="#local-6989586621680145395"><span class="hs-identifier hs-var">constraint</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>        </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span class="hs-special">{</span><span id="local-6989586621680145396"><span id="local-6989586621680145397"><span id="local-6989586621680145398"><span id="local-6989586621680145399"><span class="annot"><a href="Elara.Data.Kind.Infer.html#env"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r InferState
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
Eff es s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-418"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621680145398"><span class="hs-identifier hs-type">constraints</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-419"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ElaraKind, ElaraKind, ConstraintOrigin)
-&gt; Eff r (Maybe (ElaraKind, ElaraKind, ConstraintOrigin))
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ElaraKind, ElaraKind, ConstraintOrigin)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-420"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680145400"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145400"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145401"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145401"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145402"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145402"><span class="hs-identifier hs-var">origin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680145403"><span class="annot"><span class="annottext">[(ElaraKind, ElaraKind, ConstraintOrigin)]
</span><a href="#local-6989586621680145403"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-421"></span><span>                </span><span class="annot"><span class="annottext">(InferState -&gt; InferState) -&gt; Eff r ()
forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; s) -&gt; Eff es ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  InferState
  InferState
  [(ElaraKind, ElaraKind, ConstraintOrigin)]
  [(ElaraKind, ElaraKind, ConstraintOrigin)]
-&gt; [(ElaraKind, ElaraKind, ConstraintOrigin)]
-&gt; InferState
-&gt; InferState
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">set</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  NoIx
  InferState
  InferState
  [(ElaraKind, ElaraKind, ConstraintOrigin)]
  [(ElaraKind, ElaraKind, ConstraintOrigin)]
</span><span class="">#constraints</span></span><span> </span><span class="annot"><span class="annottext">[(ElaraKind, ElaraKind, ConstraintOrigin)]
</span><a href="#local-6989586621680145403"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>                </span><span class="annot"><span class="annottext">Maybe (ElaraKind, ElaraKind, ConstraintOrigin)
-&gt; Eff r (Maybe (ElaraKind, ElaraKind, ConstraintOrigin))
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (ElaraKind, ElaraKind, ConstraintOrigin)
 -&gt; Eff r (Maybe (ElaraKind, ElaraKind, ConstraintOrigin)))
-&gt; Maybe (ElaraKind, ElaraKind, ConstraintOrigin)
-&gt; Eff r (Maybe (ElaraKind, ElaraKind, ConstraintOrigin))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(ElaraKind, ElaraKind, ConstraintOrigin)
-&gt; Maybe (ElaraKind, ElaraKind, ConstraintOrigin)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145400"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145401"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145402"><span class="hs-identifier hs-var">origin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621680145395"><span class="hs-identifier hs-type">constraint</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-425"></span><span>        </span><span class="hs-comment">-- If there are no constraints left, we're done</span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><span class="annottext">Maybe (ElaraKind, ElaraKind, ConstraintOrigin)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff r ()
forall (f :: * -&gt; *). Applicative f =&gt; f ()
</span><span class="hs-identifier hs-var">pass</span></span><span>
</span><span id="line-427"></span><span>        </span><span class="hs-comment">-- If we have 2 kinds that are the same, we can remove the constraint</span><span>
</span><span id="line-428"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ElaraKind
</span><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-var">TypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-var">TypeKind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff r ()
forall (r :: [Effect]).
(State InferState :&gt; r, Error KindInferError :&gt; r, HasCallStack,
 UniqueGen :&gt; r, QueryEffects r, Rock Query :&gt; r) =&gt;
Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-var">solveConstraints</span></a></span><span>
</span><span id="line-429"></span><span>        </span><span class="hs-comment">-- If we have 2 function kinds, we solve the constraints for the arguments and the result</span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#FunctionKind"><span class="hs-identifier hs-type">FunctionKind</span></a></span><span> </span><span id="local-6989586621680145405"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145405"><span class="hs-identifier hs-var">k1</span></a></span></span><span> </span><span id="local-6989586621680145406"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145406"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#FunctionKind"><span class="hs-identifier hs-type">FunctionKind</span></a></span><span> </span><span id="local-6989586621680145407"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145407"><span class="hs-identifier hs-var">k1'</span></a></span></span><span> </span><span id="local-6989586621680145408"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145408"><span class="hs-identifier hs-var">k2'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145409"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145409"><span class="hs-identifier hs-var">origin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-431"></span><span>            </span><span class="annot"><span class="annottext">ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; Eff r ()
forall (r :: [Effect]).
(State InferState :&gt; r) =&gt;
ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-var">newEqualityConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145405"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145407"><span class="hs-identifier hs-var">k1'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145409"><span class="hs-identifier hs-var">origin</span></a></span><span>
</span><span id="line-432"></span><span>            </span><span class="annot"><span class="annottext">ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; Eff r ()
forall (r :: [Effect]).
(State InferState :&gt; r) =&gt;
ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-var">newEqualityConstraint</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145406"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145408"><span class="hs-identifier hs-var">k2'</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145409"><span class="hs-identifier hs-var">origin</span></a></span><span>
</span><span id="line-433"></span><span>            </span><span class="annot"><span class="annottext">Eff r ()
forall (r :: [Effect]).
(State InferState :&gt; r, Error KindInferError :&gt; r, HasCallStack,
 UniqueGen :&gt; r, QueryEffects r, Rock Query :&gt; r) =&gt;
Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-var">solveConstraints</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span>        </span><span class="hs-comment">-- instantiate a kind scheme</span><span>
</span><span id="line-436"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#KindScheme"><span class="hs-identifier hs-type">KindScheme</span></a></span><span> </span><span id="local-6989586621680145411"><span class="annot"><span class="annottext">[UniqueId]
</span><a href="#local-6989586621680145411"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621680145412"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145412"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145413"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145413"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145414"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145414"><span class="hs-identifier hs-var">origin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-437"></span><span>            </span><span id="local-6989586621680145415"><span class="annot"><a href="#local-6989586621680145415"><span class="hs-identifier hs-var">kind'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; [UniqueId] -&gt; Eff r ElaraKind
forall (r :: [Effect]).
(UniqueGen :&gt; r) =&gt;
ElaraKind -&gt; [UniqueId] -&gt; Eff r ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#instantiate"><span class="hs-identifier hs-var">instantiate</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145412"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">[UniqueId]
</span><a href="#local-6989586621680145411"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-438"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145415"><span class="hs-identifier hs-type">kind'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145413"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145414"><span class="hs-identifier hs-type">origin</span></a></span><span>
</span><span id="line-439"></span><span>
</span><span id="line-440"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-type">solveConstraints</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-comment">-- instantiate a kind scheme (reversed)</span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680145417"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145417"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindScheme"><span class="hs-identifier hs-type">KindScheme</span></a></span><span> </span><span id="local-6989586621680145418"><span class="annot"><span class="annottext">[UniqueId]
</span><a href="#local-6989586621680145418"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621680145419"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145419"><span class="hs-identifier hs-var">kind</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145420"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145420"><span class="hs-identifier hs-var">origin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>            </span><span id="local-6989586621680145421"><span class="annot"><a href="#local-6989586621680145421"><span class="hs-identifier hs-var">kind'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; [UniqueId] -&gt; Eff r ElaraKind
forall (r :: [Effect]).
(UniqueGen :&gt; r) =&gt;
ElaraKind -&gt; [UniqueId] -&gt; Eff r ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#instantiate"><span class="hs-identifier hs-var">instantiate</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145419"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">[UniqueId]
</span><a href="#local-6989586621680145418"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-445"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#newEqualityConstraint"><span class="hs-identifier hs-type">newEqualityConstraint</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145417"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145421"><span class="hs-identifier hs-type">kind'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145420"><span class="hs-identifier hs-type">origin</span></a></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span>            </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-type">solveConstraints</span></a></span><span>
</span><span id="line-448"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span id="local-6989586621680145422"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145422"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145423"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145423"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-449"></span><span>            </span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind -&gt; Eff r ()
forall (r :: [Effect]).
KindInfer r =&gt;
UniqueId -&gt; ElaraKind -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#replaceInState"><span class="hs-identifier hs-var">replaceInState</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145422"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145423"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-450"></span><span>            </span><span class="annot"><span class="annottext">Eff r ()
forall (r :: [Effect]).
(State InferState :&gt; r, Error KindInferError :&gt; r, HasCallStack,
 UniqueGen :&gt; r, QueryEffects r, Rock Query :&gt; r) =&gt;
Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-var">solveConstraints</span></a></span><span>
</span><span id="line-451"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680145425"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145425"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span id="local-6989586621680145426"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145426"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-452"></span><span>            </span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind -&gt; Eff r ()
forall (r :: [Effect]).
KindInfer r =&gt;
UniqueId -&gt; ElaraKind -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#replaceInState"><span class="hs-identifier hs-var">replaceInState</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145426"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145425"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-453"></span><span>            </span><span class="annot"><span class="annottext">Eff r ()
forall (r :: [Effect]).
(State InferState :&gt; r, Error KindInferError :&gt; r, HasCallStack,
 UniqueGen :&gt; r, QueryEffects r, Rock Query :&gt; r) =&gt;
Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#solveConstraints"><span class="hs-identifier hs-var">solveConstraints</span></a></span><span>
</span><span id="line-454"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680145427"><span class="annot"><span class="annottext">k1 :: ElaraKind
</span><a href="#local-6989586621680145427"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">ElaraKind
</span><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-var">TypeKind</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145428"><span class="annot"><span class="annottext">k2 :: ElaraKind
</span><a href="#local-6989586621680145428"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.Data.Kind.html#FunctionKind"><span class="hs-identifier hs-type">FunctionKind</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145429"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145429"><span class="hs-identifier hs-var">origin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KindInferError -&gt; Eff r ()
forall e (es :: [Effect]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; KindInferError
</span><a href="Elara.Data.Kind.Infer.html#CannotUnify"><span class="hs-identifier hs-var">CannotUnify</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145427"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145428"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145429"><span class="hs-identifier hs-var">origin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680145430"><span class="annot"><span class="annottext">k1 :: ElaraKind
</span><a href="#local-6989586621680145430"><span class="hs-identifier hs-var">k1</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.Data.Kind.html#FunctionKind"><span class="hs-identifier hs-type">FunctionKind</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145431"><span class="annot"><span class="annottext">k2 :: ElaraKind
</span><a href="#local-6989586621680145431"><span class="hs-identifier hs-var">k2</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="annottext">ElaraKind
</span><a href="Elara.Data.Kind.html#TypeKind"><span class="hs-identifier hs-var">TypeKind</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680145432"><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145432"><span class="hs-identifier hs-var">origin</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">KindInferError -&gt; Eff r ()
forall e (es :: [Effect]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ElaraKind -&gt; ElaraKind -&gt; ConstraintOrigin -&gt; KindInferError
</span><a href="Elara.Data.Kind.Infer.html#CannotUnify"><span class="hs-identifier hs-var">CannotUnify</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145430"><span class="hs-identifier hs-var">k1</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145431"><span class="hs-identifier hs-var">k2</span></a></span><span> </span><span class="annot"><span class="annottext">ConstraintOrigin
</span><a href="#local-6989586621680145432"><span class="hs-identifier hs-var">origin</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span id="local-6989586621680143515"><span class="annot"><a href="Elara.Data.Kind.Infer.html#instantiate"><span class="hs-identifier hs-type">instantiate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143515"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143515"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span></span><span>
</span><span id="line-458"></span><span id="instantiate"><span class="annot"><span class="annottext">instantiate :: forall (r :: [Effect]).
(UniqueGen :&gt; r) =&gt;
ElaraKind -&gt; [UniqueId] -&gt; Eff r ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#instantiate"><span class="hs-identifier hs-var hs-var">instantiate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ElaraKind -&gt; UniqueId -&gt; Eff r ElaraKind)
-&gt; ElaraKind -&gt; [UniqueId] -&gt; Eff r ElaraKind
forall (t :: * -&gt; *) (m :: * -&gt; *) b a.
(Foldable t, Monad m) =&gt;
(b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b
</span><span class="hs-identifier hs-var">foldM</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; UniqueId -&gt; Eff r ElaraKind
forall (r :: [Effect]).
(UniqueGen :&gt; r) =&gt;
ElaraKind -&gt; UniqueId -&gt; Eff r ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#replaceKindVarWithFreshKindVar"><span class="hs-identifier hs-var">replaceKindVarWithFreshKindVar</span></a></span><span>
</span><span id="line-459"></span><span>
</span><span id="line-460"></span><span id="local-6989586621680143522"><span class="annot"><a href="Elara.Data.Kind.Infer.html#replaceKindVarWithFreshKindVar"><span class="hs-identifier hs-type">replaceKindVarWithFreshKindVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680143522"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143522"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span></span><span>
</span><span id="line-461"></span><span id="replaceKindVarWithFreshKindVar"><span class="annot"><span class="annottext">replaceKindVarWithFreshKindVar :: forall (r :: [Effect]).
(UniqueGen :&gt; r) =&gt;
ElaraKind -&gt; UniqueId -&gt; Eff r ElaraKind
</span><a href="Elara.Data.Kind.Infer.html#replaceKindVarWithFreshKindVar"><span class="hs-identifier hs-var hs-var">replaceKindVarWithFreshKindVar</span></a></span></span><span> </span><span id="local-6989586621680145506"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145506"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621680145507"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145507"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-462"></span><span>    </span><span id="local-6989586621680145508"><span class="annot"><a href="#local-6989586621680145508"><span class="hs-identifier hs-var">kindvar</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r UniqueId
forall (r :: [Effect]). (UniqueGen :&gt; r) =&gt; Eff r UniqueId
</span><a href="Elara.Data.Unique.Effect.html#makeUniqueId"><span class="hs-identifier hs-var">makeUniqueId</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-465"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">transformOf</span></span><span>
</span><span id="line-466"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">gplate</span></span><span>
</span><span id="line-467"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-468"></span><span>                </span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span id="local-6989586621680145511"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145511"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145511"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; UniqueId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145507"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind
</span><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-var">VarKind</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145508"><span class="hs-identifier hs-var">kindvar</span></a></span><span>
</span><span id="line-469"></span><span>                </span><span id="local-6989586621680145512"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145512"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145512"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-470"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>            </span><span class="annot"><a href="#local-6989586621680145506"><span class="hs-identifier hs-type">kind</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span id="local-6989586621680143516"><span class="annot"><a href="Elara.Data.Kind.Infer.html#replaceInState"><span class="hs-identifier hs-type">replaceInState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680143516"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680143516"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-474"></span><span id="replaceInState"><span class="annot"><span class="annottext">replaceInState :: forall (r :: [Effect]).
KindInfer r =&gt;
UniqueId -&gt; ElaraKind -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#replaceInState"><span class="hs-identifier hs-var hs-var">replaceInState</span></a></span></span><span> </span><span id="local-6989586621680145985"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145985"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621680145986"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145986"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind -&gt; Eff r ()
forall (r :: [Effect]).
KindInfer r =&gt;
UniqueId -&gt; ElaraKind -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#occursCheck"><span class="hs-identifier hs-var">occursCheck</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145985"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145986"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621680145988"><span class="annot"><a href="#local-6989586621680145988"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s (es :: [Effect]).
(HasCallStack, State s :&gt; es) =&gt;
Eff es s
</span><span class="hs-identifier hs-var">get</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.Data.Kind.Infer.html#InferState"><span class="hs-identifier hs-type">InferState</span></a></span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680145989"><span class="annot"><a href="#local-6989586621680145989"><span class="hs-identifier hs-var hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-479"></span><span>            </span><span class="annot"><span class="annottext">Optic A_Traversal NoIx InferState InferState ElaraKind ElaraKind
-&gt; (ElaraKind -&gt; ElaraKind) -&gt; InferState -&gt; InferState
forall k (is :: IxList) s a1 a2 b.
Is k A_Traversal =&gt;
Optic k is s a1 a2 b -&gt; (a2 -&gt; b) -&gt; s -&gt; a1
</span><a href="Prelude.html#transformOf%27"><span class="hs-identifier hs-var">transformOf'</span></a></span><span>
</span><span id="line-480"></span><span>                </span><span class="annot"><span class="annottext">Optic A_Traversal NoIx InferState InferState ElaraKind ElaraKind
forall a s. GPlate a s =&gt; Traversal' s a
</span><span class="hs-identifier hs-var">gplate</span></span><span>
</span><span id="line-481"></span><span>                </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-482"></span><span>                    </span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span id="local-6989586621680145991"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145991"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145991"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; UniqueId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680145985"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145986"><span class="hs-identifier hs-var">kind</span></a></span><span>
</span><span id="line-483"></span><span>                    </span><span id="local-6989586621680145992"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145992"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680145992"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-484"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>                </span><span class="annot"><span class="annottext">InferState
</span><a href="#local-6989586621680145988"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680145989"><span class="hs-identifier hs-type">s'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;</span></span><span> </span><span class="annot"><span class="">#substitution</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.insert</span></span><span> </span><span class="annot"><a href="#local-6989586621680145985"><span class="hs-identifier hs-type">var</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145986"><span class="hs-identifier hs-type">kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>
</span><span id="line-489"></span><span id="local-6989586621680145996"><span class="annot"><a href="Elara.Data.Kind.Infer.html#occursCheck"><span class="hs-identifier hs-type">occursCheck</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Kind.Infer.html#KindInfer"><span class="hs-identifier hs-type">KindInfer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680145996"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#KindVar"><span class="hs-identifier hs-type">KindVar</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#ElaraKind"><span class="hs-identifier hs-type">ElaraKind</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680145996"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-490"></span><span id="occursCheck"><span class="annot"><span class="annottext">occursCheck :: forall (r :: [Effect]).
KindInfer r =&gt;
UniqueId -&gt; ElaraKind -&gt; Eff r ()
</span><a href="Elara.Data.Kind.Infer.html#occursCheck"><span class="hs-identifier hs-var hs-var">occursCheck</span></a></span></span><span> </span><span id="local-6989586621680146066"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680146066"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621680146067"><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680146067"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind
</span><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-var">VarKind</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680146066"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind -&gt; ElaraKind -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680146067"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">[()] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="Elara.Data.Kind.html#VarKind"><span class="hs-identifier hs-type">VarKind</span></a></span><span> </span><span id="local-6989586621680146070"><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680146070"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Optic A_Traversal NoIx ElaraKind ElaraKind ElaraKind ElaraKind
-&gt; ElaraKind -&gt; [ElaraKind]
forall k (is :: IxList) a.
Is k A_Fold =&gt;
Optic' k is a a -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">universeOf</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Traversal NoIx ElaraKind ElaraKind ElaraKind ElaraKind
forall a s. GPlate a s =&gt; Traversal' s a
</span><span class="hs-identifier hs-var">gplate</span></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680146067"><span class="hs-identifier hs-var">kind</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680146066"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId -&gt; UniqueId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680146070"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-492"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Eff r ()
forall (f :: * -&gt; *). Applicative f =&gt; f ()
</span><span class="hs-identifier hs-var">pass</span></span><span>
</span><span id="line-493"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-494"></span><span>            </span><span class="hs-comment">-- We try to find the type of the kind variable by doing reverse lookup,</span><span>
</span><span id="line-495"></span><span>            </span><span class="hs-comment">-- but this might not succeed before the kind variable might be generated</span><span>
</span><span id="line-496"></span><span>            </span><span class="hs-comment">-- during constraint solving.</span><span>
</span><span id="line-497"></span><span>            </span><span class="hs-comment">-- We might be able to find the type if we look at the substitution as well,</span><span>
</span><span id="line-498"></span><span>            </span><span class="hs-comment">-- but for now lets leave it at this &quot;best effort&quot; attempt.</span><span>
</span><span id="line-499"></span><span>            </span><span class="hs-comment">-- reverseEnv :: [(KindVar, Either (Qualified TypeName) TypeVar)] &lt;- map swap . toList . (view #env) &lt;$&gt; get</span><span>
</span><span id="line-500"></span><span>            </span><span class="hs-comment">-- let typ = lookup var reverseEnv</span><span>
</span><span id="line-501"></span><span>            </span><span class="annot"><span class="annottext">KindInferError -&gt; Eff r ()
forall e (es :: [Effect]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UniqueId -&gt; ElaraKind -&gt; KindInferError
</span><a href="Elara.Data.Kind.Infer.html#OccursCheckFailed"><span class="hs-identifier hs-var">OccursCheckFailed</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueId
</span><a href="#local-6989586621680146066"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">ElaraKind
</span><a href="#local-6989586621680146067"><span class="hs-identifier hs-var">kind</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-502"></span></pre></body></html>