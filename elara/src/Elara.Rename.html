<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE StrictData #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{- | Renaming stage of compilation
This stage handles:
1. Renaming all variables, types, and type variables, adding module qualification or unique suffixes to avoid name clashes
2. Desugaring any &quot;first-class&quot; pattern matches into normal match expressions (eg '\[] -&gt; 1' to '\x -&gt; match x with [] -&gt; 1')
3. Desugaring blocks into let-in chains (and monad operations soon), eg 'let y = 1; y + 1' to 'let y = 1 in y + 1'
   Note that until the monad operations are implemented, we can't fully remove blocks, as we have nothing to translate 'f x; g x' into
-}</span></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Elara.Rename.html"><span class="hs-identifier">Elara.Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#getRenamedModule"><span class="hs-identifier">getRenamedModule</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier">renameExpr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier">InnerRename</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics.Product</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">list</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics.Wrapped</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Eff</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">inject</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(:&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.Error.Static</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.Error.Static</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Eff</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.Reader.Static</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Eff</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Effectful.State.Extra.html"><span class="hs-identifier">Effectful.State.Extra</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Effectful.State.Static.Local</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Eff</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html"><span class="hs-identifier">Elara.AST.Desugared</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Generic.html"><span class="hs-identifier">Elara.AST.Generic</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#moduleName"><span class="hs-identifier">moduleName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Common.html"><span class="hs-identifier">Elara.AST.Generic.Common</span></a></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Module.html"><span class="hs-identifier">Elara.AST.Module</span></a></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Name.html"><span class="hs-identifier">Elara.AST.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier">LowerAlphaName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier">MaybeQualified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier">MaybeQualified</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier">ModuleName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier">NTypeName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#NVarName"><span class="hs-identifier">NVarName</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier">Qualified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier">Qualified</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ToName"><span class="hs-identifier">ToName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#toName"><span class="hs-identifier">toName</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier">TypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier">VarName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier">NormalVarName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#OperatorVarName"><span class="hs-identifier">OperatorVarName</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarOrConName"><span class="hs-identifier">VarOrConName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Region.html"><span class="hs-identifier">Elara.AST.Region</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier">Located</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#SourceRegion"><span class="hs-identifier">SourceRegion</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#enclosingRegion%27"><span class="hs-identifier">enclosingRegion'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier">sourceRegion</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#spanningRegion%27"><span class="hs-identifier">spanningRegion'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier">unlocated</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-identifier">withLocationOf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html"><span class="hs-identifier">Elara.AST.Renamed</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Select.html"><span class="hs-identifier">Elara.AST.Select</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Select.html#LocatedAST"><span class="hs-identifier">LocatedAST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier">Desugared</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier">Renamed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html"><span class="hs-identifier">Elara.AST.VarRef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#VarRef"><span class="hs-identifier">VarRef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#VarRef%27"><span class="hs-identifier">VarRef'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Global"><span class="hs-identifier">Global</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier">Local</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.AtLeast2List.html"><span class="hs-identifier">Elara.Data.AtLeast2List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.AtLeast2List.html#AtLeast2List"><span class="hs-identifier">AtLeast2List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.AtLeast2List.html#AtLeast2List"><span class="hs-identifier">AtLeast2List</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Pretty.html"><span class="hs-identifier">Elara.Data.Pretty</span></a></span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Unique.html"><span class="hs-identifier">Elara.Data.Unique</span></a></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html"><span class="hs-identifier">Elara.Data.Unique.Effect</span></a></span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Desugar.Error.html"><span class="hs-identifier">Elara.Desugar.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Desugar.Error.html#DesugarError"><span class="hs-identifier">DesugarError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Error.html"><span class="hs-identifier">Elara.Error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Error.html#runErrorOrReport"><span class="hs-identifier">runErrorOrReport</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Logging.html"><span class="hs-identifier">Elara.Logging</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Logging.html#StructuredDebug"><span class="hs-identifier">StructuredDebug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Logging.html#logDebug"><span class="hs-identifier">logDebug</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Prim.html"><span class="hs-identifier">Elara.Prim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Prim.html#mkPrimQual"><span class="hs-identifier">mkPrimQual</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Prim.html#unitName"><span class="hs-identifier">unitName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Prim.Core.html"><span class="hs-identifier">Elara.Prim.Core</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Prim.Core.html#consCtorName"><span class="hs-identifier">consCtorName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Prim.Core.html#emptyListCtorName"><span class="hs-identifier">emptyListCtorName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Prim.Core.html#tuple2CtorName"><span class="hs-identifier">tuple2CtorName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Prim.Rename.html"><span class="hs-identifier">Elara.Prim.Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Prim.Rename.html#primitiveRenameState"><span class="hs-identifier">primitiveRenameState</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.html"><span class="hs-identifier">Elara.Query</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier">QueryModuleByName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier">SupportsQuery</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.html"><span class="hs-identifier">Elara.Query</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html"><span class="hs-identifier">Elara.Query.Effects</span></a></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Query.Errors.html"><span class="hs-identifier">Elara.Query.Errors</span></a></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Rename.Error.html"><span class="hs-identifier">Elara.Rename.Error</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Rename.Imports.html"><span class="hs-identifier">Elara.Rename.Imports</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.Imports.html#isImportedBy"><span class="hs-identifier">isImportedBy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.Rename.State.html"><span class="hs-identifier">Elara.Rename.State</span></a></span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">anyOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">filteredBy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">traverseOf_</span></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Print.html"><span class="hs-identifier">Print</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Print.html#showColored"><span class="hs-identifier">showColored</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Print.html#showPretty"><span class="hs-identifier">showPretty</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Rock.html"><span class="hs-identifier">Rock</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">type</span><span> </span><span id="Rename"><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-var">Rename</span></a></span></span><span> </span><span id="local-6989586621680213253"><span class="annot"><a href="#local-6989586621680213253"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-54"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.State</span></span><span> </span><span class="annot"><a href="Elara.Rename.State.html#RenameState"><span class="hs-identifier hs-type">RenameState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213253"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Error</span></span><span> </span><span class="annot"><a href="Elara.Rename.Error.html#RenameError"><span class="hs-identifier hs-type">RenameError</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213253"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213253"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html#QueryEffects"><span class="hs-identifier hs-type">QueryEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213253"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Logging.html#StructuredDebug"><span class="hs-identifier hs-type">StructuredDebug</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213253"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213253"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">type</span><span> </span><span id="InnerRename"><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-var">InnerRename</span></a></span></span><span> </span><span id="local-6989586621680213254"><span class="annot"><a href="#local-6989586621680213254"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.State</span></span><span> </span><span class="annot"><a href="Elara.Rename.State.html#RenameState"><span class="hs-identifier hs-type">RenameState</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213254"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Error</span></span><span> </span><span class="annot"><a href="Elara.Rename.Error.html#RenameError"><span class="hs-identifier hs-type">RenameError</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213254"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213254"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Query.Effects.html#QueryEffects"><span class="hs-identifier hs-type">QueryEffects</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213254"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.Logging.html#StructuredDebug"><span class="hs-identifier hs-type">StructuredDebug</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213254"><span class="hs-identifier hs-type">r</span></a></span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213254"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-comment">-- the module we're renaming</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HasCallStack</span></span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Elara.Query.html#SupportsQuery"><span class="hs-identifier hs-type">SupportsQuery</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-type">QueryModuleByName</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-keyword">type</span><span> </span><span id="QuerySpecificEffectsOf"><span class="annot"><a href="Elara.Query.html#QuerySpecificEffectsOf"><span class="hs-identifier hs-var">QuerySpecificEffectsOf</span></a></span></span><span> </span><span class="annot"><a href="Elara.Query.html#QueryModuleByName"><span class="hs-identifier hs-type">QueryModuleByName</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Elara.Query.Errors.html#StandardQueryError"><span class="hs-identifier hs-type">StandardQueryError</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span id="local-6989586621680213356"><span class="annot"><span class="annottext">query :: HasCallStack =&gt;
QueryArgsOf QueryModuleByName Renamed
-&gt; Eff
     (QueryEffectsOf QueryModuleByName Renamed)
     (QueryReturnTypeOf QueryModuleByName Renamed)
</span><a href="#local-6989586621680213356"><span class="hs-identifier hs-var hs-var hs-var">query</span></a></span></span><span> </span><span id="local-6989586621680213358"><span class="annot"><span class="annottext">QueryArgsOf QueryModuleByName Renamed
</span><a href="#local-6989586621680213358"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenameState
-&gt; Eff
     (State RenameState : QueryEffectsOf QueryModuleByName Renamed)
     (QueryReturnTypeOf QueryModuleByName Renamed)
-&gt; Eff
     (QueryEffectsOf QueryModuleByName Renamed)
     (QueryReturnTypeOf QueryModuleByName Renamed)
forall s (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
HasCallStack =&gt;
s -&gt; Eff (State s : es) a -&gt; Eff es a
</span><span class="hs-identifier hs-var">Eff.evalState</span></span><span> </span><span class="annot"><span class="annottext">RenameState
</span><a href="Elara.Prim.Rename.html#primitiveRenameState"><span class="hs-identifier hs-var">primitiveRenameState</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   (State RenameState : QueryEffectsOf QueryModuleByName Renamed)
   (QueryReturnTypeOf QueryModuleByName Renamed)
 -&gt; Eff
      (QueryEffectsOf QueryModuleByName Renamed)
      (QueryReturnTypeOf QueryModuleByName Renamed))
-&gt; Eff
     (State RenameState : QueryEffectsOf QueryModuleByName Renamed)
     (QueryReturnTypeOf QueryModuleByName Renamed)
-&gt; Eff
     (QueryEffectsOf QueryModuleByName Renamed)
     (QueryReturnTypeOf QueryModuleByName Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Eff
  (ConsQueryEffects
     '[Error RenameError, State RenameState, Rock Query])
  (Module Renamed)
-&gt; Eff
     (State RenameState : QueryEffectsOf QueryModuleByName Renamed)
     (Module Renamed)
forall (subEs :: [(* -&gt; *) -&gt; * -&gt; *]) (es :: [(* -&gt; *) -&gt; * -&gt; *])
       a.
Subset subEs es =&gt;
Eff subEs a -&gt; Eff es a
</span><span class="hs-identifier hs-var">inject</span></span><span> </span><span class="annot"><span class="annottext">(Eff
   (ConsQueryEffects
      '[Error RenameError, State RenameState, Rock Query])
   (Module Renamed)
 -&gt; Eff
      (State RenameState : QueryEffectsOf QueryModuleByName Renamed)
      (Module Renamed))
-&gt; Eff
     (ConsQueryEffects
        '[Error RenameError, State RenameState, Rock Query])
     (Module Renamed)
-&gt; Eff
     (State RenameState : QueryEffectsOf QueryModuleByName Renamed)
     (Module Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
-&gt; Eff
     (ConsQueryEffects
        '[Error RenameError, State RenameState, Rock Query])
     (Module Renamed)
</span><a href="Elara.Rename.html#getRenamedModule"><span class="hs-identifier hs-var">getRenamedModule</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
QueryArgsOf QueryModuleByName Renamed
</span><a href="#local-6989586621680213358"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="annot"><span class="hs-comment">-- | Run the @'Elara.Query.QueryModuleByName' 'Renamed'@ query, renaming a module by its name</span></span><span>
</span><span id="line-78"></span><span class="annot"><a href="Elara.Rename.html#getRenamedModule"><span class="hs-identifier hs-type">getRenamedModule</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span>
</span><span id="line-81"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Query.Effects.html#ConsQueryEffects"><span class="hs-identifier hs-type">ConsQueryEffects</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Eff.Error</span></span><span> </span><span class="annot"><a href="Elara.Rename.Error.html#RenameError"><span class="hs-identifier hs-type">RenameError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.State</span></span><span> </span><span class="annot"><a href="Elara.Rename.State.html#RenameState"><span class="hs-identifier hs-type">RenameState</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span id="getRenamedModule"><span class="annot"><span class="annottext">getRenamedModule :: ModuleName
-&gt; Eff
     (ConsQueryEffects
        '[Error RenameError, State RenameState, Rock Query])
     (Module Renamed)
</span><a href="Elara.Rename.html#getRenamedModule"><span class="hs-identifier hs-var hs-var">getRenamedModule</span></a></span></span><span> </span><span id="local-6989586621680213558"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213558"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621680213559"><span class="annot"><a href="#local-6989586621680213559"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall e (r :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(DiagnosticWriter (Doc AnsiStyle) :&gt; r,
 Error SomeReportableError :&gt; r, ReportableError e) =&gt;
Eff (Error e : r) a -&gt; Eff r a
</span><a href="Elara.Error.html#runErrorOrReport"><span class="hs-identifier hs-var">runErrorOrReport</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.Desugar.Error.html#DesugarError"><span class="hs-identifier hs-type">DesugarError</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff
   (Error DesugarError
      : ConsQueryEffects
          '[Error RenameError, State RenameState, Rock Query])
   (Module Desugared)
 -&gt; Eff
      (ConsQueryEffects
         '[Error RenameError, State RenameState, Rock Query])
      (Module Desugared))
-&gt; Eff
     (Error DesugarError
        : ConsQueryEffects
            '[Error RenameError, State RenameState, Rock Query])
     (Module Desugared)
-&gt; Eff
     (ConsQueryEffects
        '[Error RenameError, State RenameState, Rock Query])
     (Module Desugared)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Query
  (Rock Query : ConsQueryEffects '[Error DesugarError])
  (Module Desugared)
-&gt; Eff
     (Error DesugarError
        : ConsQueryEffects
            '[Error RenameError, State RenameState, Rock Query])
     (Module Desugared)
forall (xs :: [(* -&gt; *) -&gt; * -&gt; *]) (es :: [(* -&gt; *) -&gt; * -&gt; *])
       (f :: [(* -&gt; *) -&gt; * -&gt; *] -&gt; * -&gt; *) a.
(Subset xs es, Rock f :&gt; es, HasCallStack,
 StructuredDebug :&gt; xs) =&gt;
f xs a -&gt; Eff es a
</span><a href="Rock.html#fetch"><span class="hs-identifier hs-var">Rock.fetch</span></a></span><span> </span><span class="annot"><span class="annottext">(Query
   (Rock Query : ConsQueryEffects '[Error DesugarError])
   (Module Desugared)
 -&gt; Eff
      (Error DesugarError
         : ConsQueryEffects
             '[Error RenameError, State RenameState, Rock Query])
      (Module Desugared))
-&gt; Query
     (Rock Query : ConsQueryEffects '[Error DesugarError])
     (Module Desugared)
-&gt; Eff
     (Error DesugarError
        : ConsQueryEffects
            '[Error RenameError, State RenameState, Rock Query])
     (Module Desugared)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
-&gt; Query
     (Rock Query : ConsQueryEffects '[Error DesugarError])
     (Module Desugared)
</span><a href="Elara.Query.html#DesugaredModule"><span class="hs-identifier hs-var">Elara.Query.DesugaredModule</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213558"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680213562"><span class="annot"><a href="#local-6989586621680213562"><span class="hs-identifier hs-var hs-var">actualName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680213559"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module' Desugared)
     (Module' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680213562"><span class="hs-identifier hs-type">actualName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="#local-6989586621680213558"><span class="hs-identifier hs-type">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">throwError</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.Rename.Error.html#ModuleNameMismatch"><span class="hs-identifier hs-type">ModuleNameMismatch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#GeneratedRegion"><span class="hs-identifier hs-type">GeneratedRegion</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;Renaming Entry Point&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680213558"><span class="hs-identifier hs-type">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680213562"><span class="hs-identifier hs-type">actualName</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-type">`withLocationOf`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680213559"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="annot"><a href="Elara.Rename.html#rename"><span class="hs-identifier hs-type">rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213559"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span id="local-6989586621680212658"><span id="local-6989586621680212659"><span class="annot"><a href="Elara.Rename.html#qualifyIn"><span class="hs-identifier hs-type">qualifyIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212658"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212659"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212658"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212659"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-90"></span><span id="qualifyIn"><span class="annot"><span class="annottext">qualifyIn :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
Rename r =&gt;
ModuleName -&gt; MaybeQualified name -&gt; Eff r (Qualified name)
</span><a href="Elara.Rename.html#qualifyIn"><span class="hs-identifier hs-var hs-var">qualifyIn</span></a></span></span><span> </span><span id="local-6989586621680213585"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213585"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span id="local-6989586621680213586"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213586"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680213587"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213587"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><span class="annottext">Bool -&gt; Eff r () -&gt; Eff r ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213587"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ModuleName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213585"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff r () -&gt; Eff r ()) -&gt; Eff r () -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r ()
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r ()) -&gt; RenameError -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ModuleName -&gt; RenameError
</span><a href="Elara.Rename.Error.html#QualifiedInWrongModule"><span class="hs-identifier hs-var">QualifiedInWrongModule</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213587"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213585"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">Qualified name -&gt; Eff r (Qualified name)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Qualified name -&gt; Eff r (Qualified name))
-&gt; Qualified name -&gt; Eff r (Qualified name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">name -&gt; ModuleName -&gt; Qualified name
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-var">Qualified</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213586"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213587"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-93"></span><span class="annot"><a href="Elara.Rename.html#qualifyIn"><span class="hs-identifier hs-var">qualifyIn</span></a></span><span> </span><span id="local-6989586621680213589"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213589"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span id="local-6989586621680213590"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213590"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Qualified name -&gt; Eff r (Qualified name)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Qualified name -&gt; Eff r (Qualified name))
-&gt; Qualified name -&gt; Eff r (Qualified name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">name -&gt; ModuleName -&gt; Qualified name
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-var">Qualified</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213590"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213589"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span id="local-6989586621680212667"><span class="annot"><a href="Elara.Rename.html#qualifyTypeName"><span class="hs-identifier hs-type">qualifyTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212667"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680212667"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212667"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-96"></span><span id="qualifyTypeName"><span class="annot"><span class="annottext">qualifyTypeName :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#qualifyTypeName"><span class="hs-identifier hs-var hs-var">qualifyTypeName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680213663"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213663"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span id="local-6989586621680213664"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680213664"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680213665"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213665"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><span class="annottext">Located ModuleName -&gt; Located Name -&gt; Eff r ()
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(Rock Query :&gt; r, Reader (Maybe (Module Desugared)) :&gt; r,
 State RenameState :&gt; r, Error RenameError :&gt; r,
 Error SomeReportableError :&gt; r,
 DiagnosticWriter (Doc AnsiStyle) :&gt; r, UniqueGen :&gt; r,
 FileSystem :&gt; r, Concurrent :&gt; r, StructuredDebug :&gt; r) =&gt;
Located ModuleName -&gt; Located Name -&gt; Eff r ()
</span><a href="Elara.Rename.html#ensureExistsAndExposed"><span class="hs-identifier hs-var">ensureExistsAndExposed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; ModuleName -&gt; Located ModuleName
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213663"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213665"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Name -&gt; Located Name
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213663"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; Name
</span><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-var">NTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680213664"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Located (Qualified TypeName)
 -&gt; Eff r (Located (Qualified TypeName)))
-&gt; Located (Qualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213663"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; ModuleName -&gt; Qualified TypeName
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-var">Qualified</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680213664"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213665"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Elara.Rename.html#qualifyTypeName"><span class="hs-identifier hs-var">qualifyTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680213667"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213667"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span id="local-6989586621680213668"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680213668"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621680213669"><span class="annot"><a href="#local-6989586621680213669"><span class="hs-identifier hs-var">typeNames'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens '[] RenameState (Map TypeName (NonEmpty (VarRef TypeName)))
-&gt; Eff r (Map TypeName (NonEmpty (VarRef TypeName)))
forall k a (r :: [(* -&gt; *) -&gt; * -&gt; *]) (is :: IxList) b.
(Is k A_Getter, State a :&gt; r) =&gt;
Optic' k is a b -&gt; Eff r b
</span><a href="Effectful.State.Extra.html#use%27"><span class="hs-identifier hs-var">use'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;typeNames&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span id="local-6989586621680213671"><span class="annot"><a href="#local-6989586621680213671"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.ask</span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.lookup</span></span><span> </span><span class="annot"><a href="#local-6989586621680213668"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213669"><span class="hs-identifier hs-type">typeNames'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">Maybe (NonEmpty (VarRef TypeName))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r (Located (Qualified TypeName))
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r (Located (Qualified TypeName)))
-&gt; RenameError -&gt; Eff r (Located (Qualified TypeName))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Located Name
-&gt; Maybe (Module Desugared)
-&gt; Map TypeName (NonEmpty (VarRef TypeName))
-&gt; RenameError
forall name.
(ToName name, Show name) =&gt;
Located Name
-&gt; Maybe (Module Desugared)
-&gt; Map name (NonEmpty (VarRef name))
-&gt; RenameError
</span><a href="Elara.Rename.Error.html#UnknownName"><span class="hs-identifier hs-var">UnknownName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Name -&gt; Located Name
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213667"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; Name
</span><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-var">NTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680213668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Module Desugared)
</span><a href="#local-6989586621680213671"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map TypeName (NonEmpty (VarRef TypeName))
</span><a href="#local-6989586621680213669"><span class="hs-identifier hs-var">typeNames'</span></a></span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Global"><span class="hs-identifier hs-type">Global</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680213675"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213675"><span class="hs-identifier hs-var">sr'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span id="local-6989586621680213676"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680213676"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621680213677"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213677"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Located (Qualified TypeName)
 -&gt; Eff r (Located (Qualified TypeName)))
-&gt; Located (Qualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213675"><span class="hs-identifier hs-var">sr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; ModuleName -&gt; Qualified TypeName
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-var">Qualified</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680213676"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213677"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span class="annot"><span class="annottext">VarRefImpl LocatedVarRefKind (Unique TypeName)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Eff r (Located (Qualified TypeName))
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;can't have local type names&quot;</span></span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680213680"><span class="annot"><span class="annottext">NonEmpty (VarRef TypeName)
</span><a href="#local-6989586621680213680"><span class="hs-identifier hs-var">many</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r (Located (Qualified TypeName))
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r (Located (Qualified TypeName)))
-&gt; RenameError -&gt; Eff r (Located (Qualified TypeName))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Located Name -&gt; NonEmpty (VarRef TypeName) -&gt; RenameError
</span><a href="Elara.Rename.Error.html#AmbiguousTypeName"><span class="hs-identifier hs-var">AmbiguousTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Name -&gt; Located Name
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213667"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; Name
</span><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-var">NTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680213668"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (VarRef TypeName)
</span><a href="#local-6989586621680213680"><span class="hs-identifier hs-var">many</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span id="local-6989586621680212705"><span class="annot"><a href="Elara.Rename.html#askCurrentModule"><span class="hs-identifier hs-type">askCurrentModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212705"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212705"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-109"></span><span id="askCurrentModule"><span class="annot"><span class="annottext">askCurrentModule :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
InnerRename r =&gt;
Eff r (Module Desugared)
</span><a href="Elara.Rename.html#askCurrentModule"><span class="hs-identifier hs-var hs-var">askCurrentModule</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-110"></span><span>    </span><span id="local-6989586621680213696"><span class="annot"><a href="#local-6989586621680213696"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r (Maybe (Module Desugared))
forall r (es :: [(* -&gt; *) -&gt; * -&gt; *]).
(HasCallStack, Reader r :&gt; es) =&gt;
Eff es r
</span><span class="hs-identifier hs-var">Eff.ask</span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621680213696"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-112"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Module Desugared)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r (Module Desugared)
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">RenameError
</span><a href="Elara.Rename.Error.html#UnknownCurrentModule"><span class="hs-identifier hs-var">UnknownCurrentModule</span></a></span><span>
</span><span id="line-113"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680213698"><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680213698"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Module Desugared -&gt; Eff r (Module Desugared)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680213698"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span id="local-6989586621680213699"><span id="local-6989586621680213700"><span class="annot"><a href="Elara.Rename.html#lookupGenericName"><span class="hs-identifier hs-type">lookupGenericName</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213699"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621680213700"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ToName"><span class="hs-identifier hs-type">ToName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213700"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621680213700"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-118"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Elara.Rename.State.html#RenameState"><span class="hs-identifier hs-type">RenameState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="#local-6989586621680213700"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#VarRef"><span class="hs-identifier hs-type">VarRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213700"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#VarRef"><span class="hs-identifier hs-type">VarRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213700"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.Rename.Error.html#RenameError"><span class="hs-identifier hs-type">RenameError</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213700"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213699"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#VarRef"><span class="hs-identifier hs-type">VarRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213700"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-122"></span><span id="lookupGenericName"><span class="annot"><span class="annottext">lookupGenericName :: Lens' RenameState (Map name (NonEmpty (VarRef name)))
-&gt; (Located Name -&gt; NonEmpty (VarRef name) -&gt; RenameError)
-&gt; Located (MaybeQualified name)
-&gt; Eff r (Located (VarRef name))
</span><a href="Elara.Rename.html#lookupGenericName"><span class="hs-identifier hs-var hs-var">lookupGenericName</span></a></span></span><span> </span><span class="annot"><span class="annottext">Lens' RenameState (Map name (NonEmpty (VarRef name)))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Located Name -&gt; NonEmpty (VarRef name) -&gt; RenameError
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680213776"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213776"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span id="local-6989586621680213777"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213777"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680213778"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213778"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">Located ModuleName -&gt; Located Name -&gt; Eff r ()
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(Rock Query :&gt; r, Reader (Maybe (Module Desugared)) :&gt; r,
 State RenameState :&gt; r, Error RenameError :&gt; r,
 Error SomeReportableError :&gt; r,
 DiagnosticWriter (Doc AnsiStyle) :&gt; r, UniqueGen :&gt; r,
 FileSystem :&gt; r, Concurrent :&gt; r, StructuredDebug :&gt; r) =&gt;
Located ModuleName -&gt; Located Name -&gt; Eff r ()
</span><a href="Elara.Rename.html#ensureExistsAndExposed"><span class="hs-identifier hs-var">ensureExistsAndExposed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; ModuleName -&gt; Located ModuleName
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213776"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213778"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Name -&gt; Located Name
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213776"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">name -&gt; Name
forall name. ToName name =&gt; name -&gt; Name
</span><a href="Elara.AST.Name.html#toName"><span class="hs-identifier hs-var">toName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213777"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">Located (VarRef name) -&gt; Eff r (Located (VarRef name))
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Located (VarRef name) -&gt; Eff r (Located (VarRef name)))
-&gt; Located (VarRef name) -&gt; Eff r (Located (VarRef name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourceRegion -&gt; VarRef name -&gt; Located (VarRef name)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213776"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">(VarRef name -&gt; Located (VarRef name))
-&gt; VarRef name -&gt; Located (VarRef name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarRefImpl LocatedVarRefKind (Qualified name) -&gt; VarRef name
forall (c :: VarRefKind) n.
VarRefImpl c (Qualified n) -&gt; VarRef' c n
</span><a href="Elara.AST.VarRef.html#Global"><span class="hs-identifier hs-var">Global</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified name -&gt; Located (Qualified name)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213776"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">name -&gt; ModuleName -&gt; Qualified name
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-var">Qualified</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213777"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680213778"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span class="annot"><a href="Elara.Rename.html#lookupGenericName"><span class="hs-identifier hs-var">lookupGenericName</span></a></span><span> </span><span id="local-6989586621680213779"><span class="annot"><span class="annottext">Lens' RenameState (Map name (NonEmpty (VarRef name)))
</span><a href="#local-6989586621680213779"><span class="hs-identifier hs-var">lens</span></a></span></span><span> </span><span id="local-6989586621680213780"><span class="annot"><span class="annottext">Located Name -&gt; NonEmpty (VarRef name) -&gt; RenameError
</span><a href="#local-6989586621680213780"><span class="hs-identifier hs-var">ambiguousError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680213781"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213781"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span id="local-6989586621680213782"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213782"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621680213783"><span class="annot"><a href="#local-6989586621680213783"><span class="hs-identifier hs-var">names'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Lens' RenameState (Map name (NonEmpty (VarRef name)))
-&gt; Eff r (Map name (NonEmpty (VarRef name)))
forall k a (r :: [(* -&gt; *) -&gt; * -&gt; *]) (is :: IxList) b.
(Is k A_Getter, State a :&gt; r) =&gt;
Optic' k is a b -&gt; Eff r b
</span><a href="Effectful.State.Extra.html#use%27"><span class="hs-identifier hs-var">use'</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' RenameState (Map name (NonEmpty (VarRef name)))
</span><a href="#local-6989586621680213779"><span class="hs-identifier hs-var">lens</span></a></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621680213784"><span class="annot"><a href="#local-6989586621680213784"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.ask</span></span><span>
</span><span id="line-128"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621680213784"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-129"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Module Desugared)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-130"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">name
-&gt; Map name (NonEmpty (VarRef name))
-&gt; Maybe (NonEmpty (VarRef name))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213782"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map name (NonEmpty (VarRef name))
</span><a href="#local-6989586621680213783"><span class="hs-identifier hs-var">names'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-131"></span><span>                </span><span class="annot"><span class="annottext">Maybe (NonEmpty (VarRef name))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r (Located (VarRef name))
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r (Located (VarRef name)))
-&gt; RenameError -&gt; Eff r (Located (VarRef name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Located Name
-&gt; Maybe (Module Desugared)
-&gt; Map name (NonEmpty (VarRef name))
-&gt; RenameError
forall name.
(ToName name, Show name) =&gt;
Located Name
-&gt; Maybe (Module Desugared)
-&gt; Map name (NonEmpty (VarRef name))
-&gt; RenameError
</span><a href="Elara.Rename.Error.html#UnknownName"><span class="hs-identifier hs-var">UnknownName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Name -&gt; Located Name
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213781"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Located Name) -&gt; Name -&gt; Located Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">name -&gt; Name
forall name. ToName name =&gt; name -&gt; Name
</span><a href="Elara.AST.Name.html#toName"><span class="hs-identifier hs-var">toName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213782"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Module Desugared)
</span><a href="#local-6989586621680213784"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Map name (NonEmpty (VarRef name))
</span><a href="#local-6989586621680213783"><span class="hs-identifier hs-var">names'</span></a></span><span>
</span><span id="line-132"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680213785"><span class="annot"><span class="annottext">VarRef name
</span><a href="#local-6989586621680213785"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Located (VarRef name) -&gt; Eff r (Located (VarRef name))
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Located (VarRef name) -&gt; Eff r (Located (VarRef name)))
-&gt; Located (VarRef name) -&gt; Eff r (Located (VarRef name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourceRegion -&gt; VarRef name -&gt; Located (VarRef name)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213781"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">VarRef name
</span><a href="#local-6989586621680213785"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-133"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680213786"><span class="annot"><span class="annottext">NonEmpty (VarRef name)
</span><a href="#local-6989586621680213786"><span class="hs-identifier hs-var">many</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r (Located (VarRef name))
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r (Located (VarRef name)))
-&gt; RenameError -&gt; Eff r (Located (VarRef name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Located Name -&gt; NonEmpty (VarRef name) -&gt; RenameError
</span><a href="#local-6989586621680213780"><span class="hs-identifier hs-var">ambiguousError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Name -&gt; Located Name
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213781"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Located Name) -&gt; Name -&gt; Located Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">name -&gt; Name
forall name. ToName name =&gt; name -&gt; Name
</span><a href="Elara.AST.Name.html#toName"><span class="hs-identifier hs-var">toName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213782"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (VarRef name)
</span><a href="#local-6989586621680213786"><span class="hs-identifier hs-var">many</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680213787"><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680213787"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[VarRef name]
-&gt; (NonEmpty (VarRef name) -&gt; [VarRef name])
-&gt; Maybe (NonEmpty (VarRef name))
-&gt; [VarRef name]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(VarRef name -&gt; Bool) -&gt; NonEmpty (VarRef name) -&gt; [VarRef name]
forall a. (a -&gt; Bool) -&gt; NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680213787"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared -&gt; VarRef Name -&gt; Bool
</span><a href="Elara.Rename.Imports.html#isImportedBy"><span class="hs-operator hs-var">`isImportedBy`</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(VarRef Name -&gt; Bool)
-&gt; (VarRef name -&gt; VarRef Name) -&gt; VarRef name -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(name -&gt; Name) -&gt; VarRef name -&gt; VarRef Name
forall a b.
(a -&gt; b)
-&gt; VarRef' LocatedVarRefKind a -&gt; VarRef' LocatedVarRefKind b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">name -&gt; Name
forall name. ToName name =&gt; name -&gt; Name
</span><a href="Elara.AST.Name.html#toName"><span class="hs-identifier hs-var">toName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">name
-&gt; Map name (NonEmpty (VarRef name))
-&gt; Maybe (NonEmpty (VarRef name))
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213782"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Map name (NonEmpty (VarRef name))
</span><a href="#local-6989586621680213783"><span class="hs-identifier hs-var">names'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-135"></span><span>            </span><span class="hs-special">[</span><span id="local-6989586621680213791"><span class="annot"><span class="annottext">VarRef name
</span><a href="#local-6989586621680213791"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Located (VarRef name) -&gt; Eff r (Located (VarRef name))
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Located (VarRef name) -&gt; Eff r (Located (VarRef name)))
-&gt; Located (VarRef name) -&gt; Eff r (Located (VarRef name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SourceRegion -&gt; VarRef name -&gt; Located (VarRef name)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213781"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">VarRef name
</span><a href="#local-6989586621680213791"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-136"></span><span>            </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r (Located (VarRef name))
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r (Located (VarRef name)))
-&gt; RenameError -&gt; Eff r (Located (VarRef name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Located Name
-&gt; Maybe (Module Desugared)
-&gt; Map name (NonEmpty (VarRef name))
-&gt; RenameError
forall name.
(ToName name, Show name) =&gt;
Located Name
-&gt; Maybe (Module Desugared)
-&gt; Map name (NonEmpty (VarRef name))
-&gt; RenameError
</span><a href="Elara.Rename.Error.html#UnknownName"><span class="hs-identifier hs-var">UnknownName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Name -&gt; Located Name
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213781"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Located Name) -&gt; Name -&gt; Located Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">name -&gt; Name
forall name. ToName name =&gt; name -&gt; Name
</span><a href="Elara.AST.Name.html#toName"><span class="hs-identifier hs-var">toName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213782"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module Desugared -&gt; Maybe (Module Desugared)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680213787"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Map name (NonEmpty (VarRef name))
</span><a href="#local-6989586621680213783"><span class="hs-identifier hs-var">names'</span></a></span><span>
</span><span id="line-137"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621680213792"><span class="annot"><span class="annottext">VarRef name
</span><a href="#local-6989586621680213792"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680213793"><span class="annot"><span class="annottext">[VarRef name]
</span><a href="#local-6989586621680213793"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r (Located (VarRef name))
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r (Located (VarRef name)))
-&gt; RenameError -&gt; Eff r (Located (VarRef name))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Located Name -&gt; NonEmpty (VarRef name) -&gt; RenameError
</span><a href="#local-6989586621680213780"><span class="hs-identifier hs-var">ambiguousError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Name -&gt; Located Name
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213781"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Located Name) -&gt; Name -&gt; Located Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">name -&gt; Name
forall name. ToName name =&gt; name -&gt; Name
</span><a href="Elara.AST.Name.html#toName"><span class="hs-identifier hs-var">toName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213782"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarRef name
</span><a href="#local-6989586621680213792"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">VarRef name -&gt; [VarRef name] -&gt; NonEmpty (VarRef name)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[VarRef name]
</span><a href="#local-6989586621680213793"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span id="local-6989586621680213794"><span class="annot"><a href="Elara.Rename.html#lookupVarName"><span class="hs-identifier hs-type">lookupVarName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213794"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#VarRef"><span class="hs-identifier hs-type">VarRef</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-140"></span><span id="lookupVarName"><span class="annot"><span class="annottext">lookupVarName :: Located (MaybeQualified VarName)
-&gt; Eff r (Located (VarRef VarName))
</span><a href="Elara.Rename.html#lookupVarName"><span class="hs-identifier hs-var hs-var">lookupVarName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lens' RenameState (Map VarName (NonEmpty (VarRef VarName)))
-&gt; (Located Name -&gt; NonEmpty (VarRef VarName) -&gt; RenameError)
-&gt; Located (MaybeQualified VarName)
-&gt; Eff r (Located (VarRef VarName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r, Rock Query :&gt; r, Ord name, ToName name, Show name,
 Reader (Maybe (Module Desugared)) :&gt; r, State RenameState :&gt; r,
 Error RenameError :&gt; r, Error SomeReportableError :&gt; r,
 DiagnosticWriter (Doc AnsiStyle) :&gt; r, FileSystem :&gt; r,
 Concurrent :&gt; r, StructuredDebug :&gt; r) =&gt;
Lens' RenameState (Map name (NonEmpty (VarRef name)))
-&gt; (Located Name -&gt; NonEmpty (VarRef name) -&gt; RenameError)
-&gt; Located (MaybeQualified name)
-&gt; Eff r (Located (VarRef name))
</span><a href="Elara.Rename.html#lookupGenericName"><span class="hs-identifier hs-var">lookupGenericName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;varNames&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Located Name -&gt; NonEmpty (VarRef VarName) -&gt; RenameError
</span><a href="Elara.Rename.Error.html#AmbiguousVarName"><span class="hs-identifier hs-var">AmbiguousVarName</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span id="local-6989586621680213836"><span class="annot"><a href="Elara.Rename.html#lookupTypeName"><span class="hs-identifier hs-type">lookupTypeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213836"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213836"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213836"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-143"></span><span id="lookupTypeName"><span class="annot"><span class="annottext">lookupTypeName :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#lookupTypeName"><span class="hs-identifier hs-var hs-var">lookupTypeName</span></a></span></span><span> </span><span id="local-6989586621680213891"><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
</span><a href="#local-6989586621680213891"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">Optic'
  A_Lens '[] RenameState (Map TypeName (NonEmpty (VarRef TypeName)))
-&gt; (Located Name -&gt; NonEmpty (VarRef TypeName) -&gt; RenameError)
-&gt; Located (MaybeQualified TypeName)
-&gt; Eff r (Located (VarRef TypeName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r, Rock Query :&gt; r, Ord name, ToName name, Show name,
 Reader (Maybe (Module Desugared)) :&gt; r, State RenameState :&gt; r,
 Error RenameError :&gt; r, Error SomeReportableError :&gt; r,
 DiagnosticWriter (Doc AnsiStyle) :&gt; r, FileSystem :&gt; r,
 Concurrent :&gt; r, StructuredDebug :&gt; r) =&gt;
Lens' RenameState (Map name (NonEmpty (VarRef name)))
-&gt; (Located Name -&gt; NonEmpty (VarRef name) -&gt; RenameError)
-&gt; Located (MaybeQualified name)
-&gt; Eff r (Located (VarRef name))
</span><a href="Elara.Rename.html#lookupGenericName"><span class="hs-identifier hs-var">lookupGenericName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;typeNames&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Located Name -&gt; NonEmpty (VarRef TypeName) -&gt; RenameError
</span><a href="Elara.Rename.Error.html#AmbiguousTypeName"><span class="hs-identifier hs-var">AmbiguousTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
</span><a href="#local-6989586621680213891"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Eff r (Located (VarRef TypeName))
-&gt; (VarRef TypeName -&gt; Qualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
f (g a) -&gt; (a -&gt; b) -&gt; f (g b)
</span><a href="Prelude.html#%3C%3C%26%3E%3E"><span class="hs-operator hs-var">&lt;&lt;&amp;&gt;&gt;</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-145"></span><span>        </span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span class="annot"><span class="annottext">VarRefImpl LocatedVarRefKind (Unique TypeName)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Qualified TypeName
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;can't have local type names&quot;</span></span><span>
</span><span id="line-146"></span><span>        </span><span class="annot"><a href="Elara.AST.VarRef.html#Global"><span class="hs-identifier hs-type">Global</span></a></span><span> </span><span id="local-6989586621680213893"><span class="annot"><span class="annottext">VarRefImpl LocatedVarRefKind (Qualified TypeName)
</span><a href="#local-6989586621680213893"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
VarRefImpl LocatedVarRefKind (Qualified TypeName)
</span><a href="#local-6989586621680213893"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Optic'
     A_Lens '[] (Located (Qualified TypeName)) (Qualified TypeName)
-&gt; Qualified TypeName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens '[] (Located (Qualified TypeName)) (Qualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span id="local-6989586621680213894"><span class="annot"><a href="Elara.Rename.html#lookupTypeVar"><span class="hs-identifier hs-type">lookupTypeVar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier hs-type">LowerAlphaName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213894"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier hs-type">LowerAlphaName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-149"></span><span id="lookupTypeVar"><span class="annot"><span class="annottext">lookupTypeVar :: LowerAlphaName -&gt; Eff r (Maybe (Unique LowerAlphaName))
</span><a href="Elara.Rename.html#lookupTypeVar"><span class="hs-identifier hs-var hs-var">lookupTypeVar</span></a></span></span><span> </span><span id="local-6989586621680213905"><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680213905"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621680213906"><span class="annot"><a href="#local-6989586621680213906"><span class="hs-identifier hs-var">typeVars'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] a (Map LowerAlphaName (Unique LowerAlphaName))
-&gt; Eff r (Map LowerAlphaName (Unique LowerAlphaName))
forall k a (r :: [(* -&gt; *) -&gt; * -&gt; *]) (is :: IxList) b.
(Is k A_Getter, State a :&gt; r) =&gt;
Optic' k is a b -&gt; Eff r b
</span><a href="Effectful.State.Extra.html#use%27"><span class="hs-identifier hs-var">use'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;typeVars&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.lookup</span></span><span> </span><span class="annot"><a href="#local-6989586621680213905"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213906"><span class="hs-identifier hs-type">typeVars'</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span id="local-6989586621680212737"><span id="local-6989586621680212738"><span class="annot"><a href="Elara.Rename.html#uniquify"><span class="hs-identifier hs-type">uniquify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Data.Unique.Effect.html#UniqueGen"><span class="hs-identifier hs-type">UniqueGen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680212737"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212738"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212737"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212738"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-154"></span><span id="uniquify"><span class="annot"><span class="annottext">uniquify :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r) =&gt;
Located name -&gt; Eff r (Located (Unique name))
</span><a href="Elara.Rename.html#uniquify"><span class="hs-identifier hs-var hs-var">uniquify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680213911"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213911"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621680213912"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213912"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SourceRegion -&gt; Unique name -&gt; Located (Unique name)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680213911"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique name -&gt; Located (Unique name))
-&gt; Eff r (Unique name) -&gt; Eff r (Located (Unique name))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">name -&gt; Eff r (Unique name)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(UniqueGen :&gt; r) =&gt;
a -&gt; Eff r (Unique a)
</span><a href="Elara.Data.Unique.Effect.html#makeUnique"><span class="hs-identifier hs-var">makeUnique</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680213912"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="annot"><span class="hs-comment">-- | Performs a topological sort of field' declarations, so as many</span></span><span>
</span><span id="line-157"></span><span id="local-6989586621680212747"><span class="annot"><a href="Elara.Rename.html#sortDeclarations"><span class="hs-identifier hs-type">sortDeclarations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedDeclaration"><span class="hs-identifier hs-type">RenamedDeclaration</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212747"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedDeclaration"><span class="hs-identifier hs-type">RenamedDeclaration</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-158"></span><span id="sortDeclarations"><span class="annot"><span class="annottext">sortDeclarations :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
[RenamedDeclaration] -&gt; Eff r [RenamedDeclaration]
</span><a href="Elara.Rename.html#sortDeclarations"><span class="hs-identifier hs-var hs-var">sortDeclarations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RenamedDeclaration] -&gt; Eff r [RenamedDeclaration]
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">{- | Rename a module. This involves a few steps:
1. Add all imports to
-}</span></span><span>
</span><span id="line-163"></span><span id="local-6989586621680212657"><span class="annot"><a href="Elara.Rename.html#rename"><span class="hs-identifier hs-type">rename</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212657"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212657"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-164"></span><span id="rename"><span class="annot"><span class="annottext">rename :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Module Desugared -&gt; Eff r (Module Renamed)
</span><a href="Elara.Rename.html#rename"><span class="hs-identifier hs-var hs-var">rename</span></a></span></span><span> </span><span id="local-6989586621680214077"><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680214077"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">-- debug $ &quot;Renaming module &quot; &lt;&gt; pretty (m ^. _Unwrapped % unlocated % field' @&quot;name&quot;)</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Renamed)
  (Module' Desugared)
  (Module' Renamed)
-&gt; (Module' Desugared -&gt; Eff r (Module' Renamed))
-&gt; Module Desugared
-&gt; Eff r (Module Renamed)
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Renamed)
  (Located (Module' Desugared))
  (Located (Module' Renamed))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Renamed)
  (Located (Module' Desugared))
  (Located (Module' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Renamed))
     (Module' Desugared)
     (Module' Renamed)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Renamed)
     (Module' Desugared)
     (Module' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Renamed))
  (Module' Desugared)
  (Module' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680214079"><span class="annot"><span class="annottext">Module' Desugared
</span><a href="#local-6989586621680214079"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>            </span><span class="annot"><span class="annottext">[Import Desugared] -&gt; Eff r ()
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
[Import Desugared] -&gt; Eff r ()
</span><a href="Elara.Rename.html#addImportsToContext"><span class="hs-identifier hs-var">addImportsToContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module' Desugared
</span><a href="#local-6989586621680214079"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Module' Desugared
-&gt; Optic' A_Lens '[] (Module' Desugared) [Import Desugared]
-&gt; [Import Desugared]
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;imports&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>            </span><span class="annot"><span class="annottext">Optic'
  A_Traversal
  (WithIx Int)
  (Module' Desugared)
  (Declaration Desugared)
-&gt; (Declaration Desugared -&gt; Eff r ())
-&gt; Module' Desugared
-&gt; Eff r ()
forall k (f :: * -&gt; *) (is :: IxList) s a r.
(Is k A_Fold, Applicative f) =&gt;
Optic' k is s a -&gt; (a -&gt; f r) -&gt; s -&gt; f ()
</span><span class="hs-identifier hs-var">traverseOf_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;declarations&quot;</span></span><span> </span><span class="annot"><span class="annottext">Lens
  (Module' Desugared)
  (Module' Desugared)
  [Declaration Desugared]
  [Declaration Desugared]
-&gt; Optic
     A_Traversal
     (WithIx Int)
     [Declaration Desugared]
     [Declaration Desugared]
     (Declaration Desugared)
     (Declaration Desugared)
-&gt; Optic'
     A_Traversal
     (WithIx Int)
     (Module' Desugared)
     (Declaration Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Traversal
  (WithIx Int)
  [Declaration Desugared]
  [Declaration Desugared]
  (Declaration Desugared)
  (Declaration Desugared)
forall i s t a b. Each i s t a b =&gt; IxTraversal i s t a b
</span><span class="hs-identifier hs-var">each</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Declaration Desugared -&gt; Eff r ()
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Declaration Desugared -&gt; Eff r ()
</span><a href="Elara.Rename.html#addDeclarationToContext"><span class="hs-identifier hs-var">addDeclarationToContext</span></a></span><span> </span><span class="annot"><span class="annottext">Module' Desugared
</span><a href="#local-6989586621680214079"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="hs-comment">-- add our own declarations to field' context</span><span>
</span><span id="line-171"></span><span>            </span><span id="local-6989586621680214083"><span class="annot"><a href="#local-6989586621680214083"><span class="hs-identifier hs-var">exposing'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Exposing Desugared -&gt; Eff r (Exposing Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
ModuleName -&gt; Exposing Desugared -&gt; Eff r (Exposing Renamed)
</span><a href="#local-6989586621680214084"><span class="hs-identifier hs-var">renameExposing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module' Desugared
</span><a href="#local-6989586621680214079"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Module' Desugared
-&gt; Optic' A_Lens '[] (Module' Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module' Desugared)
  (Module' Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Module' Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module' Desugared
</span><a href="#local-6989586621680214079"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Module' Desugared
-&gt; Optic' A_Lens '[] (Module' Desugared) (Exposing Desugared)
-&gt; Exposing Desugared
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;exposing&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>            </span><span id="local-6989586621680214085"><span class="annot"><a href="#local-6989586621680214085"><span class="hs-identifier hs-var">imports'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="#local-6989586621680214087"><span class="hs-identifier hs-type">renameImport</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214079"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;imports&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>            </span><span id="local-6989586621680214088"><span class="annot"><a href="#local-6989586621680214088"><span class="hs-identifier hs-var">declarations'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.runReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="#local-6989586621680214077"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="Elara.Rename.html#renameDeclaration"><span class="hs-identifier hs-type">renameDeclaration</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214079"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;declarations&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>            </span><span id="local-6989586621680214091"><span class="annot"><a href="#local-6989586621680214091"><span class="hs-identifier hs-var">sorted</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#sortDeclarations"><span class="hs-identifier hs-type">sortDeclarations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680214088"><span class="hs-identifier hs-type">declarations'</span></a></span><span>
</span><span id="line-175"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module%27"><span class="hs-identifier hs-type">Module'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214079"><span class="hs-identifier hs-type">m'</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680214083"><span class="hs-identifier hs-type">exposing'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680214085"><span class="hs-identifier hs-type">imports'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680214091"><span class="hs-identifier hs-type">sorted</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680214077"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-179"></span><span>    </span><span id="local-6989586621680212778"><span class="annot"><a href="#local-6989586621680214084"><span class="hs-identifier hs-type">renameExposing</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212778"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Exposing"><span class="hs-identifier hs-type">Exposing</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212778"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Exposing"><span class="hs-identifier hs-type">Exposing</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621680214084"><span class="annot"><span class="annottext">renameExposing :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
ModuleName -&gt; Exposing Desugared -&gt; Eff r (Exposing Renamed)
</span><a href="#local-6989586621680214084"><span class="hs-identifier hs-var hs-var">renameExposing</span></a></span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exposing Desugared
</span><a href="Elara.AST.Module.html#ExposingAll"><span class="hs-identifier hs-var">ExposingAll</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Exposing Renamed -&gt; Eff r (Exposing Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Exposing Renamed
forall {a} (ast :: a). Exposing ast
</span><a href="Elara.AST.Module.html#ExposingAll"><span class="hs-identifier hs-var">ExposingAll</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="annot"><a href="#local-6989586621680214084"><span class="hs-identifier hs-var">renameExposing</span></a></span><span> </span><span id="local-6989586621680214109"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214109"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposingSome"><span class="hs-identifier hs-type">ExposingSome</span></a></span><span> </span><span id="local-6989586621680214111"><span class="annot"><span class="annottext">[Exposition Desugared]
</span><a href="#local-6989586621680214111"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Exposition Renamed] -&gt; Exposing Renamed
forall {a} (ast :: a). [Exposition ast] -&gt; Exposing ast
</span><a href="Elara.AST.Module.html#ExposingSome"><span class="hs-identifier hs-var">ExposingSome</span></a></span><span> </span><span class="annot"><span class="annottext">([Exposition Renamed] -&gt; Exposing Renamed)
-&gt; Eff r [Exposition Renamed] -&gt; Eff r (Exposing Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Exposition Desugared -&gt; Eff r (Exposition Renamed))
-&gt; [Exposition Desugared] -&gt; Eff r [Exposition Renamed]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Exposition Desugared -&gt; Eff r (Exposition Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
ModuleName -&gt; Exposition Desugared -&gt; Eff r (Exposition Renamed)
</span><a href="#local-6989586621680214112"><span class="hs-identifier hs-var">renameExposition</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214109"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exposition Desugared]
</span><a href="#local-6989586621680214111"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span>    </span><span id="local-6989586621680212795"><span class="annot"><a href="#local-6989586621680214112"><span class="hs-identifier hs-type">renameExposition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212795"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Exposition"><span class="hs-identifier hs-type">Exposition</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212795"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Exposition"><span class="hs-identifier hs-type">Exposition</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-184"></span><span>    </span><span id="local-6989586621680214112"><span class="annot"><span class="annottext">renameExposition :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
ModuleName -&gt; Exposition Desugared -&gt; Eff r (Exposition Renamed)
</span><a href="#local-6989586621680214112"><span class="hs-identifier hs-var hs-var">renameExposition</span></a></span></span><span> </span><span id="local-6989586621680214140"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214140"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedValue"><span class="hs-identifier hs-type">ExposedValue</span></a></span><span> </span><span id="local-6989586621680214142"><span class="annot"><span class="annottext">FullASTQual Desugared VarName
</span><a href="#local-6989586621680214142"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (Qualified VarName) -&gt; Exposition Renamed
FullASTQual Renamed VarName -&gt; Exposition Renamed
forall {a} (ast :: a). FullASTQual ast VarName -&gt; Exposition ast
</span><a href="Elara.AST.Module.html#ExposedValue"><span class="hs-identifier hs-var">ExposedValue</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (Qualified VarName) -&gt; Exposition Renamed)
-&gt; Eff r (Located (Qualified VarName))
-&gt; Eff r (Exposition Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(MaybeQualified VarName -&gt; Eff r (Qualified VarName))
-&gt; Located (MaybeQualified VarName)
-&gt; Eff r (Located (Qualified VarName))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Located a -&gt; f (Located b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; MaybeQualified VarName -&gt; Eff r (Qualified VarName)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
Rename r =&gt;
ModuleName -&gt; MaybeQualified name -&gt; Eff r (Qualified name)
</span><a href="Elara.Rename.html#qualifyIn"><span class="hs-identifier hs-var">qualifyIn</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214140"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
FullASTQual Desugared VarName
</span><a href="#local-6989586621680214142"><span class="hs-identifier hs-var">vn</span></a></span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="#local-6989586621680214112"><span class="hs-identifier hs-var">renameExposition</span></a></span><span> </span><span id="local-6989586621680214143"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214143"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedOp"><span class="hs-identifier hs-type">ExposedOp</span></a></span><span> </span><span id="local-6989586621680214145"><span class="annot"><span class="annottext">FullASTQual Desugared OpName
</span><a href="#local-6989586621680214145"><span class="hs-identifier hs-var">opn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (Qualified OpName) -&gt; Exposition Renamed
FullASTQual Renamed OpName -&gt; Exposition Renamed
forall {a} (ast :: a). FullASTQual ast OpName -&gt; Exposition ast
</span><a href="Elara.AST.Module.html#ExposedOp"><span class="hs-identifier hs-var">ExposedOp</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (Qualified OpName) -&gt; Exposition Renamed)
-&gt; Eff r (Located (Qualified OpName)) -&gt; Eff r (Exposition Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(MaybeQualified OpName -&gt; Eff r (Qualified OpName))
-&gt; Located (MaybeQualified OpName)
-&gt; Eff r (Located (Qualified OpName))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Located a -&gt; f (Located b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; MaybeQualified OpName -&gt; Eff r (Qualified OpName)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
Rename r =&gt;
ModuleName -&gt; MaybeQualified name -&gt; Eff r (Qualified name)
</span><a href="Elara.Rename.html#qualifyIn"><span class="hs-identifier hs-var">qualifyIn</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214143"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified OpName)
FullASTQual Desugared OpName
</span><a href="#local-6989586621680214145"><span class="hs-identifier hs-var">opn</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="#local-6989586621680214112"><span class="hs-identifier hs-var">renameExposition</span></a></span><span> </span><span id="local-6989586621680214146"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214146"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedType"><span class="hs-identifier hs-type">ExposedType</span></a></span><span> </span><span id="local-6989586621680214148"><span class="annot"><span class="annottext">FullASTQual Desugared TypeName
</span><a href="#local-6989586621680214148"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName) -&gt; Exposition Renamed
FullASTQual Renamed TypeName -&gt; Exposition Renamed
forall {a} (ast :: a). FullASTQual ast TypeName -&gt; Exposition ast
</span><a href="Elara.AST.Module.html#ExposedType"><span class="hs-identifier hs-var">ExposedType</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (Qualified TypeName) -&gt; Exposition Renamed)
-&gt; Eff r (Located (Qualified TypeName))
-&gt; Eff r (Exposition Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(MaybeQualified TypeName -&gt; Eff r (Qualified TypeName))
-&gt; Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Located a -&gt; f (Located b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; MaybeQualified TypeName -&gt; Eff r (Qualified TypeName)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
Rename r =&gt;
ModuleName -&gt; MaybeQualified name -&gt; Eff r (Qualified name)
</span><a href="Elara.Rename.html#qualifyIn"><span class="hs-identifier hs-var">qualifyIn</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214146"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
FullASTQual Desugared TypeName
</span><a href="#local-6989586621680214148"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><a href="#local-6989586621680214112"><span class="hs-identifier hs-var">renameExposition</span></a></span><span> </span><span id="local-6989586621680214149"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214149"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedTypeAndAllConstructors"><span class="hs-identifier hs-type">ExposedTypeAndAllConstructors</span></a></span><span> </span><span id="local-6989586621680214151"><span class="annot"><span class="annottext">FullASTQual Desugared TypeName
</span><a href="#local-6989586621680214151"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName) -&gt; Exposition Renamed
FullASTQual Renamed TypeName -&gt; Exposition Renamed
forall {a} (ast :: a). FullASTQual ast TypeName -&gt; Exposition ast
</span><a href="Elara.AST.Module.html#ExposedTypeAndAllConstructors"><span class="hs-identifier hs-var">ExposedTypeAndAllConstructors</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (Qualified TypeName) -&gt; Exposition Renamed)
-&gt; Eff r (Located (Qualified TypeName))
-&gt; Eff r (Exposition Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(MaybeQualified TypeName -&gt; Eff r (Qualified TypeName))
-&gt; Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Located a -&gt; f (Located b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; MaybeQualified TypeName -&gt; Eff r (Qualified TypeName)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
Rename r =&gt;
ModuleName -&gt; MaybeQualified name -&gt; Eff r (Qualified name)
</span><a href="Elara.Rename.html#qualifyIn"><span class="hs-identifier hs-var">qualifyIn</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680214149"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
FullASTQual Desugared TypeName
</span><a href="#local-6989586621680214151"><span class="hs-identifier hs-var">tn</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span>    </span><span id="local-6989586621680212783"><span class="annot"><a href="#local-6989586621680214087"><span class="hs-identifier hs-type">renameImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212783"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Import"><span class="hs-identifier hs-type">Import</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212783"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Import"><span class="hs-identifier hs-type">Import</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-190"></span><span>    </span><span id="local-6989586621680214087"><span class="annot"><span class="annottext">renameImport :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Import Desugared -&gt; Eff r (Import Renamed)
</span><a href="#local-6989586621680214087"><span class="hs-identifier hs-var hs-var">renameImport</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Import Desugared)
  (Import Renamed)
  (Import' Desugared)
  (Import' Renamed)
-&gt; (Import' Desugared -&gt; Eff r (Import' Renamed))
-&gt; Import Desugared
-&gt; Eff r (Import Renamed)
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Renamed)
  (Located (Import' Desugared))
  (Located (Import' Renamed))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Renamed)
  (Located (Import' Desugared))
  (Located (Import' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Import' Desugared))
     (Located (Import' Renamed))
     (Import' Desugared)
     (Import' Renamed)
-&gt; Optic
     A_Lens
     '[]
     (Import Desugared)
     (Import Renamed)
     (Import' Desugared)
     (Import' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Import' Desugared))
  (Located (Import' Renamed))
  (Import' Desugared)
  (Import' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Import' Desugared -&gt; Eff r (Import' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Import' Desugared -&gt; Eff r (Import' Renamed)
</span><a href="#local-6989586621680214188"><span class="hs-identifier hs-var">renameImport'</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span>    </span><span id="local-6989586621680212805"><span class="annot"><a href="#local-6989586621680214188"><span class="hs-identifier hs-type">renameImport'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212805"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Import%27"><span class="hs-identifier hs-type">Import'</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212805"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Import%27"><span class="hs-identifier hs-type">Import'</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-193"></span><span>    </span><span id="local-6989586621680214188"><span class="annot"><span class="annottext">renameImport' :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Import' Desugared -&gt; Eff r (Import' Renamed)
</span><a href="#local-6989586621680214188"><span class="hs-identifier hs-var hs-var">renameImport'</span></a></span></span><span> </span><span id="local-6989586621680214264"><span class="annot"><span class="annottext">Import' Desugared
</span><a href="#local-6989586621680214264"><span class="hs-identifier hs-var">imp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621680214265"><span class="annot"><a href="#local-6989586621680214265"><span class="hs-identifier hs-var">exposing'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; Exposing Desugared -&gt; Eff r (Exposing Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
ModuleName -&gt; Exposing Desugared -&gt; Eff r (Exposing Renamed)
</span><a href="#local-6989586621680214084"><span class="hs-identifier hs-var">renameExposing</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Import' Desugared
</span><a href="#local-6989586621680214264"><span class="hs-identifier hs-var">imp</span></a></span><span> </span><span class="annot"><span class="annottext">Import' Desugared
-&gt; Optic' A_Lens '[] (Import' Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;importing&quot;</span></span><span> </span><span class="annot"><span class="annottext">Lens
  (Import' Desugared)
  (Import' Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Import' Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Import' Desugared
</span><a href="#local-6989586621680214264"><span class="hs-identifier hs-var">imp</span></a></span><span> </span><span class="annot"><span class="annottext">Import' Desugared
-&gt; Optic' A_Lens '[] (Import' Desugared) (Exposing Desugared)
-&gt; Exposing Desugared
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;exposing&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-196"></span><span>            </span><span class="annot"><a href="Elara.AST.Module.html#Import%27"><span class="hs-identifier hs-type">Import'</span></a></span><span>
</span><span id="line-197"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214264"><span class="hs-identifier hs-type">imp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;importing&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214264"><span class="hs-identifier hs-type">imp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;as&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214264"><span class="hs-identifier hs-type">imp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;qualified&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>                </span><span class="annot"><a href="#local-6989586621680214265"><span class="hs-identifier hs-type">exposing'</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span id="local-6989586621680212764"><span class="annot"><a href="Elara.Rename.html#addImportsToContext"><span class="hs-identifier hs-type">addImportsToContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212764"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Module.html#Import"><span class="hs-identifier hs-type">Import</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212764"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-203"></span><span id="addImportsToContext"><span class="annot"><span class="annottext">addImportsToContext :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
[Import Desugared] -&gt; Eff r ()
</span><a href="Elara.Rename.html#addImportsToContext"><span class="hs-identifier hs-var hs-var">addImportsToContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Import Desugared -&gt; Eff r ()) -&gt; [Import Desugared] -&gt; Eff r ()
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><span class="hs-identifier hs-var">traverse_</span></span><span> </span><span class="annot"><span class="annottext">Import Desugared -&gt; Eff r ()
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Import Desugared -&gt; Eff r ()
</span><a href="Elara.Rename.html#addImportToContext"><span class="hs-identifier hs-var">addImportToContext</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span id="local-6989586621680212816"><span class="annot"><a href="Elara.Rename.html#addImportToContext"><span class="hs-identifier hs-type">addImportToContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212816"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Import"><span class="hs-identifier hs-type">Import</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212816"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-206"></span><span id="addImportToContext"><span class="annot"><span class="annottext">addImportToContext :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Import Desugared -&gt; Eff r ()
</span><a href="Elara.Rename.html#addImportToContext"><span class="hs-identifier hs-var hs-var">addImportToContext</span></a></span></span><span> </span><span id="local-6989586621680214396"><span class="annot"><span class="annottext">Import Desugared
</span><a href="#local-6989586621680214396"><span class="hs-identifier hs-var">imp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><span class="annottext">Located ModuleName -&gt; Exposing Desugared -&gt; Bool -&gt; Eff r ()
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Located ModuleName -&gt; Exposing Desugared -&gt; Bool -&gt; Eff r ()
</span><a href="Elara.Rename.html#addModuleToContext"><span class="hs-identifier hs-var">addModuleToContext</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Import Desugared
</span><a href="#local-6989586621680214396"><span class="hs-identifier hs-var">imp</span></a></span><span> </span><span class="annot"><span class="annottext">Import Desugared
-&gt; Optic' A_Lens '[] (Import Desugared) (Located ModuleName)
-&gt; Located ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Import' Desugared))
     (Located (Import' Desugared))
     (Import' Desugared)
     (Import' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Import Desugared)
     (Import Desugared)
     (Import' Desugared)
     (Import' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Import' Desugared))
  (Located (Import' Desugared))
  (Import' Desugared)
  (Import' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Import Desugared)
  (Import Desugared)
  (Import' Desugared)
  (Import' Desugared)
-&gt; Lens
     (Import' Desugared)
     (Import' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic' A_Lens '[] (Import Desugared) (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;importing&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Import Desugared
</span><a href="#local-6989586621680214396"><span class="hs-identifier hs-var">imp</span></a></span><span> </span><span class="annot"><span class="annottext">Import Desugared
-&gt; Optic' A_Lens '[] (Import Desugared) (Exposing Desugared)
-&gt; Exposing Desugared
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Import' Desugared))
     (Located (Import' Desugared))
     (Import' Desugared)
     (Import' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Import Desugared)
     (Import Desugared)
     (Import' Desugared)
     (Import' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Import' Desugared))
  (Located (Import' Desugared))
  (Import' Desugared)
  (Import' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Import Desugared)
  (Import Desugared)
  (Import' Desugared)
  (Import' Desugared)
-&gt; Optic' A_Lens '[] (Import' Desugared) (Exposing Desugared)
-&gt; Optic' A_Lens '[] (Import Desugared) (Exposing Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;exposing&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Import Desugared
</span><a href="#local-6989586621680214396"><span class="hs-identifier hs-var">imp</span></a></span><span> </span><span class="annot"><span class="annottext">Import Desugared
-&gt; Optic' A_Lens '[] (Import Desugared) Bool -&gt; Bool
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Import' Desugared))
     (Located (Import' Desugared))
     (Import' Desugared)
     (Import' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Import Desugared)
     (Import Desugared)
     (Import' Desugared)
     (Import' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Import' Desugared))
  (Located (Import' Desugared))
  (Import' Desugared)
  (Import' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Import Desugared)
  (Import Desugared)
  (Import' Desugared)
  (Import' Desugared)
-&gt; Optic' A_Lens '[] (Import' Desugared) Bool
-&gt; Optic' A_Lens '[] (Import Desugared) Bool
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;qualified&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span id="local-6989586621680212819"><span class="annot"><a href="Elara.Rename.html#getModuleFromName"><span class="hs-identifier hs-type">getModuleFromName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212819"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212819"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-213"></span><span id="getModuleFromName"><span class="annot"><span class="annottext">getModuleFromName :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Located ModuleName -&gt; Eff r (Module Desugared)
</span><a href="Elara.Rename.html#getModuleFromName"><span class="hs-identifier hs-var hs-var">getModuleFromName</span></a></span></span><span> </span><span id="local-6989586621680214529"><span class="annot"><span class="annottext">Located ModuleName
</span><a href="#local-6989586621680214529"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>    </span><span id="local-6989586621680214530"><span class="annot"><a href="#local-6989586621680214530"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-215"></span><span>        </span><span class="annot"><span class="annottext">forall e (r :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(DiagnosticWriter (Doc AnsiStyle) :&gt; r,
 Error SomeReportableError :&gt; r, ReportableError e) =&gt;
Eff (Error e : r) a -&gt; Eff r a
</span><a href="Elara.Error.html#runErrorOrReport"><span class="hs-identifier hs-var">runErrorOrReport</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.Desugar.Error.html#DesugarError"><span class="hs-identifier hs-type">DesugarError</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff (Error DesugarError : r) (Module Desugared)
 -&gt; Eff r (Module Desugared))
-&gt; Eff (Error DesugarError : r) (Module Desugared)
-&gt; Eff r (Module Desugared)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-216"></span><span>            </span><span class="annot"><span class="annottext">Query
  (Rock Query : ConsQueryEffects '[Error DesugarError])
  (Module Desugared)
-&gt; Eff (Error DesugarError : r) (Module Desugared)
forall (xs :: [(* -&gt; *) -&gt; * -&gt; *]) (es :: [(* -&gt; *) -&gt; * -&gt; *])
       (f :: [(* -&gt; *) -&gt; * -&gt; *] -&gt; * -&gt; *) a.
(Subset xs es, Rock f :&gt; es, HasCallStack,
 StructuredDebug :&gt; xs) =&gt;
f xs a -&gt; Eff es a
</span><a href="Rock.html#fetch"><span class="hs-identifier hs-var">Rock.fetch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName
-&gt; Query
     (Rock Query : ConsQueryEffects '[Error DesugarError])
     (Module Desugared)
</span><a href="Elara.Query.html#DesugaredModule"><span class="hs-identifier hs-var">Elara.Query.DesugaredModule</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located ModuleName
</span><a href="#local-6989586621680214529"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Located ModuleName
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680214531"><span class="annot"><a href="#local-6989586621680214531"><span class="hs-identifier hs-var hs-var">actualName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680214530"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module' Desugared)
     (Module' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214531"><span class="hs-identifier hs-type">actualName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">/=</span></span><span> </span><span class="annot"><a href="#local-6989586621680214529"><span class="hs-identifier hs-type">mn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">throwError</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-220"></span><span>            </span><span class="annot"><a href="Elara.Rename.Error.html#ModuleNameMismatch"><span class="hs-identifier hs-type">ModuleNameMismatch</span></a></span><span>
</span><span id="line-221"></span><span>                </span><span class="annot"><a href="#local-6989586621680214529"><span class="hs-identifier hs-type">mn</span></a></span><span>
</span><span id="line-222"></span><span>                </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214531"><span class="hs-identifier hs-type">actualName</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-type">`withLocationOf`</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680214530"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621680214530"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-224"></span><span>
</span><span id="line-225"></span><span class="annot"><span class="hs-comment">-- | Add all exposed declarations from a module to the renaming context,</span></span><span>
</span><span id="line-226"></span><span id="local-6989586621680212818"><span class="annot"><a href="Elara.Rename.html#addModuleToContext"><span class="hs-identifier hs-type">addModuleToContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212818"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="Elara.AST.Module.html#Exposing"><span class="hs-identifier hs-type">Exposing</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><span class="hs-comment">-- | If the import is qualified</span></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212818"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-233"></span><span id="addModuleToContext"><span class="annot"><span class="annottext">addModuleToContext :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Located ModuleName -&gt; Exposing Desugared -&gt; Bool -&gt; Eff r ()
</span><a href="Elara.Rename.html#addModuleToContext"><span class="hs-identifier hs-var hs-var">addModuleToContext</span></a></span></span><span> </span><span id="local-6989586621680214678"><span class="annot"><span class="annottext">Located ModuleName
</span><a href="#local-6989586621680214678"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span id="local-6989586621680214679"><span class="annot"><span class="annottext">Exposing Desugared
</span><a href="#local-6989586621680214679"><span class="hs-identifier hs-var">exposing</span></a></span></span><span> </span><span id="local-6989586621680214680"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680214680"><span class="hs-keyword hs-var">qualified</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621680214681"><span class="annot"><a href="#local-6989586621680214681"><span class="hs-identifier hs-var">imported</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located ModuleName -&gt; Eff r (Module Desugared)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Located ModuleName -&gt; Eff r (Module Desugared)
</span><a href="Elara.Rename.html#getModuleFromName"><span class="hs-identifier hs-var">getModuleFromName</span></a></span><span> </span><span class="annot"><span class="annottext">Located ModuleName
</span><a href="#local-6989586621680214678"><span class="hs-identifier hs-var">mn</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680214682"><span class="annot"><a href="#local-6989586621680214682"><span class="hs-identifier hs-var hs-var">isExposingL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>            </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located Name)
  (Located Name)
Getter
  (Declaration Desugared)
  (CleanupLocated (ASTLocate' Desugared Name))
forall {a} (ast :: a).
(CleanupLocated (Located (Select (ASTName ForType) ast))
 ~ Located (Select (ASTName ForType) ast),
 CleanupLocated (Located (Select (ASTName ForValueDecl) ast))
 ~ Located (Select (ASTName ForValueDecl) ast),
 RUnlocate ast, ToName (Select (ASTName ForValueDecl) ast),
 ToName (Select (ASTName ForType) ast)) =&gt;
Getter (Declaration ast) (CleanupLocated (ASTLocate' ast Name))
</span><a href="Elara.AST.Generic.Types.html#declarationName"><span class="hs-identifier hs-var">declarationName</span></a></span><span>
</span><span id="line-237"></span><span>                </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located Name)
  (Located Name)
-&gt; Optic A_Lens '[] (Located Name) (Located Name) Name Name
-&gt; Optic
     A_Getter
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     Name
     Name
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens '[] (Located Name) (Located Name) Name Name
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-238"></span><span>                </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  Name
  Name
-&gt; Optic A_Getter '[] Name Name Bool Bool
-&gt; Optic
     A_Getter
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     Bool
     Bool
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Bool) -&gt; Optic A_Getter '[] Name Name Bool Bool
forall s a. (s -&gt; a) -&gt; Getter s a
</span><span class="hs-identifier hs-var">to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module Desugared -&gt; Name -&gt; Bool
</span><a href="Elara.Rename.html#isExposingAndExists"><span class="hs-identifier hs-var">isExposingAndExists</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680214681"><span class="hs-identifier hs-var">imported</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680214686"><span class="annot"><a href="#local-6989586621680214686"><span class="hs-identifier hs-var hs-var">exposed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exposing Desugared
</span><a href="#local-6989586621680214679"><span class="hs-identifier hs-var">exposing</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-240"></span><span>            </span><span class="annot"><span class="annottext">Exposing Desugared
</span><a href="Elara.AST.Module.html#ExposingAll"><span class="hs-identifier hs-var">ExposingAll</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680214681"><span class="hs-identifier hs-var">imported</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) [Declaration Desugared]
-&gt; [Declaration Desugared]
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Lens
     (Module' Desugared)
     (Module' Desugared)
     [Declaration Desugared]
     [Declaration Desugared]
-&gt; Optic' A_Lens '[] (Module Desugared) [Declaration Desugared]
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;declarations&quot;</span></span><span>
</span><span id="line-241"></span><span>            </span><span class="annot"><a href="Elara.AST.Module.html#ExposingSome"><span class="hs-identifier hs-type">ExposingSome</span></a></span><span> </span><span class="annot"><span class="annottext">[Exposition Desugared]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680214681"><span class="hs-identifier hs-var">imported</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic'
     A_Fold (WithIx Bool) (Module Desugared) (Declaration Desugared)
-&gt; [Declaration Desugared]
forall k s (is :: IxList) a.
Is k A_Fold =&gt;
s -&gt; Optic' k is s a -&gt; [a]
</span><span class="hs-operator hs-var">^..</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Lens
     (Module' Desugared)
     (Module' Desugared)
     [Declaration Desugared]
     [Declaration Desugared]
-&gt; Optic' A_Lens '[] (Module Desugared) [Declaration Desugared]
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;declarations&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] (Module Desugared) [Declaration Desugared]
-&gt; Optic
     A_Fold
     '[]
     [Declaration Desugared]
     [Declaration Desugared]
     (Declaration Desugared)
     (Declaration Desugared)
-&gt; Optic
     A_Fold
     '[]
     (Module Desugared)
     (Module Desugared)
     (Declaration Desugared)
     (Declaration Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Fold
  '[]
  [Declaration Desugared]
  [Declaration Desugared]
  (Declaration Desugared)
  (Declaration Desugared)
forall (f :: * -&gt; *) a. Foldable f =&gt; Fold (f a) a
</span><span class="hs-identifier hs-var">folded</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Fold
  '[]
  (Module Desugared)
  (Module Desugared)
  (Declaration Desugared)
  (Declaration Desugared)
-&gt; Optic
     An_AffineFold
     (WithIx Bool)
     (Declaration Desugared)
     (Declaration Desugared)
     (Declaration Desugared)
     (Declaration Desugared)
-&gt; Optic'
     A_Fold (WithIx Bool) (Module Desugared) (Declaration Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  Bool
  Bool
-&gt; Optic
     An_AffineFold
     (WithIx Bool)
     (Declaration Desugared)
     (Declaration Desugared)
     (Declaration Desugared)
     (Declaration Desugared)
forall k (is :: IxList) a i.
Is k An_AffineFold =&gt;
Optic' k is a i -&gt; IxAffineFold i a a
</span><span class="hs-identifier hs-var">filteredBy</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  Bool
  Bool
</span><a href="#local-6989586621680214682"><span class="hs-identifier hs-var">isExposingL</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="annot"><a href="#local-6989586621680214680"><span class="hs-keyword hs-type">qualified</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-244"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">traverse_</span></span><span> </span><span class="annot"><a href="Elara.Rename.html#addDeclarationToContext"><span class="hs-identifier hs-type">addDeclarationToContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680214686"><span class="hs-identifier hs-type">exposed</span></a></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="annot"><a href="#local-6989586621680214680"><span class="hs-keyword hs-type">qualified</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-247"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span id="local-6989586621680214691"><span class="annot"><a href="#local-6989586621680214691"><span class="hs-identifier hs-var">parts</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621680214678"><span class="hs-identifier hs-type">mn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span>
</span><span id="line-248"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680214692"><span class="annot"><a href="#local-6989586621680214692"><span class="hs-identifier hs-var hs-var">simpleModuleName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty Text -&gt; Text
forall (f :: * -&gt; *) a. IsNonEmpty f a a &quot;last&quot; =&gt; f a -&gt; a
</span><span class="hs-identifier hs-var">last</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty Text
</span><a href="#local-6989586621680214691"><span class="hs-identifier hs-var">parts</span></a></span><span>
</span><span id="line-249"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680214694"><span class="annot"><a href="#local-6989586621680214694"><span class="hs-identifier hs-var hs-var">isPrincipalType</span></a></span></span><span> </span><span id="local-6989586621680214695"><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680214695"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-250"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680214695"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
-&gt; Optic
     A_Getter
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     Name
     Name
-&gt; Name
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located Name)
  (Located Name)
Getter
  (Declaration Desugared)
  (CleanupLocated (ASTLocate' Desugared Name))
forall {a} (ast :: a).
(CleanupLocated (Located (Select (ASTName ForType) ast))
 ~ Located (Select (ASTName ForType) ast),
 CleanupLocated (Located (Select (ASTName ForValueDecl) ast))
 ~ Located (Select (ASTName ForValueDecl) ast),
 RUnlocate ast, ToName (Select (ASTName ForValueDecl) ast),
 ToName (Select (ASTName ForType) ast)) =&gt;
Getter (Declaration ast) (CleanupLocated (ASTLocate' ast Name))
</span><a href="Elara.AST.Generic.Types.html#declarationName"><span class="hs-identifier hs-var">declarationName</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located Name)
  (Located Name)
-&gt; Optic A_Lens '[] (Located Name) (Located Name) Name Name
-&gt; Optic
     A_Getter
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     Name
     Name
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens '[] (Located Name) (Located Name) Name Name
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-251"></span><span>                    </span><span class="annot"><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-type">NTypeName</span></a></span><span> </span><span id="local-6989586621680214696"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680214696"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680214696"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; TypeName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; TypeName
</span><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-var">TypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680214692"><span class="hs-identifier hs-var">simpleModuleName</span></a></span><span>
</span><span id="line-252"></span><span>                    </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-253"></span><span>
</span><span id="line-254"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680214698"><span class="annot"><a href="#local-6989586621680214698"><span class="hs-identifier hs-var hs-var">principalTypes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Declaration Desugared -&gt; Bool)
-&gt; [Declaration Desugared] -&gt; [Declaration Desugared]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared -&gt; Bool
</span><a href="#local-6989586621680214694"><span class="hs-identifier hs-var">isPrincipalType</span></a></span><span> </span><span class="annot"><span class="annottext">[Declaration Desugared]
</span><a href="#local-6989586621680214686"><span class="hs-identifier hs-var">exposed</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">traverse_</span></span><span> </span><span class="annot"><a href="Elara.Rename.html#addDeclarationToContext"><span class="hs-identifier hs-type">addDeclarationToContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680214698"><span class="hs-identifier hs-type">principalTypes</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span class="annot"><span class="hs-comment">-- | Add a declaration to the renaming state.</span></span><span>
</span><span id="line-258"></span><span id="local-6989586621680212777"><span class="annot"><a href="Elara.Rename.html#addDeclarationToContext"><span class="hs-identifier hs-type">addDeclarationToContext</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="Elara.Rename.html#Rename"><span class="hs-identifier hs-type">Rename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212777"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212777"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-262"></span><span id="addDeclarationToContext"><span class="annot"><span class="annottext">addDeclarationToContext :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
Rename r =&gt;
Declaration Desugared -&gt; Eff r ()
</span><a href="Elara.Rename.html#addDeclarationToContext"><span class="hs-identifier hs-var hs-var">addDeclarationToContext</span></a></span></span><span> </span><span id="local-6989586621680215086"><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215086"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">-- Create a global VarRef for the name based on</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680213012"><span class="annot"><a href="#local-6989586621680215087"><span class="hs-identifier hs-type">global</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621680213012"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#VarRef"><span class="hs-identifier hs-type">VarRef</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213012"><span class="hs-identifier hs-type">name</span></a></span></span><span>
</span><span id="line-265"></span><span>        </span><span id="local-6989586621680215087"><span class="annot"><span class="annottext">global :: forall name. name -&gt; VarRef name
</span><a href="#local-6989586621680215087"><span class="hs-identifier hs-var hs-var hs-var">global</span></a></span></span><span> </span><span id="local-6989586621680215132"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680215132"><span class="hs-identifier hs-var">vn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-266"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680215133"><span class="annot"><span class="annottext">declModuleName :: ModuleName
</span><a href="#local-6989586621680215133"><span class="hs-identifier hs-var hs-var">declModuleName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215086"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
-&gt; Optic' A_Lens '[] (Declaration Desugared) ModuleName
-&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Declaration' Desugared))
     (Located (Declaration' Desugared))
     (Declaration' Desugared)
     (Declaration' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     (Declaration' Desugared)
     (Declaration' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
  (Declaration' Desugared)
  (Declaration' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Declaration' Desugared)
  (Declaration' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration' Desugared)
     (Declaration' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;moduleName&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Declaration Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-267"></span><span>                </span><span id="local-6989586621680215134"><span class="annot"><span class="annottext">locatedDecl :: Located (Declaration' Desugared)
</span><a href="#local-6989586621680215134"><span class="hs-identifier hs-var hs-var">locatedDecl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215086"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
-&gt; Iso
     (Declaration Desugared)
     (Declaration Desugared)
     (Located (Declaration' Desugared))
     (Located (Declaration' Desugared))
-&gt; Located (Declaration' Desugared)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span>
</span><span id="line-268"></span><span>             </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">VarRefImpl LocatedVarRefKind (Qualified name)
-&gt; VarRef' LocatedVarRefKind name
forall (c :: VarRefKind) n.
VarRefImpl c (Qualified n) -&gt; VarRef' c n
</span><a href="Elara.AST.VarRef.html#Global"><span class="hs-identifier hs-var">Global</span></a></span><span>
</span><span id="line-269"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">name -&gt; ModuleName -&gt; Qualified name
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-var">Qualified</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621680215132"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680215133"><span class="hs-identifier hs-var">declModuleName</span></a></span><span>
</span><span id="line-270"></span><span>                        </span><span class="annot"><span class="annottext">Qualified name
-&gt; Located (Declaration' Desugared) -&gt; Located (Qualified name)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Declaration' Desugared)
</span><a href="#local-6989586621680215134"><span class="hs-identifier hs-var">locatedDecl</span></a></span><span>
</span><span id="line-271"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215086"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
-&gt; Optic
     A_Getter
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     Name
     Name
-&gt; Name
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located Name)
  (Located Name)
Getter
  (Declaration Desugared)
  (CleanupLocated (ASTLocate' Desugared Name))
forall {a} (ast :: a).
(CleanupLocated (Located (Select (ASTName ForType) ast))
 ~ Located (Select (ASTName ForType) ast),
 CleanupLocated (Located (Select (ASTName ForValueDecl) ast))
 ~ Located (Select (ASTName ForValueDecl) ast),
 RUnlocate ast, ToName (Select (ASTName ForValueDecl) ast),
 ToName (Select (ASTName ForType) ast)) =&gt;
Getter (Declaration ast) (CleanupLocated (ASTLocate' ast Name))
</span><a href="Elara.AST.Generic.Types.html#declarationName"><span class="hs-identifier hs-var">declarationName</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located Name)
  (Located Name)
-&gt; Optic A_Lens '[] (Located Name) (Located Name) Name Name
-&gt; Optic
     A_Getter
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     Name
     Name
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens '[] (Located Name) (Located Name) Name Name
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><a href="Elara.AST.Name.html#NVarName"><span class="hs-identifier hs-type">NVarName</span></a></span><span> </span><span id="local-6989586621680215135"><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621680215135"><span class="hs-identifier hs-var">vn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RenameState -&gt; RenameState) -&gt; Eff r ()
forall s (es :: [(* -&gt; *) -&gt; * -&gt; *]).
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; s) -&gt; Eff es ()
</span><span class="hs-identifier hs-var">Eff.modify</span></span><span> </span><span class="annot"><span class="annottext">((RenameState -&gt; RenameState) -&gt; Eff r ())
-&gt; (RenameState -&gt; RenameState) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Lens' RenameState (Map VarName (NonEmpty (VarRef VarName)))
-&gt; (Map VarName (NonEmpty (VarRef VarName))
    -&gt; Map VarName (NonEmpty (VarRef VarName)))
-&gt; RenameState
-&gt; RenameState
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (sel :: k) s t a b. HasAny sel s t a b =&gt; Lens s t a b
forall (sel :: Symbol) s t a b. HasAny sel s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;varNames&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Map VarName (NonEmpty (VarRef VarName))
  -&gt; Map VarName (NonEmpty (VarRef VarName)))
 -&gt; RenameState -&gt; RenameState)
-&gt; (Map VarName (NonEmpty (VarRef VarName))
    -&gt; Map VarName (NonEmpty (VarRef VarName)))
-&gt; RenameState
-&gt; RenameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">VarName
-&gt; VarRef VarName
-&gt; Map VarName (NonEmpty (VarRef VarName))
-&gt; Map VarName (NonEmpty (VarRef VarName))
forall k a.
(Ord k, Eq a) =&gt;
k -&gt; a -&gt; Map k (NonEmpty a) -&gt; Map k (NonEmpty a)
</span><a href="Elara.Rename.State.html#insertMerging"><span class="hs-identifier hs-var">insertMerging</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621680215135"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarName -&gt; VarRef VarName
forall name. name -&gt; VarRef name
</span><a href="#local-6989586621680215087"><span class="hs-identifier hs-var">global</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621680215135"><span class="hs-identifier hs-var">vn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>        </span><span class="annot"><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-type">NTypeName</span></a></span><span> </span><span id="local-6989586621680215140"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215140"><span class="hs-identifier hs-var">vn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RenameState -&gt; RenameState) -&gt; Eff r ()
forall s (es :: [(* -&gt; *) -&gt; * -&gt; *]).
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; s) -&gt; Eff es ()
</span><span class="hs-identifier hs-var">Eff.modify</span></span><span> </span><span class="annot"><span class="annottext">((RenameState -&gt; RenameState) -&gt; Eff r ())
-&gt; (RenameState -&gt; RenameState) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens '[] RenameState (Map TypeName (NonEmpty (VarRef TypeName)))
-&gt; (Map TypeName (NonEmpty (VarRef TypeName))
    -&gt; Map TypeName (NonEmpty (VarRef TypeName)))
-&gt; RenameState
-&gt; RenameState
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (sel :: k) s t a b. HasAny sel s t a b =&gt; Lens s t a b
forall (sel :: Symbol) s t a b. HasAny sel s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;typeNames&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Map TypeName (NonEmpty (VarRef TypeName))
  -&gt; Map TypeName (NonEmpty (VarRef TypeName)))
 -&gt; RenameState -&gt; RenameState)
-&gt; (Map TypeName (NonEmpty (VarRef TypeName))
    -&gt; Map TypeName (NonEmpty (VarRef TypeName)))
-&gt; RenameState
-&gt; RenameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName
-&gt; VarRef TypeName
-&gt; Map TypeName (NonEmpty (VarRef TypeName))
-&gt; Map TypeName (NonEmpty (VarRef TypeName))
forall k a.
(Ord k, Eq a) =&gt;
k -&gt; a -&gt; Map k (NonEmpty a) -&gt; Map k (NonEmpty a)
</span><a href="Elara.Rename.State.html#insertMerging"><span class="hs-identifier hs-var">insertMerging</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215140"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; VarRef TypeName
forall name. name -&gt; VarRef name
</span><a href="#local-6989586621680215087"><span class="hs-identifier hs-var">global</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215140"><span class="hs-identifier hs-var">vn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Eff r ()
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(HasCallStack, StructuredDebug :&gt; r) =&gt;
Doc AnsiStyle -&gt; Eff r ()
</span><a href="Elara.Logging.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span> </span><span class="annot"><span class="annottext">(Doc AnsiStyle -&gt; Eff r ()) -&gt; Doc AnsiStyle -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Added declaration to context: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Declaration Desugared -&gt; Text
forall a. Pretty a =&gt; a -&gt; Text
</span><a href="Print.html#showPretty"><span class="hs-identifier hs-var">showPretty</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215086"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215086"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
-&gt; Optic'
     A_Lens '[] (Declaration Desugared) (DeclarationBody' Desugared)
-&gt; DeclarationBody' Desugared
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Declaration' Desugared))
     (Located (Declaration' Desugared))
     (Declaration' Desugared)
     (Declaration' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     (Declaration' Desugared)
     (Declaration' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
  (Declaration' Desugared)
  (Declaration' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Declaration' Desugared)
  (Declaration' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration' Desugared)
     (Declaration' Desugared)
     (DeclarationBody Desugared)
     (DeclarationBody Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     (DeclarationBody Desugared)
     (DeclarationBody Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s t a b.
HasField field s t a b =&gt;
Lens s t a b
</span><span class="hs-identifier hs-var">field</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;body&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (DeclarationBody Desugared)
  (DeclarationBody Desugared)
-&gt; Optic
     An_Iso
     '[]
     (DeclarationBody Desugared)
     (DeclarationBody Desugared)
     (Located (DeclarationBody' Desugared))
     (Located (DeclarationBody' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     (Located (DeclarationBody' Desugared))
     (Located (DeclarationBody' Desugared))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  An_Iso
  '[]
  (DeclarationBody Desugared)
  (DeclarationBody Desugared)
  (Located (DeclarationBody' Desugared))
  (Located (DeclarationBody' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (DeclarationBody' Desugared))
  (Located (DeclarationBody' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (DeclarationBody' Desugared))
     (Located (DeclarationBody' Desugared))
     (DeclarationBody' Desugared)
     (DeclarationBody' Desugared)
-&gt; Optic'
     A_Lens '[] (Declaration Desugared) (DeclarationBody' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (DeclarationBody' Desugared))
  (Located (DeclarationBody' Desugared))
  (DeclarationBody' Desugared)
  (DeclarationBody' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-279"></span><span>        </span><span class="hs-comment">-- Add all the constructor names to field' context</span><span>
</span><span id="line-280"></span><span>        </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeDeclaration"><span class="hs-identifier hs-type">TypeDeclaration</span></a></span><span> </span><span class="annot"><span class="annottext">ASTLocate Desugared (Select (ASTName ForType) Desugared)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ASTLocate Desugared (Select ASTTypeVar Desugared)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ADT"><span class="hs-identifier hs-type">ADT</span></a></span><span> </span><span id="local-6989586621680215145"><span class="annot"><span class="annottext">NonEmpty
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
</span><a href="#local-6989586621680215145"><span class="hs-identifier hs-var">ctors</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeDeclAnnotations Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="annottext">Optic'
  A_Traversal
  (WithIx Int)
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  TypeName
-&gt; (TypeName -&gt; Eff r ())
-&gt; NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared])
-&gt; Eff r ()
forall k (f :: * -&gt; *) (is :: IxList) s a r.
(Is k A_Fold, Applicative f) =&gt;
Optic' k is s a -&gt; (a -&gt; f r) -&gt; s -&gt; f ()
</span><span class="hs-identifier hs-var">traverseOf_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IxTraversal
  Int
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (Located TypeName, [DesugaredType])
  (Located TypeName, [DesugaredType])
forall i s t a b. Each i s t a b =&gt; IxTraversal i s t a b
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">IxTraversal
  Int
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (Located TypeName, [DesugaredType])
  (Located TypeName, [DesugaredType])
-&gt; Optic
     A_Lens
     '[]
     (Located TypeName, [DesugaredType])
     (Located TypeName, [DesugaredType])
     (Located TypeName)
     (Located TypeName)
-&gt; Optic
     A_Traversal
     (WithIx Int)
     (NonEmpty
        (CleanupLocated
           (ASTLocate' Desugared (Select ConstructorName Desugared)),
         [Select ADTParam Desugared]))
     (NonEmpty
        (CleanupLocated
           (ASTLocate' Desugared (Select ConstructorName Desugared)),
         [Select ADTParam Desugared]))
     (Located TypeName)
     (Located TypeName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located TypeName, [DesugaredType])
  (Located TypeName, [DesugaredType])
  (Located TypeName)
  (Located TypeName)
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Traversal
  (WithIx Int)
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (Located TypeName)
  (Located TypeName)
-&gt; Optic
     A_Lens '[] (Located TypeName) (Located TypeName) TypeName TypeName
-&gt; Optic'
     A_Traversal
     (WithIx Int)
     (NonEmpty
        (CleanupLocated
           (ASTLocate' Desugared (Select ConstructorName Desugared)),
         [Select ADTParam Desugared]))
     TypeName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens '[] (Located TypeName) (Located TypeName) TypeName TypeName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680215147"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215147"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(RenameState -&gt; RenameState) -&gt; Eff r ()
forall s (es :: [(* -&gt; *) -&gt; * -&gt; *]).
(HasCallStack, State s :&gt; es) =&gt;
(s -&gt; s) -&gt; Eff es ()
</span><span class="hs-identifier hs-var">Eff.modify</span></span><span> </span><span class="annot"><span class="annottext">((RenameState -&gt; RenameState) -&gt; Eff r ())
-&gt; (RenameState -&gt; RenameState) -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens '[] RenameState (Map TypeName (NonEmpty (VarRef TypeName)))
-&gt; (Map TypeName (NonEmpty (VarRef TypeName))
    -&gt; Map TypeName (NonEmpty (VarRef TypeName)))
-&gt; RenameState
-&gt; RenameState
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (sel :: k) s t a b. HasAny sel s t a b =&gt; Lens s t a b
forall (sel :: Symbol) s t a b. HasAny sel s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;typeNames&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Map TypeName (NonEmpty (VarRef TypeName))
  -&gt; Map TypeName (NonEmpty (VarRef TypeName)))
 -&gt; RenameState -&gt; RenameState)
-&gt; (Map TypeName (NonEmpty (VarRef TypeName))
    -&gt; Map TypeName (NonEmpty (VarRef TypeName)))
-&gt; RenameState
-&gt; RenameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TypeName
-&gt; VarRef TypeName
-&gt; Map TypeName (NonEmpty (VarRef TypeName))
-&gt; Map TypeName (NonEmpty (VarRef TypeName))
forall k a.
(Ord k, Eq a) =&gt;
k -&gt; a -&gt; Map k (NonEmpty a) -&gt; Map k (NonEmpty a)
</span><a href="Elara.Rename.State.html#insertMerging"><span class="hs-identifier hs-var">insertMerging</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215147"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; VarRef TypeName
forall name. name -&gt; VarRef name
</span><a href="#local-6989586621680215087"><span class="hs-identifier hs-var">global</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215147"><span class="hs-identifier hs-var">tn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
</span><a href="#local-6989586621680215145"><span class="hs-identifier hs-var">ctors</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="annot"><span class="annottext">DeclarationBody' Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eff r ()
forall (f :: * -&gt; *). Applicative f =&gt; f ()
</span><span class="hs-identifier hs-var">pass</span></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="annot"><span class="hs-comment">-- | Ensure that a name exists in the context and is exposed</span></span><span>
</span><span id="line-285"></span><span id="local-6989586621680215149"><span class="annot"><a href="Elara.Rename.html#ensureExistsAndExposed"><span class="hs-identifier hs-type">ensureExistsAndExposed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680215149"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680215149"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-286"></span><span id="ensureExistsAndExposed"><span class="annot"><span class="annottext">ensureExistsAndExposed :: Located ModuleName -&gt; Located Name -&gt; Eff r ()
</span><a href="Elara.Rename.html#ensureExistsAndExposed"><span class="hs-identifier hs-var hs-var">ensureExistsAndExposed</span></a></span></span><span> </span><span id="local-6989586621680215201"><span class="annot"><span class="annottext">Located ModuleName
</span><a href="#local-6989586621680215201"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span id="local-6989586621680215202"><span class="annot"><span class="annottext">Located Name
</span><a href="#local-6989586621680215202"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-287"></span><span>    </span><span id="local-6989586621680215203"><span class="annot"><a href="#local-6989586621680215203"><span class="hs-identifier hs-var">thisMod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eff r (Maybe (Module Desugared))
forall r (es :: [(* -&gt; *) -&gt; * -&gt; *]).
(HasCallStack, Reader r :&gt; es) =&gt;
Eff es r
</span><span class="hs-identifier hs-var">Eff.ask</span></span><span>
</span><span id="line-288"></span><span>    </span><span id="local-6989586621680215204"><span class="annot"><a href="#local-6989586621680215204"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#getModuleFromName"><span class="hs-identifier hs-type">getModuleFromName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215201"><span class="hs-identifier hs-type">mn</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#elementExistsInModule"><span class="hs-identifier hs-type">elementExistsInModule</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680215202"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">throwError</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.Rename.Error.html#NonExistentModuleDeclaration"><span class="hs-identifier hs-type">NonExistentModuleDeclaration</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680215201"><span class="hs-identifier hs-type">mn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680215202"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">unless</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#isExposingAndExists"><span class="hs-identifier hs-type">isExposingAndExists</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215204"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680215202"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">throwError</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.Rename.Error.html#UnknownName"><span class="hs-identifier hs-type">UnknownName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215202"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215203"><span class="hs-identifier hs-type">thisMod</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">mempty</span></span><span>
</span><span id="line-291"></span><span>
</span><span id="line-292"></span><span class="annot"><a href="Elara.Rename.html#elementExistsInModule"><span class="hs-identifier hs-type">elementExistsInModule</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-293"></span><span id="elementExistsInModule"><span class="annot"><span class="annottext">elementExistsInModule :: Module Desugared -&gt; Name -&gt; Bool
</span><a href="Elara.Rename.html#elementExistsInModule"><span class="hs-identifier hs-var hs-var">elementExistsInModule</span></a></span></span><span> </span><span id="local-6989586621680215341"><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215341"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span id="local-6989586621680215342"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680215342"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">(Declaration Desugared -&gt; Bool) -&gt; [Declaration Desugared] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span>
</span><span id="line-295"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680215344"><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215344"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-296"></span><span>            </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215344"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
-&gt; Optic
     A_Getter
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     Name
     Name
-&gt; Name
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located Name)
  (Located Name)
Getter
  (Declaration Desugared)
  (CleanupLocated (ASTLocate' Desugared Name))
forall {a} (ast :: a).
(CleanupLocated (Located (Select (ASTName ForType) ast))
 ~ Located (Select (ASTName ForType) ast),
 CleanupLocated (Located (Select (ASTName ForValueDecl) ast))
 ~ Located (Select (ASTName ForValueDecl) ast),
 RUnlocate ast, ToName (Select (ASTName ForValueDecl) ast),
 ToName (Select (ASTName ForType) ast)) =&gt;
Getter (Declaration ast) (CleanupLocated (ASTLocate' ast Name))
</span><a href="Elara.AST.Generic.Types.html#declarationName"><span class="hs-identifier hs-var">declarationName</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Getter
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located Name)
  (Located Name)
-&gt; Optic A_Lens '[] (Located Name) (Located Name) Name Name
-&gt; Optic
     A_Getter
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     Name
     Name
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens '[] (Located Name) (Located Name) Name Name
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680215342"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-297"></span><span>                </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215344"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
-&gt; Optic'
     A_Lens '[] (Declaration Desugared) (DeclarationBody' Desugared)
-&gt; DeclarationBody' Desugared
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Declaration' Desugared))
     (Located (Declaration' Desugared))
     (Declaration' Desugared)
     (Declaration' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     (Declaration' Desugared)
     (Declaration' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
  (Declaration' Desugared)
  (Declaration' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Declaration' Desugared)
  (Declaration' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration' Desugared)
     (Declaration' Desugared)
     (DeclarationBody Desugared)
     (DeclarationBody Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     (DeclarationBody Desugared)
     (DeclarationBody Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;body&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (DeclarationBody Desugared)
  (DeclarationBody Desugared)
-&gt; Optic
     An_Iso
     '[]
     (DeclarationBody Desugared)
     (DeclarationBody Desugared)
     (Located (DeclarationBody' Desugared))
     (Located (DeclarationBody' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Declaration Desugared)
     (Declaration Desugared)
     (Located (DeclarationBody' Desugared))
     (Located (DeclarationBody' Desugared))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  An_Iso
  '[]
  (DeclarationBody Desugared)
  (DeclarationBody Desugared)
  (Located (DeclarationBody' Desugared))
  (Located (DeclarationBody' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Declaration Desugared)
  (Declaration Desugared)
  (Located (DeclarationBody' Desugared))
  (Located (DeclarationBody' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (DeclarationBody' Desugared))
     (Located (DeclarationBody' Desugared))
     (DeclarationBody' Desugared)
     (DeclarationBody' Desugared)
-&gt; Optic'
     A_Lens '[] (Declaration Desugared) (DeclarationBody' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (DeclarationBody' Desugared))
  (Located (DeclarationBody' Desugared))
  (DeclarationBody' Desugared)
  (DeclarationBody' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-298"></span><span>                    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeDeclaration"><span class="hs-identifier hs-type">TypeDeclaration</span></a></span><span> </span><span class="annot"><span class="annottext">ASTLocate Desugared (Select (ASTName ForType) Desugared)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[ASTLocate Desugared (Select ASTTypeVar Desugared)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ADT"><span class="hs-identifier hs-type">ADT</span></a></span><span> </span><span id="local-6989586621680215346"><span class="annot"><span class="annottext">NonEmpty
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
</span><a href="#local-6989586621680215346"><span class="hs-identifier hs-var">ctors</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TypeDeclAnnotations Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Traversal
  (WithIx Int)
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  TypeName
-&gt; (TypeName -&gt; Bool)
-&gt; NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared])
-&gt; Bool
forall k (is :: IxList) s a.
Is k A_Fold =&gt;
Optic' k is s a -&gt; (a -&gt; Bool) -&gt; s -&gt; Bool
</span><span class="hs-identifier hs-var">anyOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IxTraversal
  Int
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
forall i s t a b. Each i s t a b =&gt; IxTraversal i s t a b
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">IxTraversal
  Int
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
-&gt; Optic
     A_Lens
     '[]
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared])
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared])
     (Located TypeName)
     (Located TypeName)
-&gt; Optic
     A_Traversal
     (WithIx Int)
     (NonEmpty
        (CleanupLocated
           (ASTLocate' Desugared (Select ConstructorName Desugared)),
         [Select ADTParam Desugared]))
     (NonEmpty
        (CleanupLocated
           (ASTLocate' Desugared (Select ConstructorName Desugared)),
         [Select ADTParam Desugared]))
     (Located TypeName)
     (Located TypeName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
  (Located TypeName)
  (Located TypeName)
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Traversal
  (WithIx Int)
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (NonEmpty
     (CleanupLocated
        (ASTLocate' Desugared (Select ConstructorName Desugared)),
      [Select ADTParam Desugared]))
  (Located TypeName)
  (Located TypeName)
-&gt; Optic
     A_Lens '[] (Located TypeName) (Located TypeName) TypeName TypeName
-&gt; Optic'
     A_Traversal
     (WithIx Int)
     (NonEmpty
        (CleanupLocated
           (ASTLocate' Desugared (Select ConstructorName Desugared)),
         [Select ADTParam Desugared]))
     TypeName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens '[] (Located TypeName) (Located TypeName) TypeName TypeName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680215347"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215347"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Name
</span><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-var">NTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215347"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680215342"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
</span><a href="#local-6989586621680215346"><span class="hs-identifier hs-var">ctors</span></a></span><span>
</span><span id="line-299"></span><span>                    </span><span class="annot"><span class="annottext">DeclarationBody' Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215341"><span class="hs-identifier hs-var">m'</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) [Declaration Desugared]
-&gt; [Declaration Desugared]
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Lens
     (Module' Desugared)
     (Module' Desugared)
     [Declaration Desugared]
     [Declaration Desugared]
-&gt; Optic' A_Lens '[] (Module Desugared) [Declaration Desugared]
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;declarations&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="annot"><span class="hs-comment">{- | Tests that n is exposed in m
I.e. that it is in the exposing list, or that the module is exposing everything
-}</span></span><span>
</span><span id="line-306"></span><span class="annot"><a href="Elara.Rename.html#isExposingAndExists"><span class="hs-identifier hs-type">isExposingAndExists</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-307"></span><span id="isExposingAndExists"><span class="annot"><span class="annottext">isExposingAndExists :: Module Desugared -&gt; Name -&gt; Bool
</span><a href="Elara.Rename.html#isExposingAndExists"><span class="hs-identifier hs-var hs-var">isExposingAndExists</span></a></span></span><span> </span><span id="local-6989586621680215433"><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215433"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680215434"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680215434"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-308"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680215435"><span class="annot"><span class="annottext">mn :: ModuleName
</span><a href="#local-6989586621680215435"><span class="hs-identifier hs-var hs-var">mn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215433"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module' Desugared)
     (Module' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-309"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215433"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) (Exposing Desugared)
-&gt; Exposing Desugared
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic' A_Lens '[] (Module' Desugared) (Exposing Desugared)
-&gt; Optic' A_Lens '[] (Module Desugared) (Exposing Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;exposing&quot;</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-310"></span><span>            </span><span class="annot"><span class="annottext">Exposing Desugared
</span><a href="Elara.AST.Module.html#ExposingAll"><span class="hs-identifier hs-var">ExposingAll</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Module Desugared -&gt; Name -&gt; Bool
</span><a href="Elara.Rename.html#elementExistsInModule"><span class="hs-identifier hs-var">elementExistsInModule</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215433"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680215434"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-311"></span><span>            </span><span class="annot"><a href="Elara.AST.Module.html#ExposingSome"><span class="hs-identifier hs-type">ExposingSome</span></a></span><span> </span><span id="local-6989586621680215436"><span class="annot"><span class="annottext">[Exposition Desugared]
</span><a href="#local-6989586621680215436"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Module Desugared -&gt; Name -&gt; Bool
</span><a href="Elara.Rename.html#elementExistsInModule"><span class="hs-identifier hs-var">elementExistsInModule</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215433"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680215434"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">(Exposition Desugared -&gt; Bool) -&gt; [Exposition Desugared] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; Exposition Desugared -&gt; Bool
</span><a href="#local-6989586621680215438"><span class="hs-identifier hs-var">isExposition</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680215435"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680215434"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exposition Desugared]
</span><a href="#local-6989586621680215436"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="#local-6989586621680215438"><span class="hs-identifier hs-type">isExposition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Exposition"><span class="hs-identifier hs-type">Exposition</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-314"></span><span>    </span><span id="local-6989586621680215438"><span class="annot"><span class="annottext">isExposition :: ModuleName -&gt; Name -&gt; Exposition Desugared -&gt; Bool
</span><a href="#local-6989586621680215438"><span class="hs-identifier hs-var hs-var">isExposition</span></a></span></span><span> </span><span id="local-6989586621680215439"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680215439"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NVarName"><span class="hs-identifier hs-type">NVarName</span></a></span><span> </span><span id="local-6989586621680215440"><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621680215440"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedValue"><span class="hs-identifier hs-type">ExposedValue</span></a></span><span> </span><span id="local-6989586621680215441"><span class="annot"><span class="annottext">FullASTQual Desugared VarName
</span><a href="#local-6989586621680215441"><span class="hs-identifier hs-var">vn'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarName -&gt; Maybe ModuleName -&gt; MaybeQualified VarName
forall name. name -&gt; Maybe ModuleName -&gt; MaybeQualified name
</span><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-var">MaybeQualified</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621680215440"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Maybe ModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680215439"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaybeQualified VarName -&gt; MaybeQualified VarName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
FullASTQual Desugared VarName
</span><a href="#local-6989586621680215441"><span class="hs-identifier hs-var">vn'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
-&gt; Optic'
     A_Lens
     '[]
     (Located (MaybeQualified VarName))
     (MaybeQualified VarName)
-&gt; MaybeQualified VarName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  '[]
  (Located (MaybeQualified VarName))
  (MaybeQualified VarName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="#local-6989586621680215438"><span class="hs-identifier hs-var">isExposition</span></a></span><span> </span><span id="local-6989586621680215442"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680215442"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-type">NTypeName</span></a></span><span> </span><span id="local-6989586621680215443"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215443"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedType"><span class="hs-identifier hs-type">ExposedType</span></a></span><span> </span><span id="local-6989586621680215444"><span class="annot"><span class="annottext">FullASTQual Desugared TypeName
</span><a href="#local-6989586621680215444"><span class="hs-identifier hs-var">tn'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Maybe ModuleName -&gt; MaybeQualified TypeName
forall name. name -&gt; Maybe ModuleName -&gt; MaybeQualified name
</span><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-var">MaybeQualified</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215443"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Maybe ModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680215442"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaybeQualified TypeName -&gt; MaybeQualified TypeName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
FullASTQual Desugared TypeName
</span><a href="#local-6989586621680215444"><span class="hs-identifier hs-var">tn'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Optic'
     A_Lens
     '[]
     (Located (MaybeQualified TypeName))
     (MaybeQualified TypeName)
-&gt; MaybeQualified TypeName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  '[]
  (Located (MaybeQualified TypeName))
  (MaybeQualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="#local-6989586621680215438"><span class="hs-identifier hs-var">isExposition</span></a></span><span> </span><span id="local-6989586621680215445"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680215445"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-type">NTypeName</span></a></span><span> </span><span id="local-6989586621680215446"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215446"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedTypeAndAllConstructors"><span class="hs-identifier hs-type">ExposedTypeAndAllConstructors</span></a></span><span> </span><span id="local-6989586621680215447"><span class="annot"><span class="annottext">FullASTQual Desugared TypeName
</span><a href="#local-6989586621680215447"><span class="hs-identifier hs-var">tn'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Maybe ModuleName -&gt; MaybeQualified TypeName
forall name. name -&gt; Maybe ModuleName -&gt; MaybeQualified name
</span><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-var">MaybeQualified</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680215446"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Maybe ModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680215445"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaybeQualified TypeName -&gt; MaybeQualified TypeName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
FullASTQual Desugared TypeName
</span><a href="#local-6989586621680215447"><span class="hs-identifier hs-var">tn'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Optic'
     A_Lens
     '[]
     (Located (MaybeQualified TypeName))
     (MaybeQualified TypeName)
-&gt; MaybeQualified TypeName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  '[]
  (Located (MaybeQualified TypeName))
  (MaybeQualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="#local-6989586621680215438"><span class="hs-identifier hs-var">isExposition</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exposition Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span id="local-6989586621680212787"><span class="annot"><a href="Elara.Rename.html#renameDeclaration"><span class="hs-identifier hs-type">renameDeclaration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680212787"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680212787"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680212787"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedDeclaration"><span class="hs-identifier hs-type">RenamedDeclaration</span></a></span></span><span>
</span><span id="line-320"></span><span id="renameDeclaration"><span class="annot"><span class="annottext">renameDeclaration :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Declaration Desugared -&gt; Eff r RenamedDeclaration
</span><a href="Elara.Rename.html#renameDeclaration"><span class="hs-identifier hs-var hs-var">renameDeclaration</span></a></span></span><span> </span><span id="local-6989586621680215464"><span class="annot"><span class="annottext">decl :: Declaration Desugared
</span><a href="#local-6989586621680215464"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Declaration"><span class="hs-identifier hs-type">Declaration</span></a></span><span> </span><span id="local-6989586621680215466"><span class="annot"><span class="annottext">ASTLocate Desugared (Declaration' Desugared)
</span><a href="#local-6989586621680215466"><span class="hs-identifier hs-var">ld</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (Declaration' Renamed) -&gt; RenamedDeclaration
ASTLocate Renamed (Declaration' Renamed) -&gt; RenamedDeclaration
forall {a} (ast :: a).
ASTLocate ast (Declaration' ast) -&gt; Declaration ast
</span><a href="Elara.AST.Generic.Types.html#Declaration"><span class="hs-identifier hs-var">Declaration</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (Declaration' Renamed) -&gt; RenamedDeclaration)
-&gt; Eff r (Located (Declaration' Renamed))
-&gt; Eff r RenamedDeclaration
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Declaration' Desugared))
  (Located (Declaration' Renamed))
  (Declaration' Desugared)
  (Declaration' Renamed)
-&gt; (Declaration' Desugared -&gt; Eff r (Declaration' Renamed))
-&gt; Located (Declaration' Desugared)
-&gt; Eff r (Located (Declaration' Renamed))
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Declaration' Desugared))
  (Located (Declaration' Renamed))
  (Declaration' Desugared)
  (Declaration' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration' Desugared -&gt; Eff r (Declaration' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Declaration' Desugared -&gt; Eff r (Declaration' Renamed)
</span><a href="#local-6989586621680215467"><span class="hs-identifier hs-var">renameDeclaration'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Declaration' Desugared)
ASTLocate Desugared (Declaration' Desugared)
</span><a href="#local-6989586621680215466"><span class="hs-identifier hs-var">ld</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621680213060"><span class="annot"><a href="#local-6989586621680215467"><span class="hs-identifier hs-type">renameDeclaration'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213060"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213060"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration%27"><span class="hs-identifier hs-type">DesugaredDeclaration'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213060"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedDeclaration%27"><span class="hs-identifier hs-type">RenamedDeclaration'</span></a></span></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621680215467"><span class="annot"><span class="annottext">renameDeclaration' :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Declaration' Desugared -&gt; Eff r (Declaration' Renamed)
</span><a href="#local-6989586621680215467"><span class="hs-identifier hs-var hs-var">renameDeclaration'</span></a></span></span><span> </span><span id="local-6989586621680215528"><span class="annot"><span class="annottext">Declaration' Desugared
</span><a href="#local-6989586621680215528"><span class="hs-identifier hs-var">fd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>        </span><span id="local-6989586621680215529"><span class="annot"><a href="#local-6989586621680215529"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe (Declaration Desugared)
-&gt; Eff
     (Reader (Maybe (Declaration Desugared)) : r) RenamedDeclarationBody
-&gt; Eff r RenamedDeclarationBody
forall r (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
HasCallStack =&gt;
r -&gt; Eff (Reader r : es) a -&gt; Eff es a
</span><span class="hs-identifier hs-var">Eff.runReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Declaration Desugared -&gt; Maybe (Declaration Desugared)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Declaration Desugared
</span><a href="#local-6989586621680215464"><span class="hs-identifier hs-var">decl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Eff
   (Reader (Maybe (Declaration Desugared)) : r) RenamedDeclarationBody
 -&gt; Eff r RenamedDeclarationBody)
-&gt; Eff
     (Reader (Maybe (Declaration Desugared)) : r) RenamedDeclarationBody
-&gt; Eff r RenamedDeclarationBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DeclarationBody Desugared
-&gt; Eff
     (Reader (Maybe (Declaration Desugared)) : r) RenamedDeclarationBody
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r,
 Reader (Maybe (Declaration Desugared)) :&gt; r) =&gt;
DeclarationBody Desugared -&gt; Eff r RenamedDeclarationBody
</span><a href="#local-6989586621680215530"><span class="hs-identifier hs-var">renameDeclarationBody</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Declaration' Desugared
</span><a href="#local-6989586621680215528"><span class="hs-identifier hs-var">fd</span></a></span><span> </span><span class="annot"><span class="annottext">Declaration' Desugared
-&gt; Optic
     A_Lens
     '[]
     (Declaration' Desugared)
     (Declaration' Desugared)
     (DeclarationBody Desugared)
     (DeclarationBody Desugared)
-&gt; DeclarationBody Desugared
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;body&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Declaration%27"><span class="hs-identifier hs-type">Declaration'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680215528"><span class="hs-identifier hs-type">fd</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;moduleName&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680215529"><span class="hs-identifier hs-type">body'</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span>    </span><span id="local-6989586621680213063"><span class="annot"><a href="#local-6989586621680215530"><span class="hs-identifier hs-type">renameDeclarationBody</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213063"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213063"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213063"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclarationBody"><span class="hs-identifier hs-type">DesugaredDeclarationBody</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213063"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedDeclarationBody"><span class="hs-identifier hs-type">RenamedDeclarationBody</span></a></span></span><span>
</span><span id="line-329"></span><span>    </span><span id="local-6989586621680215530"><span class="annot"><span class="annottext">renameDeclarationBody :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r,
 Reader (Maybe (Declaration Desugared)) :&gt; r) =&gt;
DeclarationBody Desugared -&gt; Eff r RenamedDeclarationBody
</span><a href="#local-6989586621680215530"><span class="hs-identifier hs-var hs-var">renameDeclarationBody</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#DeclarationBody"><span class="hs-identifier hs-type">DeclarationBody</span></a></span><span> </span><span id="local-6989586621680215552"><span class="annot"><span class="annottext">ASTLocate Desugared (DeclarationBody' Desugared)
</span><a href="#local-6989586621680215552"><span class="hs-identifier hs-var">ldb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (DeclarationBody' Renamed) -&gt; RenamedDeclarationBody
ASTLocate Renamed (DeclarationBody' Renamed)
-&gt; RenamedDeclarationBody
forall a (ast :: a).
ASTLocate ast (DeclarationBody' ast) -&gt; DeclarationBody ast
</span><a href="Elara.AST.Generic.Types.html#DeclarationBody"><span class="hs-identifier hs-var">DeclarationBody</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (DeclarationBody' Renamed) -&gt; RenamedDeclarationBody)
-&gt; Eff r (Located (DeclarationBody' Renamed))
-&gt; Eff r RenamedDeclarationBody
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (DeclarationBody' Desugared))
  (Located (DeclarationBody' Renamed))
  (DeclarationBody' Desugared)
  (DeclarationBody' Renamed)
-&gt; (DeclarationBody' Desugared -&gt; Eff r (DeclarationBody' Renamed))
-&gt; Located (DeclarationBody' Desugared)
-&gt; Eff r (Located (DeclarationBody' Renamed))
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (DeclarationBody' Desugared))
  (Located (DeclarationBody' Renamed))
  (DeclarationBody' Desugared)
  (DeclarationBody' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">DeclarationBody' Desugared -&gt; Eff r (DeclarationBody' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r,
 Reader (Maybe (Declaration Desugared)) :&gt; r) =&gt;
DeclarationBody' Desugared -&gt; Eff r (DeclarationBody' Renamed)
</span><a href="#local-6989586621680215553"><span class="hs-identifier hs-var">renameDeclarationBody'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (DeclarationBody' Desugared)
ASTLocate Desugared (DeclarationBody' Desugared)
</span><a href="#local-6989586621680215552"><span class="hs-identifier hs-var">ldb</span></a></span><span>
</span><span id="line-330"></span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621680213069"><span class="annot"><a href="#local-6989586621680215553"><span class="hs-identifier hs-type">renameDeclarationBody'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213069"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213069"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213069"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclarationBody%27"><span class="hs-identifier hs-type">DesugaredDeclarationBody'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213069"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedDeclarationBody%27"><span class="hs-identifier hs-type">RenamedDeclarationBody'</span></a></span></span><span>
</span><span id="line-332"></span><span>    </span><span id="local-6989586621680215553"><span class="annot"><span class="annottext">renameDeclarationBody' :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r,
 Reader (Maybe (Declaration Desugared)) :&gt; r) =&gt;
DeclarationBody' Desugared -&gt; Eff r (DeclarationBody' Renamed)
</span><a href="#local-6989586621680215553"><span class="hs-identifier hs-var hs-var">renameDeclarationBody'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span id="local-6989586621680215780"><span class="annot"><span class="annottext">ASTLocate Desugared (Select (ASTName ForValueDecl) Desugared)
</span><a href="#local-6989586621680215780"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680215781"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680215781"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="annot"><span class="annottext">Select (Patterns ForValueDecl) Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680215782"><span class="annot"><span class="annottext">Select (ASTType ForValueDecl) Desugared
</span><a href="#local-6989586621680215782"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680215783"><span class="annot"><span class="annottext">ValueDeclAnnotations Desugared
</span><a href="#local-6989586621680215783"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eff r (DeclarationBody' Renamed)
-&gt; Eff r (DeclarationBody' Renamed)
forall s (r :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(State s :&gt; r) =&gt;
Eff r a -&gt; Eff r a
</span><a href="Effectful.State.Extra.html#scoped"><span class="hs-identifier hs-var">scoped</span></a></span><span> </span><span class="annot"><span class="annottext">(Eff r (DeclarationBody' Renamed)
 -&gt; Eff r (DeclarationBody' Renamed))
-&gt; Eff r (DeclarationBody' Renamed)
-&gt; Eff r (DeclarationBody' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-333"></span><span>        </span><span id="local-6989586621680215785"><span class="annot"><a href="#local-6989586621680215785"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(DesugaredType -&gt; Eff r RenamedType)
-&gt; Maybe DesugaredType -&gt; Eff r (Maybe RenamedType)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe DesugaredType
Select (ASTType ForValueDecl) Desugared
</span><a href="#local-6989586621680215782"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-334"></span><span>        </span><span id="local-6989586621680215787"><span class="annot"><a href="#local-6989586621680215787"><span class="hs-identifier hs-var">val'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215781"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-335"></span><span>        </span><span id="local-6989586621680215788"><span class="annot"><a href="#local-6989586621680215788"><span class="hs-identifier hs-var">ann'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#traverseValueDeclAnnotations"><span class="hs-identifier hs-type">traverseValueDeclAnnotations</span></a></span><span> </span><span class="annot"><a href="Elara.Rename.html#renameAnnotation"><span class="hs-identifier hs-type">renameAnnotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215783"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-336"></span><span>        </span><span id="local-6989586621680215791"><span class="annot"><a href="#local-6989586621680215791"><span class="hs-identifier hs-var">thisModule</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#askCurrentModule"><span class="hs-identifier hs-type">askCurrentModule</span></a></span><span>
</span><span id="line-337"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680215792"><span class="annot"><a href="#local-6989586621680215792"><span class="hs-identifier hs-var hs-var">qualifiedName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-338"></span><span>                </span><span class="annot"><span class="annottext">Qualified (Located VarName) -&gt; Located (Qualified VarName)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
Qualified (f a) -&gt; f (Qualified a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span> </span><span class="annot"><span class="annottext">(Qualified (Located VarName) -&gt; Located (Qualified VarName))
-&gt; Qualified (Located VarName) -&gt; Located (Qualified VarName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-339"></span><span>                    </span><span class="annot"><span class="annottext">Located VarName -&gt; ModuleName -&gt; Qualified (Located VarName)
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-var">Qualified</span></a></span><span> </span><span class="annot"><span class="annottext">Located VarName
ASTLocate Desugared (Select (ASTName ForValueDecl) Desugared)
</span><a href="#local-6989586621680215780"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215791"><span class="hs-identifier hs-var">thisModule</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module' Desugared)
     (Module' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Value"><span class="hs-identifier hs-type">Value</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215792"><span class="hs-identifier hs-type">qualifiedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215787"><span class="hs-identifier hs-type">val'</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Common.html#NoFieldValue"><span class="hs-identifier hs-type">NoFieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215785"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215788"><span class="hs-identifier hs-type">ann'</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="annot"><a href="#local-6989586621680215553"><span class="hs-identifier hs-var">renameDeclarationBody'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeDeclaration"><span class="hs-identifier hs-type">TypeDeclaration</span></a></span><span> </span><span id="local-6989586621680215795"><span class="annot"><span class="annottext">ASTLocate Desugared (Select (ASTName ForType) Desugared)
</span><a href="#local-6989586621680215795"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680215796"><span class="annot"><span class="annottext">[ASTLocate Desugared (Select ASTTypeVar Desugared)]
</span><a href="#local-6989586621680215796"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span id="local-6989586621680215797"><span class="annot"><span class="annottext">ASTLocate Desugared (TypeDeclaration Desugared)
</span><a href="#local-6989586621680215797"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621680215798"><span class="annot"><span class="annottext">TypeDeclAnnotations Desugared
</span><a href="#local-6989586621680215798"><span class="hs-identifier hs-var">ann</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-342"></span><span>        </span><span id="local-6989586621680215799"><span class="annot"><a href="#local-6989586621680215799"><span class="hs-identifier hs-var">vars'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Located LowerAlphaName -&gt; Eff r (Located (Unique LowerAlphaName)))
-&gt; [Located LowerAlphaName]
-&gt; Eff r [Located (Unique LowerAlphaName)]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Located LowerAlphaName -&gt; Eff r (Located (Unique LowerAlphaName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r) =&gt;
Located name -&gt; Eff r (Located (Unique name))
</span><a href="Elara.Rename.html#uniquify"><span class="hs-identifier hs-var">uniquify</span></a></span><span> </span><span class="annot"><span class="annottext">[Located LowerAlphaName]
[ASTLocate Desugared (Select ASTTypeVar Desugared)]
</span><a href="#local-6989586621680215796"><span class="hs-identifier hs-var">vars</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680215800"><span class="annot"><a href="#local-6989586621680215800"><span class="hs-identifier hs-var hs-var">varAliases</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Located LowerAlphaName]
-&gt; [Located (Unique LowerAlphaName)]
-&gt; [(Located LowerAlphaName, Located (Unique LowerAlphaName))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Located LowerAlphaName]
[ASTLocate Desugared (Select ASTTypeVar Desugared)]
</span><a href="#local-6989586621680215796"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[Located (Unique LowerAlphaName)]
</span><a href="#local-6989586621680215799"><span class="hs-identifier hs-var">vars'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier hs-type">LowerAlphaName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier hs-type">LowerAlphaName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680215801"><span class="annot"><a href="#local-6989586621680215801"><span class="hs-identifier hs-var hs-var">addAllVarAliases</span></a></span></span><span> </span><span id="local-6989586621680215802"><span class="annot"><span class="annottext">RenameState
</span><a href="#local-6989586621680215802"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-345"></span><span>                </span><span class="annot"><span class="annottext">(RenameState
 -&gt; (Located LowerAlphaName, Located (Unique LowerAlphaName))
 -&gt; RenameState)
-&gt; RenameState
-&gt; [(Located LowerAlphaName, Located (Unique LowerAlphaName))]
-&gt; RenameState
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span>
</span><span id="line-346"></span><span>                    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621680215804"><span class="annot"><span class="annottext">RenameState
</span><a href="#local-6989586621680215804"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680215805"><span class="annot"><span class="annottext">Located LowerAlphaName
</span><a href="#local-6989586621680215805"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680215806"><span class="annot"><span class="annottext">Located (Unique LowerAlphaName)
</span><a href="#local-6989586621680215806"><span class="hs-identifier hs-var">uniqueVn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} (sel :: k) s t a b. HasAny sel s t a b =&gt; Lens s t a b
forall (sel :: Symbol) s t a b. HasAny sel s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;typeVars&quot;</span></span><span> </span><span class="annot"><span class="annottext">Lens
  RenameState
  RenameState
  (Map LowerAlphaName (Unique LowerAlphaName))
  (Map LowerAlphaName (Unique LowerAlphaName))
-&gt; (Map LowerAlphaName (Unique LowerAlphaName)
    -&gt; Map LowerAlphaName (Unique LowerAlphaName))
-&gt; RenameState
-&gt; RenameState
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-operator hs-var">%~</span></span><span> </span><span class="annot"><span class="annottext">LowerAlphaName
-&gt; Unique LowerAlphaName
-&gt; Map LowerAlphaName (Unique LowerAlphaName)
-&gt; Map LowerAlphaName (Unique LowerAlphaName)
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located LowerAlphaName
</span><a href="#local-6989586621680215805"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="annot"><span class="annottext">Located LowerAlphaName
-&gt; Optic' A_Lens '[] (Located LowerAlphaName) LowerAlphaName
-&gt; LowerAlphaName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] (Located LowerAlphaName) LowerAlphaName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (Unique LowerAlphaName)
</span><a href="#local-6989586621680215806"><span class="hs-identifier hs-var">uniqueVn</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Unique LowerAlphaName)
-&gt; Optic'
     A_Lens
     '[]
     (Located (Unique LowerAlphaName))
     (Unique LowerAlphaName)
-&gt; Unique LowerAlphaName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  '[]
  (Located (Unique LowerAlphaName))
  (Unique LowerAlphaName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(RenameState -&gt; RenameState) -&gt; RenameState -&gt; RenameState
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RenameState
</span><a href="#local-6989586621680215804"><span class="hs-identifier hs-var">s'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>                    </span><span class="annot"><span class="annottext">RenameState
</span><a href="#local-6989586621680215802"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-348"></span><span>                    </span><span class="annot"><span class="annottext">[(Located LowerAlphaName, Located (Unique LowerAlphaName))]
</span><a href="#local-6989586621680215800"><span class="hs-identifier hs-var">varAliases</span></a></span><span>
</span><span id="line-349"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680215809"><span class="annot"><a href="#local-6989586621680215809"><span class="hs-identifier hs-var hs-var">declModuleName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (Declaration' Desugared)
ASTLocate Desugared (Declaration' Desugared)
</span><a href="#local-6989586621680215466"><span class="hs-identifier hs-var">ld</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Declaration' Desugared)
-&gt; Optic' A_Lens '[] (Located (Declaration' Desugared)) ModuleName
-&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
  (Declaration' Desugared)
  (Declaration' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
  (Declaration' Desugared)
  (Declaration' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Declaration' Desugared)
     (Declaration' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located (Declaration' Desugared))
     (Located (Declaration' Desugared))
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;moduleName&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Declaration' Desugared))
  (Located (Declaration' Desugared))
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Located (Declaration' Desugared)) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-350"></span><span>        </span><span class="annot"><a href="Effectful.State.Extra.html#locally"><span class="hs-identifier hs-type">locally</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215801"><span class="hs-identifier hs-type">addAllVarAliases</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-351"></span><span>            </span><span id="local-6989586621680215811"><span class="annot"><a href="#local-6989586621680215811"><span class="hs-identifier hs-var">thisModule</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#askCurrentModule"><span class="hs-identifier hs-type">askCurrentModule</span></a></span><span>
</span><span id="line-352"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680215812"><span class="annot"><a href="#local-6989586621680215812"><span class="hs-identifier hs-var hs-var">qualifiedName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-353"></span><span>                    </span><span class="annot"><span class="annottext">Qualified (Located TypeName) -&gt; Located (Qualified TypeName)
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Traversable t, Applicative f) =&gt;
t (f a) -&gt; f (t a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
Qualified (f a) -&gt; f (Qualified a)
</span><span class="hs-identifier hs-var">sequenceA</span></span><span> </span><span class="annot"><span class="annottext">(Qualified (Located TypeName) -&gt; Located (Qualified TypeName))
-&gt; Qualified (Located TypeName) -&gt; Located (Qualified TypeName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-354"></span><span>                        </span><span class="annot"><span class="annottext">Located TypeName -&gt; ModuleName -&gt; Qualified (Located TypeName)
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-var">Qualified</span></a></span><span> </span><span class="annot"><span class="annottext">Located TypeName
ASTLocate Desugared (Select (ASTName ForType) Desugared)
</span><a href="#local-6989586621680215795"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680215811"><span class="hs-identifier hs-var">thisModule</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module' Desugared)
     (Module' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>            </span><span id="local-6989586621680215813"><span class="annot"><a href="#local-6989586621680215813"><span class="hs-identifier hs-var">ty'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverseOf</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#renameTypeDeclaration"><span class="hs-identifier hs-type">renameTypeDeclaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215809"><span class="hs-identifier hs-type">declModuleName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215812"><span class="hs-identifier hs-type">qualifiedName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680215797"><span class="hs-identifier hs-type">ty</span></a></span><span>
</span><span id="line-356"></span><span>            </span><span id="local-6989586621680215815"><span class="annot"><a href="#local-6989586621680215815"><span class="hs-identifier hs-var">ann'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameTypeDeclAnnotations"><span class="hs-identifier hs-type">renameTypeDeclAnnotations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215798"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-357"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeDeclaration"><span class="hs-identifier hs-type">TypeDeclaration</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215812"><span class="hs-identifier hs-type">qualifiedName</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215799"><span class="hs-identifier hs-type">vars'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215813"><span class="hs-identifier hs-type">ty'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215815"><span class="hs-identifier hs-type">ann'</span></a></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span id="local-6989586621680213105"><span class="annot"><a href="Elara.Rename.html#renameTypeDeclAnnotations"><span class="hs-identifier hs-type">renameTypeDeclAnnotations</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213105"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213105"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213105"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeDeclAnnotations"><span class="hs-identifier hs-type">TypeDeclAnnotations</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213105"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeDeclAnnotations"><span class="hs-identifier hs-type">TypeDeclAnnotations</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-362"></span><span id="renameTypeDeclAnnotations"><span class="annot"><span class="annottext">renameTypeDeclAnnotations :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
TypeDeclAnnotations Desugared
-&gt; Eff r (TypeDeclAnnotations Renamed)
</span><a href="Elara.Rename.html#renameTypeDeclAnnotations"><span class="hs-identifier hs-var hs-var">renameTypeDeclAnnotations</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeDeclAnnotations"><span class="hs-identifier hs-type">TypeDeclAnnotations</span></a></span><span> </span><span id="local-6989586621680215836"><span class="annot"><span class="annottext">Select KindAnnotation Desugared
</span><a href="#local-6989586621680215836"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621680215837"><span class="annot"><span class="annottext">Select (Annotations ForTypeDecl) Desugared
</span><a href="#local-6989586621680215837"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><span class="annottext">Select KindAnnotation Renamed
-&gt; Select (Annotations ForTypeDecl) Renamed
-&gt; TypeDeclAnnotations Renamed
forall {a} (ast :: a).
Select KindAnnotation ast
-&gt; Select (Annotations ForTypeDecl) ast -&gt; TypeDeclAnnotations ast
</span><a href="Elara.AST.Generic.Types.html#TypeDeclAnnotations"><span class="hs-identifier hs-var">TypeDeclAnnotations</span></a></span><span> </span><span class="annot"><span class="annottext">Select KindAnnotation Desugared
Select KindAnnotation Renamed
</span><a href="#local-6989586621680215836"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="annottext">([Annotation Renamed] -&gt; TypeDeclAnnotations Renamed)
-&gt; Eff r [Annotation Renamed]
-&gt; Eff r (TypeDeclAnnotations Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Annotation Desugared -&gt; Eff r (Annotation Renamed))
-&gt; [Annotation Desugared] -&gt; Eff r [Annotation Renamed]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Annotation Desugared -&gt; Eff r (Annotation Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Annotation Desugared -&gt; Eff r (Annotation Renamed)
</span><a href="Elara.Rename.html#renameAnnotation"><span class="hs-identifier hs-var">renameAnnotation</span></a></span><span> </span><span class="annot"><span class="annottext">[Annotation Desugared]
Select (Annotations ForTypeDecl) Desugared
</span><a href="#local-6989586621680215837"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span id="local-6989586621680213088"><span class="annot"><a href="Elara.Rename.html#renameAnnotation"><span class="hs-identifier hs-type">renameAnnotation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213088"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213088"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213088"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213088"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-367"></span><span id="renameAnnotation"><span class="annot"><span class="annottext">renameAnnotation :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Annotation Desugared -&gt; Eff r (Annotation Renamed)
</span><a href="Elara.Rename.html#renameAnnotation"><span class="hs-identifier hs-var hs-var">renameAnnotation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a></span><span> </span><span id="local-6989586621680215887"><span class="annot"><span class="annottext">ASTLocate Desugared (Select AnnotationName Desugared)
</span><a href="#local-6989586621680215887"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621680215888"><span class="annot"><span class="annottext">[AnnotationArg Desugared]
</span><a href="#local-6989586621680215888"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-368"></span><span>    </span><span id="local-6989586621680215889"><span class="annot"><a href="#local-6989586621680215889"><span class="hs-identifier hs-var">name'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#qualifyTypeName"><span class="hs-identifier hs-var">qualifyTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
ASTLocate Desugared (Select AnnotationName Desugared)
</span><a href="#local-6989586621680215887"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-369"></span><span>    </span><span id="local-6989586621680215890"><span class="annot"><a href="#local-6989586621680215890"><span class="hs-identifier hs-var">args'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">each</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215888"><span class="hs-identifier hs-type">args</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Annotation"><span class="hs-identifier hs-type">Annotation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215889"><span class="hs-identifier hs-type">name'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680215890"><span class="hs-identifier hs-type">args'</span></a></span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span id="local-6989586621680215891"><span class="annot"><a href="Elara.Rename.html#renameTypeDeclaration"><span class="hs-identifier hs-type">renameTypeDeclaration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredTypeDeclaration"><span class="hs-identifier hs-type">DesugaredTypeDeclaration</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680215891"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedTypeDeclaration"><span class="hs-identifier hs-type">RenamedTypeDeclaration</span></a></span></span><span>
</span><span id="line-373"></span><span id="renameTypeDeclaration"><span class="annot"><span class="annottext">renameTypeDeclaration :: ModuleName
-&gt; Located (Qualified TypeName)
-&gt; TypeDeclaration Desugared
-&gt; Eff r RenamedTypeDeclaration
</span><a href="Elara.Rename.html#renameTypeDeclaration"><span class="hs-identifier hs-var hs-var">renameTypeDeclaration</span></a></span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680216014"><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680216014"><span class="hs-identifier hs-var">declarationName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Alias"><span class="hs-identifier hs-type">Alias</span></a></span><span> </span><span id="local-6989586621680216016"><span class="annot"><span class="annottext">Select Alias Desugared
</span><a href="#local-6989586621680216016"><span class="hs-identifier hs-var">aliasedType</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-374"></span><span>    </span><span id="local-6989586621680216017"><span class="annot"><a href="#local-6989586621680216017"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DesugaredType
Select Alias Desugared
</span><a href="#local-6989586621680216016"><span class="hs-identifier hs-var">aliasedType</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216018"><span class="annot"><a href="#local-6989586621680216018"><span class="hs-identifier hs-var hs-var">isRecursive</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; RenamedType -&gt; Maybe (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-var">typeIsRecursive</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680216014"><span class="hs-identifier hs-var">declarationName</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Optic'
     A_Lens '[] (Located (Qualified TypeName)) (Qualified TypeName)
-&gt; Qualified TypeName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens '[] (Located (Qualified TypeName)) (Qualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680216017"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">whenJust</span></span><span> </span><span class="annot"><a href="#local-6989586621680216018"><span class="hs-identifier hs-type">isRecursive</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621680216021"><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680216021"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Eff r ()
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(HasCallStack, StructuredDebug :&gt; r) =&gt;
Doc AnsiStyle -&gt; Eff r ()
</span><a href="Elara.Logging.html#logDebug"><span class="hs-identifier hs-var">logDebug</span></a></span><span>
</span><span id="line-378"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot;Detected recursive type alias: &quot;</span></span><span>
</span><span id="line-379"></span><span>                </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">FilePath -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (Qualified TypeName) -&gt; FilePath
forall a s. (Show a, IsString s) =&gt; a -&gt; s
</span><a href="Print.html#showColored"><span class="hs-identifier hs-var">showColored</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680216021"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>                </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Doc AnsiStyle
</span><span class="hs-string">&quot; at &quot;</span></span><span>
</span><span id="line-381"></span><span>                </span><span class="annot"><span class="annottext">Doc AnsiStyle -&gt; Doc AnsiStyle -&gt; Doc AnsiStyle
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">SourceRegion -&gt; Doc AnsiStyle
forall a. Pretty a =&gt; a -&gt; Doc AnsiStyle
</span><a href="Elara.Data.Pretty.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680216021"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Optic' A_Lens '[] (Located (Qualified TypeName)) SourceRegion
-&gt; SourceRegion
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] (Located (Qualified TypeName)) SourceRegion
forall a. HasSourceRegion a =&gt; Lens' a SourceRegion
</span><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier hs-var">sourceRegion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r ()
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r ()) -&gt; RenameError -&gt; Eff r ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Located (Qualified TypeName) -&gt; RenameError
</span><a href="Elara.Rename.Error.html#RecursiveTypeAlias"><span class="hs-identifier hs-var">RecursiveTypeAlias</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680216014"><span class="hs-identifier hs-var">declarationName</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680216021"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-384"></span><span>
</span><span id="line-385"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Alias"><span class="hs-identifier hs-type">Alias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216017"><span class="hs-identifier hs-type">t'</span></a></span><span>
</span><span id="line-386"></span><span class="annot"><a href="Elara.Rename.html#renameTypeDeclaration"><span class="hs-identifier hs-var">renameTypeDeclaration</span></a></span><span> </span><span id="local-6989586621680216023"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680216023"><span class="hs-identifier hs-var">thisMod</span></a></span></span><span> </span><span id="local-6989586621680216024"><span class="annot"><span class="annottext">Located (Qualified TypeName)
</span><a href="#local-6989586621680216024"><span class="hs-identifier hs-var">_declarationName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ADT"><span class="hs-identifier hs-type">ADT</span></a></span><span> </span><span id="local-6989586621680216025"><span class="annot"><span class="annottext">NonEmpty
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
</span><a href="#local-6989586621680216025"><span class="hs-identifier hs-var">constructors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>    </span><span id="local-6989586621680216026"><span class="annot"><a href="#local-6989586621680216026"><span class="hs-identifier hs-var">constructors'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><span class="annottext">((Located TypeName, [DesugaredType])
 -&gt; Eff r (Located (Qualified TypeName), [RenamedType]))
-&gt; NonEmpty (Located TypeName, [DesugaredType])
-&gt; Eff r (NonEmpty (Located (Qualified TypeName), [RenamedType]))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span>
</span><span id="line-389"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621680216027"><span class="annot"><span class="annottext">Located TypeName
</span><a href="#local-6989586621680216027"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680216028"><span class="annot"><span class="annottext">[DesugaredType]
</span><a href="#local-6989586621680216028"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located TypeName)
  (Located (Qualified TypeName))
  TypeName
  (Qualified TypeName)
-&gt; (TypeName -&gt; Qualified TypeName)
-&gt; Located TypeName
-&gt; Located (Qualified TypeName)
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located TypeName)
  (Located (Qualified TypeName))
  TypeName
  (Qualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; ModuleName -&gt; Qualified TypeName
forall name. name -&gt; ModuleName -&gt; Qualified name
</span><a href="Elara.AST.Name.html#Qualified"><span class="hs-operator hs-var">`Qualified`</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680216023"><span class="hs-identifier hs-var">thisMod</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Located TypeName
</span><a href="#local-6989586621680216027"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([RenamedType] -&gt; (Located (Qualified TypeName), [RenamedType]))
-&gt; Eff r [RenamedType]
-&gt; Eff r (Located (Qualified TypeName), [RenamedType])
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Traversal
  (WithIx Int)
  [DesugaredType]
  [RenamedType]
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; [DesugaredType]
-&gt; Eff r [RenamedType]
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IxTraversal
  Int [DesugaredType] [RenamedType] DesugaredType RenamedType
forall i s t a b. Each i s t a b =&gt; IxTraversal i s t a b
</span><span class="hs-identifier hs-var">each</span></span><span> </span><span class="annot"><span class="annottext">IxTraversal
  Int [DesugaredType] [RenamedType] DesugaredType RenamedType
-&gt; Iso
     DesugaredType
     RenamedType
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Traversal
     (WithIx Int)
     [DesugaredType]
     [RenamedType]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Traversal
  (WithIx Int)
  [DesugaredType]
  [RenamedType]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Traversal
     (WithIx Int)
     [DesugaredType]
     [RenamedType]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Traversal
  (WithIx Int)
  [DesugaredType]
  [RenamedType]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Traversal
     (WithIx Int)
     [DesugaredType]
     [RenamedType]
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DesugaredType]
</span><a href="#local-6989586621680216028"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>            </span><span class="annot"><span class="annottext">NonEmpty (Located TypeName, [DesugaredType])
NonEmpty
  (CleanupLocated
     (ASTLocate' Desugared (Select ConstructorName Desugared)),
   [Select ADTParam Desugared])
</span><a href="#local-6989586621680216025"><span class="hs-identifier hs-var">constructors</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ADT"><span class="hs-identifier hs-type">ADT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216026"><span class="hs-identifier hs-type">constructors'</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621680216029"><span class="annot"><a href="Elara.Rename.html#renameSimpleType"><span class="hs-identifier hs-type">renameSimpleType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredType"><span class="hs-identifier hs-type">DesugaredType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680216029"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedType"><span class="hs-identifier hs-type">RenamedType</span></a></span></span><span>
</span><span id="line-394"></span><span id="renameSimpleType"><span class="annot"><span class="annottext">renameSimpleType :: DesugaredType -&gt; Eff r RenamedType
</span><a href="Elara.Rename.html#renameSimpleType"><span class="hs-identifier hs-var hs-var">renameSimpleType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="annot"><span class="hs-comment">-- | Renames a type, qualifying type constructors and type variables where necessary</span></span><span>
</span><span id="line-397"></span><span id="local-6989586621680213079"><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-type">renameType</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213079"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213079"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-399"></span><span>    </span><span class="annot"><span class="hs-comment">{- | If new type variables are allowed - if 'False', this will throw an error if a type variable is not in scope.
    This is useful for type declarations, where something like @type Invalid a = b@ would clearly be invalid
    But for local type annotations, we want to allow this, as it may be valid to have new type variables there - eg @\x -&gt; (x : a)@
    -}</span></span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredType%27"><span class="hs-identifier hs-type">DesugaredType'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213079"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedType%27"><span class="hs-identifier hs-type">RenamedType'</span></a></span></span><span>
</span><span id="line-406"></span><span id="renameType"><span class="annot"><span class="annottext">renameType :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var hs-var">renameType</span></a></span></span><span> </span><span id="local-6989586621680216407"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216407"><span class="hs-identifier hs-var">allowNewTypeVars</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680216409"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216409"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621680216410"><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680216410"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>    </span><span id="local-6989586621680216411"><span class="annot"><a href="#local-6989586621680216411"><span class="hs-identifier hs-var">inCtx</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LowerAlphaName -&gt; Eff r (Maybe (Unique LowerAlphaName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) {a}.
(State a :&gt; r,
 HasField'
   &quot;typeVars&quot; a (Map LowerAlphaName (Unique LowerAlphaName))) =&gt;
LowerAlphaName -&gt; Eff r (Maybe (Unique LowerAlphaName))
</span><a href="Elara.Rename.html#lookupTypeVar"><span class="hs-identifier hs-var">lookupTypeVar</span></a></span><span> </span><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680216410"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-comment">-- find field' type variable in the context, if it exists</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621680216411"><span class="hs-identifier hs-type">inCtx</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680216412"><span class="annot"><span class="annottext">Unique LowerAlphaName
</span><a href="#local-6989586621680216412"><span class="hs-identifier hs-var">inCtx'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type' Renamed -&gt; Eff r (Type' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Type' Renamed -&gt; Eff r (Type' Renamed))
-&gt; Type' Renamed -&gt; Eff r (Type' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASTLocate Renamed (Select ASTTypeVar Renamed) -&gt; Type' Renamed
forall {a} (ast :: a).
ASTLocate ast (Select ASTTypeVar ast) -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#TypeVar"><span class="hs-identifier hs-var">TypeVar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion
-&gt; Unique LowerAlphaName -&gt; Located (Unique LowerAlphaName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216409"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Unique LowerAlphaName
</span><a href="#local-6989586621680216412"><span class="hs-identifier hs-var">inCtx'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- if it exists, use the unique name</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Unique LowerAlphaName)
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-411"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216407"><span class="hs-identifier hs-var">allowNewTypeVars</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-412"></span><span>                </span><span class="hs-comment">-- if it doesn't exist, and we're allowed to make new type variables</span><span>
</span><span id="line-413"></span><span>                </span><span id="local-6989586621680216413"><span class="annot"><a href="#local-6989586621680216413"><span class="hs-identifier hs-var">uniqueN</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">LowerAlphaName -&gt; Eff r (Unique LowerAlphaName)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(UniqueGen :&gt; r) =&gt;
a -&gt; Eff r (Unique a)
</span><a href="Elara.Data.Unique.Effect.html#makeUnique"><span class="hs-identifier hs-var">makeUnique</span></a></span><span> </span><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680216410"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="hs-comment">-- make a new unique name</span><span>
</span><span id="line-414"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">Eff.modify</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">over</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;typeVars&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.insert</span></span><span> </span><span class="annot"><a href="#local-6989586621680216410"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216413"><span class="hs-identifier hs-type">uniqueN</span></a></span><span> </span><span class="hs-comment">-- add it to the context</span><span>
</span><span id="line-415"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216409"><span class="hs-identifier hs-type">sr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216413"><span class="hs-identifier hs-type">uniqueN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">RenameError -&gt; Eff r (Type' Renamed)
forall e (es :: [(* -&gt; *) -&gt; * -&gt; *]) a.
(HasCallStack, Error e :&gt; es, Show e) =&gt;
e -&gt; Eff es a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(RenameError -&gt; Eff r (Type' Renamed))
-&gt; RenameError -&gt; Eff r (Type' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">LowerAlphaName -&gt; RenameError
</span><a href="Elara.Rename.Error.html#UnknownTypeVariable"><span class="hs-identifier hs-var">UnknownTypeVariable</span></a></span><span> </span><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680216410"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-417"></span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span id="local-6989586621680216415"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216415"><span class="hs-identifier hs-var">antv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionType"><span class="hs-identifier hs-type">FunctionType</span></a></span><span> </span><span id="local-6989586621680216417"><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216417"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680216418"><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216418"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedType -&gt; RenamedType -&gt; Type' Renamed
forall {a} (ast :: a). Type ast -&gt; Type ast -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#FunctionType"><span class="hs-identifier hs-var">FunctionType</span></a></span><span> </span><span class="annot"><span class="annottext">(RenamedType -&gt; RenamedType -&gt; Type' Renamed)
-&gt; Eff r RenamedType -&gt; Eff r (RenamedType -&gt; Type' Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216415"><span class="hs-identifier hs-var">antv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216417"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Eff r (RenamedType -&gt; Type' Renamed)
-&gt; Eff r RenamedType -&gt; Eff r (Type' Renamed)
forall a b. Eff r (a -&gt; b) -&gt; Eff r a -&gt; Eff r b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216415"><span class="hs-identifier hs-var">antv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216418"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-418"></span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#UnitType"><span class="hs-identifier hs-type">UnitType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680216420"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216420"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-comment">-- turn it into Elara.Prim.()</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216421"><span class="annot"><span class="annottext">unitTypeName :: Qualified TypeName
</span><a href="#local-6989586621680216421"><span class="hs-identifier hs-var hs-var">unitTypeName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Qualified TypeName
forall c. c -&gt; Qualified c
</span><a href="Elara.Prim.html#mkPrimQual"><span class="hs-identifier hs-var">mkPrimQual</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="Elara.Prim.html#unitName"><span class="hs-identifier hs-var">unitName</span></a></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="annottext">Type' Renamed -&gt; Eff r (Type' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Type' Renamed -&gt; Eff r (Type' Renamed))
-&gt; Type' Renamed -&gt; Eff r (Type' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASTLocate Renamed (Select UserDefinedType Renamed) -&gt; Type' Renamed
forall {a} (ast :: a).
ASTLocate ast (Select UserDefinedType ast) -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-var">UserDefinedType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216420"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680216421"><span class="hs-identifier hs-var">unitTypeName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span id="local-6989586621680216423"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216423"><span class="hs-identifier hs-var">antv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-type">TypeConstructorApplication</span></a></span><span> </span><span id="local-6989586621680216425"><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216425"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621680216426"><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216426"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedType -&gt; RenamedType -&gt; Type' Renamed
forall {a} (ast :: a). Type ast -&gt; Type ast -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-var">TypeConstructorApplication</span></a></span><span> </span><span class="annot"><span class="annottext">(RenamedType -&gt; RenamedType -&gt; Type' Renamed)
-&gt; Eff r RenamedType -&gt; Eff r (RenamedType -&gt; Type' Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216423"><span class="hs-identifier hs-var">antv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216425"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">Eff r (RenamedType -&gt; Type' Renamed)
-&gt; Eff r RenamedType -&gt; Eff r (Type' Renamed)
forall a b. Eff r (a -&gt; b) -&gt; Eff r a -&gt; Eff r b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216423"><span class="hs-identifier hs-var">antv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216426"><span class="hs-identifier hs-var">t2</span></a></span><span>
</span><span id="line-424"></span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-type">UserDefinedType</span></a></span><span> </span><span id="local-6989586621680216427"><span class="annot"><span class="annottext">ASTLocate Desugared (Select UserDefinedType Desugared)
</span><a href="#local-6989586621680216427"><span class="hs-identifier hs-var">ln</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName) -&gt; Type' Renamed
ASTLocate Renamed (Select UserDefinedType Renamed) -&gt; Type' Renamed
forall {a} (ast :: a).
ASTLocate ast (Select UserDefinedType ast) -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-var">UserDefinedType</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (Qualified TypeName) -&gt; Type' Renamed)
-&gt; Eff r (Located (Qualified TypeName)) -&gt; Eff r (Type' Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#qualifyTypeName"><span class="hs-identifier hs-var">qualifyTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
ASTLocate Desugared (Select UserDefinedType Desugared)
</span><a href="#local-6989586621680216427"><span class="hs-identifier hs-var">ln</span></a></span><span>
</span><span id="line-425"></span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span id="local-6989586621680216428"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216428"><span class="hs-identifier hs-var">antv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#RecordType"><span class="hs-identifier hs-type">RecordType</span></a></span><span> </span><span id="local-6989586621680216430"><span class="annot"><span class="annottext">NonEmpty (ASTLocate Desugared LowerAlphaName, DesugaredType)
</span><a href="#local-6989586621680216430"><span class="hs-identifier hs-var">ln</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located LowerAlphaName, RenamedType) -&gt; Type' Renamed
NonEmpty (ASTLocate Renamed LowerAlphaName, RenamedType)
-&gt; Type' Renamed
forall {a} (ast :: a).
NonEmpty (ASTLocate ast LowerAlphaName, Type ast) -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#RecordType"><span class="hs-identifier hs-var">RecordType</span></a></span><span> </span><span class="annot"><span class="annottext">(NonEmpty (Located LowerAlphaName, RenamedType) -&gt; Type' Renamed)
-&gt; Eff r (NonEmpty (Located LowerAlphaName, RenamedType))
-&gt; Eff r (Type' Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">((Located LowerAlphaName, DesugaredType)
 -&gt; Eff r (Located LowerAlphaName, RenamedType))
-&gt; NonEmpty (Located LowerAlphaName, DesugaredType)
-&gt; Eff r (NonEmpty (Located LowerAlphaName, RenamedType))
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located LowerAlphaName, DesugaredType)
  (Located LowerAlphaName, RenamedType)
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; (Located LowerAlphaName, DesugaredType)
-&gt; Eff r (Located LowerAlphaName, RenamedType)
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens
  (Located LowerAlphaName, DesugaredType)
  (Located LowerAlphaName, RenamedType)
  DesugaredType
  RenamedType
forall s t a b. Field2 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_2</span></span><span> </span><span class="annot"><span class="annottext">Lens
  (Located LowerAlphaName, DesugaredType)
  (Located LowerAlphaName, RenamedType)
  DesugaredType
  RenamedType
-&gt; Iso
     DesugaredType
     RenamedType
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located LowerAlphaName, DesugaredType)
     (Located LowerAlphaName, RenamedType)
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located LowerAlphaName, DesugaredType)
  (Located LowerAlphaName, RenamedType)
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located LowerAlphaName, DesugaredType)
     (Located LowerAlphaName, RenamedType)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located LowerAlphaName, DesugaredType)
  (Located LowerAlphaName, RenamedType)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     (Located LowerAlphaName, DesugaredType)
     (Located LowerAlphaName, RenamedType)
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216428"><span class="hs-identifier hs-var">antv</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located LowerAlphaName, DesugaredType)
NonEmpty (ASTLocate Desugared LowerAlphaName, DesugaredType)
</span><a href="#local-6989586621680216430"><span class="hs-identifier hs-var">ln</span></a></span><span>
</span><span id="line-426"></span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span id="local-6989586621680216432"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216432"><span class="hs-identifier hs-var">antv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TupleType"><span class="hs-identifier hs-type">TupleType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.AtLeast2List.html#AtLeast2List"><span class="hs-identifier hs-type">AtLeast2List</span></a></span><span> </span><span id="local-6989586621680216434"><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216434"><span class="hs-identifier hs-var">fst</span></a></span></span><span> </span><span id="local-6989586621680216435"><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216435"><span class="hs-identifier hs-var">snd</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-comment">-- turn it into Elara.Prim.Tuple2 type</span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621680216436"><span class="annot"><a href="#local-6989586621680216436"><span class="hs-identifier hs-var">fst'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216432"><span class="hs-identifier hs-var">antv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216434"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621680216437"><span class="annot"><a href="#local-6989586621680216437"><span class="hs-identifier hs-var">snd'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-type">renameType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216432"><span class="hs-identifier hs-type">antv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680216435"><span class="hs-identifier hs-type">snd</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216440"><span class="annot"><a href="#local-6989586621680216440"><span class="hs-identifier hs-var hs-var">tupleCtorName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TypeName
</span><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-var">TypeName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TypeName) -&gt; Qualified Text -&gt; Qualified TypeName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified Text
</span><a href="Elara.Prim.Core.html#tuple2CtorName"><span class="hs-identifier hs-var">tuple2CtorName</span></a></span><span> </span><span class="hs-comment">-- TODO: get the source region right</span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216441"><span class="annot"><a href="#local-6989586621680216441"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; SourceRegion -&gt; SourceRegion -&gt; SourceRegion
SourceRegion -&gt; SourceRegion -&gt; SourceRegion
</span><a href="Elara.AST.Region.html#enclosingRegion%27"><span class="hs-identifier hs-var">enclosingRegion'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216434"><span class="hs-identifier hs-var">fst</span></a></span><span> </span><span class="annot"><span class="annottext">DesugaredType
-&gt; Optic' A_Lens '[] DesugaredType SourceRegion -&gt; SourceRegion
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  DesugaredType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Desugared), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  DesugaredType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Desugared), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Desugared))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     DesugaredType
     (Located (Type' Desugared))
     (Located (Type' Desugared))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Desugared))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  DesugaredType
  (Located (Type' Desugared))
  (Located (Type' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Desugared))
     SourceRegion
     SourceRegion
-&gt; Optic' A_Lens '[] DesugaredType SourceRegion
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Desugared))
  SourceRegion
  SourceRegion
forall a. HasSourceRegion a =&gt; Lens' a SourceRegion
</span><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier hs-var">sourceRegion</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216435"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">DesugaredType
-&gt; Optic' A_Lens '[] DesugaredType SourceRegion -&gt; SourceRegion
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  DesugaredType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Desugared), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  DesugaredType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Desugared), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Desugared))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     DesugaredType
     (Located (Type' Desugared))
     (Located (Type' Desugared))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Desugared))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  DesugaredType
  (Located (Type' Desugared))
  (Located (Type' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Desugared))
     SourceRegion
     SourceRegion
-&gt; Optic' A_Lens '[] DesugaredType SourceRegion
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Desugared))
  SourceRegion
  SourceRegion
forall a. HasSourceRegion a =&gt; Lens' a SourceRegion
</span><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier hs-var">sourceRegion</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216442"><span class="annot"><a href="#local-6989586621680216442"><span class="hs-identifier hs-var hs-var">tupleCtor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {a} (ast :: a).
(ASTLocate ast (Type' ast), Select TypeKind ast) -&gt; Type ast
forall (ast :: LocatedAST).
(ASTLocate ast (Type' ast), Select TypeKind ast) -&gt; Type ast
</span><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-var">Type</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Type' Renamed -&gt; Located (Type' Renamed)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216441"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTLocate Renamed (Select UserDefinedType Renamed) -&gt; Type' Renamed
forall {a} (ast :: a).
ASTLocate ast (Select UserDefinedType ast) -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-var">UserDefinedType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216441"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680216440"><span class="hs-identifier hs-var">tupleCtorName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NoFieldValue
Select TypeKind Renamed
</span><a href="Elara.AST.Generic.Common.html#NoFieldValue"><span class="hs-identifier hs-var">NoFieldValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216444"><span class="annot"><a href="#local-6989586621680216444"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedType -&gt; RenamedType -&gt; Type' Renamed
forall {a} (ast :: a). Type ast -&gt; Type ast -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-var">TypeConstructorApplication</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680216442"><span class="hs-identifier hs-var">tupleCtor</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680216436"><span class="hs-identifier hs-var">fst'</span></a></span><span>
</span><span id="line-434"></span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-type">TypeConstructorApplication</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216441"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216444"><span class="hs-identifier hs-type">base</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Common.html#NoFieldValue"><span class="hs-identifier hs-type">NoFieldValue</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680216437"><span class="hs-identifier hs-type">snd'</span></a></span><span>
</span><span id="line-436"></span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TupleType"><span class="hs-identifier hs-type">TupleType</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Eff r (Type' Renamed)
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;renameType: Tuple more than length 2&quot;</span></span><span>
</span><span id="line-437"></span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span id="local-6989586621680216445"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216445"><span class="hs-identifier hs-var">antv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListType"><span class="hs-identifier hs-type">ListType</span></a></span><span> </span><span id="local-6989586621680216447"><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216447"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedType -&gt; Type' Renamed
forall {a} (ast :: a). Type ast -&gt; Type' ast
</span><a href="Elara.AST.Generic.Types.html#ListType"><span class="hs-identifier hs-var">ListType</span></a></span><span> </span><span class="annot"><span class="annottext">(RenamedType -&gt; Type' Renamed)
-&gt; Eff r RenamedType -&gt; Eff r (Type' Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621680216445"><span class="hs-identifier hs-var">antv</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DesugaredType
</span><a href="#local-6989586621680216447"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span id="local-6989586621680213081"><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213081"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213081"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213081"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredExpr"><span class="hs-identifier hs-type">DesugaredExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213081"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedExpr"><span class="hs-identifier hs-type">RenamedExpr</span></a></span></span><span>
</span><span id="line-440"></span><span id="renameExpr"><span class="annot"><span class="annottext">renameExpr :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var hs-var">renameExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr%27"><span class="hs-identifier hs-type">Expr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span id="local-6989586621680216745"><span class="annot"><span class="annottext">NonEmpty (Expr Desugared)
</span><a href="#local-6989586621680216745"><span class="hs-identifier hs-var">es</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Expr Desugared) -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
NonEmpty (Expr Desugared) -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#desugarBlock"><span class="hs-identifier hs-var">desugarBlock</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Expr Desugared)
</span><a href="#local-6989586621680216745"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-441"></span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span id="local-6989586621680216747"><span class="annot"><span class="annottext">e :: Expr Desugared
</span><a href="#local-6989586621680216747"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr%27"><span class="hs-identifier hs-type">Expr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Expr Desugared) -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
NonEmpty (Expr Desugared) -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#desugarBlock"><span class="hs-identifier hs-var">desugarBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216747"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; [Expr Desugared] -&gt; NonEmpty (Expr Desugared)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span id="local-6989586621680216750"><span class="annot"><span class="annottext">le :: (ASTLocate Desugared (Expr' Desugared),
 Select (ASTType ForExpr) Desugared)
</span><a href="#local-6989586621680216750"><span class="hs-identifier hs-var">le</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680216751"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216751"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Expr' Desugared
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Select (ASTType ForExpr) Desugared
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-443"></span><span>    </span><span class="annot"><span class="annottext">(Located (Expr' Renamed), Maybe RenamedType) -&gt; RenamedExpr
(ASTLocate Renamed (Expr' Renamed),
 Select (ASTType ForExpr) Renamed)
-&gt; RenamedExpr
forall a (ast :: a).
(ASTLocate ast (Expr' ast), Select (ASTType ForExpr) ast)
-&gt; Expr ast
</span><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><span class="annottext">((Located (Expr' Renamed), Maybe RenamedType) -&gt; RenamedExpr)
-&gt; Eff r (Located (Expr' Renamed), Maybe RenamedType)
-&gt; Eff r RenamedExpr
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Located (Expr' Desugared) -&gt; Eff r (Located (Expr' Renamed)))
-&gt; (Maybe DesugaredType -&gt; Eff r (Maybe RenamedType))
-&gt; (Located (Expr' Desugared), Maybe DesugaredType)
-&gt; Eff r (Located (Expr' Renamed), Maybe RenamedType)
forall (f :: * -&gt; *) a c b d.
Applicative f =&gt;
(a -&gt; f c) -&gt; (b -&gt; f d) -&gt; (a, b) -&gt; f (c, d)
forall (t :: * -&gt; * -&gt; *) (f :: * -&gt; *) a c b d.
(Bitraversable t, Applicative f) =&gt;
(a -&gt; f c) -&gt; (b -&gt; f d) -&gt; t a b -&gt; f (t c d)
</span><span class="hs-identifier hs-var">bitraverse</span></span><span>
</span><span id="line-445"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Expr' Desugared))
  (Located (Expr' Renamed))
  (Expr' Desugared)
  (Expr' Renamed)
-&gt; (Expr' Desugared -&gt; Eff r (Expr' Renamed))
-&gt; Located (Expr' Desugared)
-&gt; Eff r (Located (Expr' Renamed))
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Expr' Desugared))
  (Located (Expr' Renamed))
  (Expr' Desugared)
  (Expr' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Expr' Desugared -&gt; Eff r (Expr' Renamed)
</span><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DesugaredType -&gt; Eff r RenamedType)
-&gt; Maybe DesugaredType -&gt; Eff r (Maybe RenamedType)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>            </span><span class="annot"><span class="annottext">(Located (Expr' Desugared), Maybe DesugaredType)
(ASTLocate Desugared (Expr' Desugared),
 Select (ASTType ForExpr) Desugared)
</span><a href="#local-6989586621680216750"><span class="hs-identifier hs-var">le</span></a></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-449"></span><span>    </span><span id="local-6989586621680216753"><span class="annot"><span class="annottext">renameExpr' :: Expr' Desugared -&gt; Eff r (Expr' Renamed)
</span><a href="#local-6989586621680216753"><span class="hs-identifier hs-var hs-var">renameExpr'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span id="local-6989586621680216755"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680216755"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Expr' Renamed -&gt; Eff r (Expr' Renamed))
-&gt; Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Expr' Renamed
forall a (ast :: a). Integer -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Int"><span class="hs-identifier hs-var">Int</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680216755"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span> </span><span id="local-6989586621680216757"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680216757"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Expr' Renamed -&gt; Eff r (Expr' Renamed))
-&gt; Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Expr' Renamed
forall a (ast :: a). Double -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Float"><span class="hs-identifier hs-var">Float</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680216757"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span id="local-6989586621680216759"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680216759"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Expr' Renamed -&gt; Eff r (Expr' Renamed))
-&gt; Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Expr' Renamed
forall a (ast :: a). Text -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#String"><span class="hs-identifier hs-var">String</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680216759"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span id="local-6989586621680216761"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680216761"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Expr' Renamed -&gt; Eff r (Expr' Renamed))
-&gt; Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Expr' Renamed
forall a (ast :: a). Char -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Char"><span class="hs-identifier hs-var">Char</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680216761"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr' Desugared
</span><a href="Elara.AST.Generic.Types.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Expr' Renamed
forall a (ast :: a). Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Unit"><span class="hs-identifier hs-var">Unit</span></a></span><span>
</span><span id="line-454"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621680216764"><span class="annot"><span class="annottext">ASTLocate Desugared (Select ASTVarRef Desugared)
</span><a href="#local-6989586621680216764"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (VarRef VarName) -&gt; Expr' Renamed
ASTLocate Renamed (Select ASTVarRef Renamed) -&gt; Expr' Renamed
forall a (ast :: a).
ASTLocate ast (Select ASTVarRef ast) -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (VarRef VarName) -&gt; Expr' Renamed)
-&gt; Eff r (Located (VarRef VarName)) -&gt; Eff r (Expr' Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
-&gt; Eff r (Located (VarRef VarName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(Rock Query :&gt; r, Reader (Maybe (Module Desugared)) :&gt; r,
 State RenameState :&gt; r, Error RenameError :&gt; r,
 Error SomeReportableError :&gt; r,
 DiagnosticWriter (Doc AnsiStyle) :&gt; r, UniqueGen :&gt; r,
 FileSystem :&gt; r, Concurrent :&gt; r, StructuredDebug :&gt; r) =&gt;
Located (MaybeQualified VarName)
-&gt; Eff r (Located (VarRef VarName))
</span><a href="Elara.Rename.html#lookupVarName"><span class="hs-identifier hs-var">lookupVarName</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
ASTLocate Desugared (Select ASTVarRef Desugared)
</span><a href="#local-6989586621680216764"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span> </span><span id="local-6989586621680216766"><span class="annot"><span class="annottext">ASTLocate Desugared (Select ConRef Desugared)
</span><a href="#local-6989586621680216766"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName) -&gt; Expr' Renamed
ASTLocate Renamed (Select ConRef Renamed) -&gt; Expr' Renamed
forall a (ast :: a). ASTLocate ast (Select ConRef ast) -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Constructor"><span class="hs-identifier hs-var">Constructor</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (Qualified TypeName) -&gt; Expr' Renamed)
-&gt; Eff r (Located (Qualified TypeName)) -&gt; Eff r (Expr' Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#lookupTypeName"><span class="hs-identifier hs-var">lookupTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
ASTLocate Desugared (Select ConRef Desugared)
</span><a href="#local-6989586621680216766"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span id="local-6989586621680216768"><span class="annot"><span class="annottext">ASTLocate Desugared (Select LambdaPattern Desugared)
</span><a href="#local-6989586621680216768"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621680216769"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216769"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern Desugared -&gt; Expr Desugared -&gt; Eff r (Expr' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Pattern Desugared -&gt; Expr Desugared -&gt; Eff r (Expr' Renamed)
</span><a href="Elara.Rename.html#renameLambda"><span class="hs-identifier hs-var">renameLambda</span></a></span><span> </span><span class="annot"><span class="annottext">ASTLocate Desugared (Select LambdaPattern Desugared)
Pattern Desugared
</span><a href="#local-6989586621680216768"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216769"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionCall"><span class="hs-identifier hs-type">FunctionCall</span></a></span><span> </span><span id="local-6989586621680216772"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216772"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680216773"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216773"><span class="hs-identifier hs-var">e2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-458"></span><span>        </span><span id="local-6989586621680216774"><span class="annot"><a href="#local-6989586621680216774"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216772"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-459"></span><span>        </span><span id="local-6989586621680216775"><span class="annot"><a href="#local-6989586621680216775"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216773"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-460"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionCall"><span class="hs-identifier hs-type">FunctionCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216774"><span class="hs-identifier hs-type">e1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216775"><span class="hs-identifier hs-type">e2'</span></a></span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeApplication"><span class="hs-identifier hs-type">TypeApplication</span></a></span><span> </span><span id="local-6989586621680216777"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216777"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680216778"><span class="annot"><span class="annottext">Select TypeApplication Desugared
</span><a href="#local-6989586621680216778"><span class="hs-identifier hs-var">t1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-462"></span><span>        </span><span id="local-6989586621680216779"><span class="annot"><a href="#local-6989586621680216779"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216777"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-463"></span><span>        </span><span id="local-6989586621680216780"><span class="annot"><a href="#local-6989586621680216780"><span class="hs-identifier hs-var">t1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-type">renameType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680216778"><span class="hs-identifier hs-type">t1</span></a></span><span>
</span><span id="line-464"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeApplication"><span class="hs-identifier hs-type">TypeApplication</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216779"><span class="hs-identifier hs-type">e1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216780"><span class="hs-identifier hs-type">t1'</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span id="local-6989586621680216782"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216782"><span class="hs-identifier hs-var">e1</span></a></span></span><span> </span><span id="local-6989586621680216783"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216783"><span class="hs-identifier hs-var">e2</span></a></span></span><span> </span><span id="local-6989586621680216784"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216784"><span class="hs-identifier hs-var">e3</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-466"></span><span>        </span><span id="local-6989586621680216785"><span class="annot"><a href="#local-6989586621680216785"><span class="hs-identifier hs-var">e1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216782"><span class="hs-identifier hs-var">e1</span></a></span><span>
</span><span id="line-467"></span><span>        </span><span id="local-6989586621680216786"><span class="annot"><a href="#local-6989586621680216786"><span class="hs-identifier hs-var">e2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216783"><span class="hs-identifier hs-type">e2</span></a></span><span>
</span><span id="line-468"></span><span>        </span><span id="local-6989586621680216787"><span class="annot"><a href="#local-6989586621680216787"><span class="hs-identifier hs-var">e3'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216784"><span class="hs-identifier hs-type">e3</span></a></span><span>
</span><span id="line-469"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#If"><span class="hs-identifier hs-type">If</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216785"><span class="hs-identifier hs-type">e1'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216786"><span class="hs-identifier hs-type">e2'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216787"><span class="hs-identifier hs-type">e3'</span></a></span><span>
</span><span id="line-470"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#BinaryOperator"><span class="hs-identifier hs-type">BinaryOperator</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680216789"><span class="annot"><span class="annottext">BinaryOperator Desugared
</span><a href="#local-6989586621680216789"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680216790"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216790"><span class="hs-identifier hs-var">left</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680216791"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216791"><span class="hs-identifier hs-var">right</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-471"></span><span>        </span><span id="local-6989586621680216792"><span class="annot"><a href="#local-6989586621680216792"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BinaryOperator Desugared -&gt; Eff r RenamedBinaryOperator
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
BinaryOperator Desugared -&gt; Eff r RenamedBinaryOperator
</span><a href="Elara.Rename.html#renameBinaryOperator"><span class="hs-identifier hs-var">renameBinaryOperator</span></a></span><span> </span><span class="annot"><span class="annottext">BinaryOperator Desugared
</span><a href="#local-6989586621680216789"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-472"></span><span>        </span><span id="local-6989586621680216794"><span class="annot"><a href="#local-6989586621680216794"><span class="hs-identifier hs-var">left'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216790"><span class="hs-identifier hs-type">left</span></a></span><span>
</span><span id="line-473"></span><span>        </span><span id="local-6989586621680216795"><span class="annot"><a href="#local-6989586621680216795"><span class="hs-identifier hs-var">right'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216791"><span class="hs-identifier hs-type">right</span></a></span><span>
</span><span id="line-474"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#BinaryOperator"><span class="hs-identifier hs-type">BinaryOperator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680216792"><span class="hs-identifier hs-type">op'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680216794"><span class="hs-identifier hs-type">left'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680216795"><span class="hs-identifier hs-type">right'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Expr' Renamed -&gt; Eff r (Expr' Renamed))
-&gt; Expr' Renamed -&gt; Eff r (Expr' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASTLocate Renamed (Select ConRef Renamed) -&gt; Expr' Renamed
forall a (ast :: a). ASTLocate ast (Select ConRef ast) -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Constructor"><span class="hs-identifier hs-var">Constructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216751"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
forall s. IsString s =&gt; Qualified s
</span><a href="Elara.Prim.Core.html#emptyListCtorName"><span class="hs-identifier hs-var">emptyListCtorName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680216797"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216797"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680216798"><span class="annot"><span class="annottext">[Expr Desugared]
</span><a href="#local-6989586621680216798"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-477"></span><span>        </span><span id="local-6989586621680216799"><span class="annot"><a href="#local-6989586621680216799"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Expr Desugared -&gt; Eff r RenamedExpr)
-&gt; NonEmpty (Expr Desugared) -&gt; Eff r (NonEmpty RenamedExpr)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216797"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; [Expr Desugared] -&gt; NonEmpty (Expr Desugared)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[Expr Desugared]
</span><a href="#local-6989586621680216798"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216800"><span class="annot"><a href="#local-6989586621680216800"><span class="hs-identifier hs-var">lastCons</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">RenamedExpr</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-479"></span><span>                </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Constructor"><span class="hs-identifier hs-type">Constructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216751"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="Elara.Prim.Core.html#emptyListCtorName"><span class="hs-identifier hs-type">emptyListCtorName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-type">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">last</span></span><span> </span><span class="annot"><a href="#local-6989586621680216799"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216801"><span class="annot"><a href="#local-6989586621680216801"><span class="hs-identifier hs-var hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621680216802"><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216802"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680216803"><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216803"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-481"></span><span>                </span><span class="hs-comment">-- create a cons of x and y i.e. (Cons x) y</span><span>
</span><span id="line-482"></span><span>                </span><span class="annot"><span class="annottext">(ASTLocate Renamed (Expr' Renamed),
 Select (ASTType ForExpr) Renamed)
-&gt; RenamedExpr
forall a (ast :: a).
(ASTLocate ast (Expr' ast), Select (ASTType ForExpr) ast)
-&gt; Expr ast
</span><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span>
</span><span id="line-483"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RenamedExpr -&gt; RenamedExpr -&gt; Expr' Renamed
forall a (ast :: a). Expr ast -&gt; Expr ast -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#FunctionCall"><span class="hs-identifier hs-var">FunctionCall</span></a></span><span>
</span><span id="line-484"></span><span>                        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">(ASTLocate Renamed (Expr' Renamed),
 Select (ASTType ForExpr) Renamed)
-&gt; RenamedExpr
forall a (ast :: a).
(ASTLocate ast (Expr' ast), Select (ASTType ForExpr) ast)
-&gt; Expr ast
</span><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span>
</span><span id="line-485"></span><span>                            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">RenamedExpr -&gt; RenamedExpr -&gt; Expr' Renamed
forall a (ast :: a). Expr ast -&gt; Expr ast -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#FunctionCall"><span class="hs-identifier hs-var">FunctionCall</span></a></span><span>
</span><span id="line-486"></span><span>                                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ASTLocate Renamed (Expr' Renamed),
 Select (ASTType ForExpr) Renamed)
-&gt; RenamedExpr
forall a (ast :: a).
(ASTLocate ast (Expr' ast), Select (ASTType ForExpr) ast)
-&gt; Expr ast
</span><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTLocate Renamed (Select ConRef Renamed) -&gt; Expr' Renamed
forall a (ast :: a). ASTLocate ast (Select ConRef ast) -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Constructor"><span class="hs-identifier hs-var">Constructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216751"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
forall s. IsString s =&gt; Qualified s
</span><a href="Elara.Prim.Core.html#consCtorName"><span class="hs-identifier hs-var">consCtorName</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; RenamedExpr -&gt; Located (Expr' Renamed)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216802"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RenamedType
Select (ASTType ForExpr) Renamed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>                                </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216802"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-488"></span><span>                                </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; RenamedExpr -&gt; Located (Expr' Renamed)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216802"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-489"></span><span>                            </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RenamedType
Select (ASTType ForExpr) Renamed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-490"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>                        </span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>                        </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216803"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-493"></span><span>                        </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; RenamedExpr -&gt; Located (Expr' Renamed)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216803"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-494"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RenamedType
Select (ASTType ForExpr) Renamed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-495"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680216804"><span class="hs-identifier hs-type">createConses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedExpr"><span class="hs-identifier hs-type">RenamedExpr</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedExpr"><span class="hs-identifier hs-type">RenamedExpr</span></a></span><span>
</span><span id="line-497"></span><span>            </span><span id="local-6989586621680216804"><span class="annot"><a href="#local-6989586621680216804"><span class="hs-identifier hs-var hs-var">createConses</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216800"><span class="hs-identifier hs-var">lastCons</span></a></span><span>
</span><span id="line-498"></span><span>            </span><span class="annot"><a href="#local-6989586621680216804"><span class="hs-identifier hs-var">createConses</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680216805"><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216805"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680216806"><span class="annot"><span class="annottext">[RenamedExpr]
</span><a href="#local-6989586621680216806"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedExpr -&gt; RenamedExpr -&gt; RenamedExpr
</span><a href="#local-6989586621680216801"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216805"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RenamedExpr] -&gt; RenamedExpr
</span><a href="#local-6989586621680216804"><span class="hs-identifier hs-var">createConses</span></a></span><span> </span><span class="annot"><span class="annottext">[RenamedExpr]
</span><a href="#local-6989586621680216806"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680216804"><span class="hs-identifier hs-type">createConses</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">toList</span></span><span> </span><span class="annot"><a href="#local-6989586621680216799"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#LetIn"><span class="hs-identifier hs-type">LetIn</span></a></span><span> </span><span id="local-6989586621680216809"><span class="annot"><span class="annottext">ASTLocate Desugared (Select LetParamName Desugared)
</span><a href="#local-6989586621680216809"><span class="hs-identifier hs-var">vn</span></a></span></span><span> </span><span class="annot"><span class="annottext">Select LetPattern Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680216810"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216810"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680216811"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216811"><span class="hs-identifier hs-var">body</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-501"></span><span>        </span><span id="local-6989586621680216812"><span class="annot"><a href="#local-6989586621680216812"><span class="hs-identifier hs-var">vn'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located VarName -&gt; Eff r (Located (Unique VarName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r) =&gt;
Located name -&gt; Eff r (Located (Unique name))
</span><a href="Elara.Rename.html#uniquify"><span class="hs-identifier hs-var">uniquify</span></a></span><span> </span><span class="annot"><span class="annottext">Located VarName
ASTLocate Desugared (Select LetParamName Desugared)
</span><a href="#local-6989586621680216809"><span class="hs-identifier hs-var">vn</span></a></span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><a href="Effectful.State.Extra.html#locally"><span class="hs-identifier hs-type">locally</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;varNames&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680216809"><span class="hs-identifier hs-type">vn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">one</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216812"><span class="hs-identifier hs-type">vn'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-503"></span><span>            </span><span id="local-6989586621680216814"><span class="annot"><a href="#local-6989586621680216814"><span class="hs-identifier hs-var">exp'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216810"><span class="hs-identifier hs-type">e</span></a></span><span>
</span><span id="line-504"></span><span>            </span><span id="local-6989586621680216815"><span class="annot"><a href="#local-6989586621680216815"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216811"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-505"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#LetIn"><span class="hs-identifier hs-type">LetIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216812"><span class="hs-identifier hs-type">vn'</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Common.html#NoFieldValue"><span class="hs-identifier hs-type">NoFieldValue</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216814"><span class="hs-identifier hs-type">exp'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216815"><span class="hs-identifier hs-type">body'</span></a></span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span id="local-6989586621680216817"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216817"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621680216818"><span class="annot"><span class="annottext">[(Pattern Desugared, Expr Desugared)]
</span><a href="#local-6989586621680216818"><span class="hs-identifier hs-var">cases</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-507"></span><span>        </span><span id="local-6989586621680216819"><span class="annot"><a href="#local-6989586621680216819"><span class="hs-identifier hs-var">e'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216817"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-508"></span><span>        </span><span id="local-6989586621680216820"><span class="annot"><a href="#local-6989586621680216820"><span class="hs-identifier hs-var">cases'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">bitraverse</span></span><span> </span><span class="annot"><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-type">renamePattern</span></a></span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680216818"><span class="hs-identifier hs-type">cases</span></a></span><span>
</span><span id="line-509"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Match"><span class="hs-identifier hs-type">Match</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216819"><span class="hs-identifier hs-type">e'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216820"><span class="hs-identifier hs-type">cases'</span></a></span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.AtLeast2List.html#AtLeast2List"><span class="hs-identifier hs-type">AtLeast2List</span></a></span><span> </span><span id="local-6989586621680216823"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216823"><span class="hs-identifier hs-var">fst</span></a></span></span><span> </span><span id="local-6989586621680216824"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216824"><span class="hs-identifier hs-var">snd</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-511"></span><span>        </span><span class="hs-comment">-- turn it into Elara.Prim.Tuple2</span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216826"><span class="annot"><span class="annottext">tupleCtorName :: Qualified TypeName
</span><a href="#local-6989586621680216826"><span class="hs-identifier hs-var hs-var hs-var">tupleCtorName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TypeName
</span><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-var">TypeName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TypeName) -&gt; Qualified Text -&gt; Qualified TypeName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified Text
</span><a href="Elara.Prim.Core.html#tuple2CtorName"><span class="hs-identifier hs-var">tuple2CtorName</span></a></span><span>
</span><span id="line-514"></span><span>        </span><span id="local-6989586621680216827"><span class="annot"><a href="#local-6989586621680216827"><span class="hs-identifier hs-var">fst'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216823"><span class="hs-identifier hs-var">fst</span></a></span><span>
</span><span id="line-515"></span><span>        </span><span id="local-6989586621680216828"><span class="annot"><a href="#local-6989586621680216828"><span class="hs-identifier hs-var">x2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216824"><span class="hs-identifier hs-type">snd</span></a></span><span>
</span><span id="line-516"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216829"><span class="annot"><a href="#local-6989586621680216829"><span class="hs-identifier hs-var hs-var">base</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ASTLocate Renamed (Expr' Renamed),
 Select (ASTType ForExpr) Renamed)
-&gt; RenamedExpr
forall a (ast :: a).
(ASTLocate ast (Expr' ast), Select (ASTType ForExpr) ast)
-&gt; Expr ast
</span><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RenamedExpr -&gt; RenamedExpr -&gt; Expr' Renamed
forall a (ast :: a). Expr ast -&gt; Expr ast -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#FunctionCall"><span class="hs-identifier hs-var">FunctionCall</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ASTLocate Renamed (Expr' Renamed),
 Select (ASTType ForExpr) Renamed)
-&gt; RenamedExpr
forall a (ast :: a).
(ASTLocate ast (Expr' ast), Select (ASTType ForExpr) ast)
-&gt; Expr ast
</span><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Expr' Renamed -&gt; Located (Expr' Renamed)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216751"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTLocate Renamed (Select ConRef Renamed) -&gt; Expr' Renamed
forall a (ast :: a). ASTLocate ast (Select ConRef ast) -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Constructor"><span class="hs-identifier hs-var">Constructor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216751"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680216826"><span class="hs-identifier hs-var">tupleCtorName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RenamedType
Select (ASTType ForExpr) Renamed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680216827"><span class="hs-identifier hs-var">fst'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr' Renamed -&gt; Expr Desugared -&gt; Located (Expr' Renamed)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680216823"><span class="hs-identifier hs-var">fst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RenamedType
Select (ASTType ForExpr) Renamed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionCall"><span class="hs-identifier hs-type">FunctionCall</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216829"><span class="hs-identifier hs-type">base</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216828"><span class="hs-identifier hs-type">x2'</span></a></span><span>
</span><span id="line-518"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Tuple"><span class="hs-identifier hs-type">Tuple</span></a></span><span> </span><span class="annot"><span class="annottext">Select Tuple Desugared
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Eff r (Expr' Renamed)
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;renameExpr': Tuple more than length 2&quot;</span></span><span>
</span><span id="line-519"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#InParens"><span class="hs-identifier hs-type">InParens</span></a></span><span> </span><span id="local-6989586621680216831"><span class="annot"><span class="annottext">Select InParens Desugared
</span><a href="#local-6989586621680216831"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedExpr -&gt; Expr' Renamed
Select InParens Renamed -&gt; Expr' Renamed
forall a (ast :: a). Select InParens ast -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#InParens"><span class="hs-identifier hs-var">InParens</span></a></span><span> </span><span class="annot"><span class="annottext">(RenamedExpr -&gt; Expr' Renamed)
-&gt; Eff r RenamedExpr -&gt; Eff r (Expr' Renamed)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
Select InParens Desugared
</span><a href="#local-6989586621680216831"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-520"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Eff r (Expr' Renamed)
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;renameExpr': Let should be handled by renameExpr&quot;</span></span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><a href="#local-6989586621680216753"><span class="hs-identifier hs-var">renameExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Eff r (Expr' Renamed)
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;renameExpr': Block should be handled by renameExpr&quot;</span></span><span>
</span><span id="line-522"></span><span>
</span><span id="line-523"></span><span class="annot"><a href="Elara.Rename.html#renameBinaryOperator"><span class="hs-identifier hs-type">renameBinaryOperator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680213166"><span class="annot"><a href="#local-6989586621680213166"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213166"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213166"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredBinaryOperator"><span class="hs-identifier hs-type">DesugaredBinaryOperator</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213166"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedBinaryOperator"><span class="hs-identifier hs-type">RenamedBinaryOperator</span></a></span><span>
</span><span id="line-524"></span><span id="renameBinaryOperator"><span class="annot"><span class="annottext">renameBinaryOperator :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
BinaryOperator Desugared -&gt; Eff r RenamedBinaryOperator
</span><a href="Elara.Rename.html#renameBinaryOperator"><span class="hs-identifier hs-var hs-var">renameBinaryOperator</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#MkBinaryOperator"><span class="hs-identifier hs-type">MkBinaryOperator</span></a></span><span> </span><span id="local-6989586621680216853"><span class="annot"><span class="annottext">ASTLocate Desugared (BinaryOperator' Desugared)
</span><a href="#local-6989586621680216853"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located (BinaryOperator' Renamed) -&gt; RenamedBinaryOperator
ASTLocate Renamed (BinaryOperator' Renamed)
-&gt; RenamedBinaryOperator
forall {a} (ast :: a).
ASTLocate ast (BinaryOperator' ast) -&gt; BinaryOperator ast
</span><a href="Elara.AST.Generic.Types.html#MkBinaryOperator"><span class="hs-identifier hs-var">MkBinaryOperator</span></a></span><span> </span><span class="annot"><span class="annottext">(Located (BinaryOperator' Renamed) -&gt; RenamedBinaryOperator)
-&gt; Eff r (Located (BinaryOperator' Renamed))
-&gt; Eff r RenamedBinaryOperator
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (BinaryOperator' Desugared))
  (Located (BinaryOperator' Renamed))
  (BinaryOperator' Desugared)
  (BinaryOperator' Renamed)
-&gt; (BinaryOperator' Desugared -&gt; Eff r (BinaryOperator' Renamed))
-&gt; Located (BinaryOperator' Desugared)
-&gt; Eff r (Located (BinaryOperator' Renamed))
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (BinaryOperator' Desugared))
  (Located (BinaryOperator' Renamed))
  (BinaryOperator' Desugared)
  (BinaryOperator' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">InnerRename r =&gt;
BinaryOperator' Desugared -&gt; Eff r (BinaryOperator' Renamed)
BinaryOperator' Desugared -&gt; Eff r (BinaryOperator' Renamed)
</span><a href="#local-6989586621680216854"><span class="hs-identifier hs-var">renameBinaryOperator'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (BinaryOperator' Desugared)
ASTLocate Desugared (BinaryOperator' Desugared)
</span><a href="#local-6989586621680216853"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><a href="#local-6989586621680216854"><span class="hs-identifier hs-type">renameBinaryOperator'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213166"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredBinaryOperator%27"><span class="hs-identifier hs-type">DesugaredBinaryOperator'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213166"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedBinaryOperator%27"><span class="hs-identifier hs-type">RenamedBinaryOperator'</span></a></span><span>
</span><span id="line-527"></span><span>    </span><span id="local-6989586621680216854"><span class="annot"><span class="annottext">renameBinaryOperator' :: InnerRename r =&gt;
BinaryOperator' Desugared -&gt; Eff r (BinaryOperator' Renamed)
</span><a href="#local-6989586621680216854"><span class="hs-identifier hs-var hs-var">renameBinaryOperator'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#SymOp"><span class="hs-identifier hs-type">SymOp</span></a></span><span> </span><span id="local-6989586621680216903"><span class="annot"><span class="annottext">CleanupLocated (ASTLocate' Desugared (Select SymOp Desugared))
</span><a href="#local-6989586621680216903"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-528"></span><span>        </span><span id="local-6989586621680216904"><span class="annot"><a href="#local-6989586621680216904"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
-&gt; Eff r (Located (VarRef VarName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(Rock Query :&gt; r, Reader (Maybe (Module Desugared)) :&gt; r,
 State RenameState :&gt; r, Error RenameError :&gt; r,
 Error SomeReportableError :&gt; r,
 DiagnosticWriter (Doc AnsiStyle) :&gt; r, UniqueGen :&gt; r,
 FileSystem :&gt; r, Concurrent :&gt; r, StructuredDebug :&gt; r) =&gt;
Located (MaybeQualified VarName)
-&gt; Eff r (Located (VarRef VarName))
</span><a href="Elara.Rename.html#lookupVarName"><span class="hs-identifier hs-var">lookupVarName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OpName -&gt; VarName
</span><a href="Elara.AST.Name.html#OperatorVarName"><span class="hs-identifier hs-var">OperatorVarName</span></a></span><span> </span><span class="annot"><span class="annottext">(OpName -&gt; VarName)
-&gt; Located (MaybeQualified OpName)
-&gt; Located (MaybeQualified VarName)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified OpName)
CleanupLocated (ASTLocate' Desugared (Select SymOp Desugared))
</span><a href="#local-6989586621680216903"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216913"><span class="annot"><a href="#local-6989586621680216913"><span class="hs-identifier hs-var hs-var">onlyOpName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#OperatorVarName"><span class="hs-identifier hs-type">OperatorVarName</span></a></span><span> </span><span id="local-6989586621680216914"><span class="annot"><span class="annottext">OpName
</span><a href="#local-6989586621680216914"><span class="hs-identifier hs-var">o'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OpName
</span><a href="#local-6989586621680216914"><span class="hs-identifier hs-var">o'</span></a></span><span>
</span><span id="line-530"></span><span>            </span><span class="annot"><a href="#local-6989586621680216913"><span class="hs-identifier hs-var">onlyOpName</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; OpName
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;renameBinaryOperator': I really don't like this&quot;</span></span><span>
</span><span id="line-531"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216915"><span class="annot"><a href="#local-6989586621680216915"><span class="hs-identifier hs-var hs-var">op''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarName -&gt; OpName
</span><a href="#local-6989586621680216913"><span class="hs-identifier hs-var">onlyOpName</span></a></span><span> </span><span class="annot"><span class="annottext">(VarName -&gt; OpName)
-&gt; Located (VarRef VarName)
-&gt; Located (VarRef' LocatedVarRefKind OpName)
forall (f :: * -&gt; *) (g :: * -&gt; *) a b.
(Functor f, Functor g) =&gt;
(a -&gt; b) -&gt; f (g a) -&gt; f (g b)
</span><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Located (VarRef VarName)
</span><a href="#local-6989586621680216904"><span class="hs-identifier hs-var">op'</span></a></span><span>
</span><span id="line-532"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#SymOp"><span class="hs-identifier hs-type">SymOp</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216915"><span class="hs-identifier hs-type">op''</span></a></span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><a href="#local-6989586621680216854"><span class="hs-identifier hs-var">renameBinaryOperator'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Infixed"><span class="hs-identifier hs-type">Infixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680216917"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216917"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621680216918"><span class="annot"><span class="annottext">MaybeQualified VarOrConName
</span><a href="#local-6989586621680216918"><span class="hs-identifier hs-var">o</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-534"></span><span>        </span><span id="local-6989586621680216919"><span class="annot"><a href="#local-6989586621680216919"><span class="hs-identifier hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">VarRef</span></span><span> </span><span class="annot"><span class="hs-identifier">VarOrConName</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">MaybeQualified VarOrConName
</span><a href="#local-6989586621680216918"><span class="hs-identifier hs-var">o</span></a></span><span> </span><span class="hs-keyword">of</span><span> </span><span class="hs-comment">-- TODO: tidy this up</span><span>
</span><span id="line-535"></span><span>            </span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span id="local-6989586621680216921"><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680216921"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680216922"><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621680216922"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-536"></span><span>                </span><span id="local-6989586621680216923"><span class="annot"><a href="#local-6989586621680216923"><span class="hs-identifier hs-var">vn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
-&gt; Eff r (Located (VarRef VarName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(Rock Query :&gt; r, Reader (Maybe (Module Desugared)) :&gt; r,
 State RenameState :&gt; r, Error RenameError :&gt; r,
 Error SomeReportableError :&gt; r,
 DiagnosticWriter (Doc AnsiStyle) :&gt; r, UniqueGen :&gt; r,
 FileSystem :&gt; r, Concurrent :&gt; r, StructuredDebug :&gt; r) =&gt;
Located (MaybeQualified VarName)
-&gt; Eff r (Located (VarRef VarName))
</span><a href="Elara.Rename.html#lookupVarName"><span class="hs-identifier hs-var">lookupVarName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion
-&gt; MaybeQualified VarName -&gt; Located (MaybeQualified VarName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216917"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VarName -&gt; Maybe ModuleName -&gt; MaybeQualified VarName
forall name. name -&gt; Maybe ModuleName -&gt; MaybeQualified name
</span><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-var">MaybeQualified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LowerAlphaName -&gt; VarName
</span><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier hs-var">NormalVarName</span></a></span><span> </span><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680216921"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621680216922"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-537"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680216931"><span class="annot"><a href="#local-6989586621680216931"><span class="hs-identifier hs-var hs-var">onlyVarName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier hs-type">NormalVarName</span></a></span><span> </span><span id="local-6989586621680216932"><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680216932"><span class="hs-identifier hs-var">n'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LowerAlphaName
</span><a href="#local-6989586621680216932"><span class="hs-identifier hs-var">n'</span></a></span><span>
</span><span id="line-538"></span><span>                    </span><span class="annot"><a href="#local-6989586621680216931"><span class="hs-identifier hs-var">onlyVarName</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; LowerAlphaName
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;renameBinaryOperator': I really don't like this&quot;</span></span><span>
</span><span id="line-539"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621680216931"><span class="hs-identifier hs-type">onlyVarName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&lt;$&gt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680216923"><span class="hs-identifier hs-type">vn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span>
</span><span id="line-540"></span><span>            </span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-type">MaybeQualified</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#ConName"><span class="hs-identifier hs-type">ConName</span></a></span><span> </span><span id="local-6989586621680216934"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680216934"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621680216935"><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621680216935"><span class="hs-identifier hs-var">q</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-541"></span><span>                </span><span id="local-6989586621680216936"><span class="annot"><a href="#local-6989586621680216936"><span class="hs-identifier hs-var">tn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#lookupTypeName"><span class="hs-identifier hs-var">lookupTypeName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion
-&gt; MaybeQualified TypeName -&gt; Located (MaybeQualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216917"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeName -&gt; Maybe ModuleName -&gt; MaybeQualified TypeName
forall name. name -&gt; Maybe ModuleName -&gt; MaybeQualified name
</span><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-var">MaybeQualified</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680216934"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe ModuleName
</span><a href="#local-6989586621680216935"><span class="hs-identifier hs-var">q</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>                </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#Global"><span class="hs-identifier hs-type">Global</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#ConName"><span class="hs-identifier hs-type">ConName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&lt;$&gt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680216936"><span class="hs-identifier hs-type">tn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Infixed"><span class="hs-identifier hs-type">Infixed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216919"><span class="hs-identifier hs-type">op'</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="annot"><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-type">renamePattern</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621680213172"><span class="annot"><a href="#local-6989586621680213172"><span class="hs-identifier hs-type">r</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213172"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213172"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredPattern"><span class="hs-identifier hs-type">DesugaredPattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213172"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedPattern"><span class="hs-identifier hs-type">RenamedPattern</span></a></span><span>
</span><span id="line-546"></span><span id="renamePattern"><span class="annot"><span class="annottext">renamePattern :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Pattern Desugared -&gt; Eff r RenamedPattern
</span><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-var hs-var">renamePattern</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span id="local-6989586621680216990"><span class="annot"><span class="annottext">fp :: (CleanupLocated (ASTLocate' Desugared (Pattern' Desugared)),
 Select PatternType Desugared)
</span><a href="#local-6989586621680216990"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680216991"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216991"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Pattern' Desugared
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Select PatternType Desugared
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><span class="annottext">(Located (Pattern' Renamed), Maybe RenamedType) -&gt; RenamedPattern
(ASTLocate Renamed (Pattern' Renamed), Select PatternType Renamed)
-&gt; RenamedPattern
forall {a} (ast :: a).
(ASTLocate ast (Pattern' ast), Select PatternType ast)
-&gt; Pattern ast
</span><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span>
</span><span id="line-548"></span><span>        </span><span class="annot"><span class="annottext">((Located (Pattern' Renamed), Maybe RenamedType) -&gt; RenamedPattern)
-&gt; Eff r (Located (Pattern' Renamed), Maybe RenamedType)
-&gt; Eff r RenamedPattern
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(Located (Pattern' Desugared)
 -&gt; Eff r (Located (Pattern' Renamed)))
-&gt; (Maybe DesugaredType -&gt; Eff r (Maybe RenamedType))
-&gt; (Located (Pattern' Desugared), Maybe DesugaredType)
-&gt; Eff r (Located (Pattern' Renamed), Maybe RenamedType)
forall (f :: * -&gt; *) a c b d.
Applicative f =&gt;
(a -&gt; f c) -&gt; (b -&gt; f d) -&gt; (a, b) -&gt; f (c, d)
forall (t :: * -&gt; * -&gt; *) (f :: * -&gt; *) a c b d.
(Bitraversable t, Applicative f) =&gt;
(a -&gt; f c) -&gt; (b -&gt; f d) -&gt; t a b -&gt; f (t c d)
</span><span class="hs-identifier hs-var">bitraverse</span></span><span>
</span><span id="line-549"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Pattern' Desugared))
  (Located (Pattern' Renamed))
  (Pattern' Desugared)
  (Pattern' Renamed)
-&gt; (Pattern' Desugared -&gt; Eff r (Pattern' Renamed))
-&gt; Located (Pattern' Desugared)
-&gt; Eff r (Located (Pattern' Renamed))
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Pattern' Desugared))
  (Located (Pattern' Renamed))
  (Pattern' Desugared)
  (Pattern' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">InnerRename r =&gt; Pattern' Desugared -&gt; Eff r (Pattern' Renamed)
Pattern' Desugared -&gt; Eff r (Pattern' Renamed)
</span><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(DesugaredType -&gt; Eff r RenamedType)
-&gt; Maybe DesugaredType -&gt; Eff r (Maybe RenamedType)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; Maybe a -&gt; f (Maybe b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Type' Desugared)
  (Type' Renamed)
-&gt; (Type' Desugared -&gt; Eff r (Type' Renamed))
-&gt; DesugaredType
-&gt; Eff r RenamedType
forall k (f :: * -&gt; *) (is :: IxList) s t a b.
(Is k A_Traversal, Applicative f) =&gt;
Optic k is s t a b -&gt; (a -&gt; f b) -&gt; s -&gt; f t
</span><span class="hs-identifier hs-var">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  DesugaredType
  RenamedType
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared), NoFieldValue)
     (Located (Type' Renamed), NoFieldValue)
     (Located (Type' Desugared))
     (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Located (Type' Desugared))
     (Located (Type' Renamed))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared), NoFieldValue)
  (Located (Type' Renamed), NoFieldValue)
  (Located (Type' Desugared))
  (Located (Type' Renamed))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  DesugaredType
  RenamedType
  (Located (Type' Desugared))
  (Located (Type' Renamed))
-&gt; Optic
     A_Lens
     '[]
     (Located (Type' Desugared))
     (Located (Type' Renamed))
     (Type' Desugared)
     (Type' Renamed)
-&gt; Optic
     A_Lens
     '[]
     DesugaredType
     RenamedType
     (Type' Desugared)
     (Type' Renamed)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Type' Desugared))
  (Located (Type' Renamed))
  (Type' Desugared)
  (Type' Renamed)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Bool -&gt; Type' Desugared -&gt; Eff r (Type' Renamed)
</span><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-var">renameType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-551"></span><span>            </span><span class="annot"><span class="annottext">(Located (Pattern' Desugared), Maybe DesugaredType)
(CleanupLocated (ASTLocate' Desugared (Pattern' Desugared)),
 Select PatternType Desugared)
</span><a href="#local-6989586621680216990"><span class="hs-identifier hs-var">fp</span></a></span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-type">renamePattern'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213172"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredPattern%27"><span class="hs-identifier hs-type">DesugaredPattern'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213172"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedPattern%27"><span class="hs-identifier hs-type">RenamedPattern'</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span id="local-6989586621680216992"><span class="annot"><span class="annottext">renamePattern' :: InnerRename r =&gt; Pattern' Desugared -&gt; Eff r (Pattern' Renamed)
</span><a href="#local-6989586621680216992"><span class="hs-identifier hs-var hs-var">renamePattern'</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#IntegerPattern"><span class="hs-identifier hs-type">IntegerPattern</span></a></span><span> </span><span id="local-6989586621680217128"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680217128"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Pattern' Renamed -&gt; Eff r (Pattern' Renamed))
-&gt; Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Pattern' Renamed
forall {a} (ast :: a). Integer -&gt; Pattern' ast
</span><a href="Elara.AST.Generic.Types.html#IntegerPattern"><span class="hs-identifier hs-var">IntegerPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621680217128"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#FloatPattern"><span class="hs-identifier hs-type">FloatPattern</span></a></span><span> </span><span id="local-6989586621680217130"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680217130"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Pattern' Renamed -&gt; Eff r (Pattern' Renamed))
-&gt; Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Pattern' Renamed
forall {a} (ast :: a). Double -&gt; Pattern' ast
</span><a href="Elara.AST.Generic.Types.html#FloatPattern"><span class="hs-identifier hs-var">FloatPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621680217130"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#StringPattern"><span class="hs-identifier hs-type">StringPattern</span></a></span><span> </span><span id="local-6989586621680217132"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680217132"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Pattern' Renamed -&gt; Eff r (Pattern' Renamed))
-&gt; Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Pattern' Renamed
forall {a} (ast :: a). Text -&gt; Pattern' ast
</span><a href="Elara.AST.Generic.Types.html#StringPattern"><span class="hs-identifier hs-var">StringPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621680217132"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#CharPattern"><span class="hs-identifier hs-type">CharPattern</span></a></span><span> </span><span id="local-6989586621680217134"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680217134"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Pattern' Renamed -&gt; Eff r (Pattern' Renamed))
-&gt; Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Pattern' Renamed
forall {a} (ast :: a). Char -&gt; Pattern' ast
</span><a href="Elara.AST.Generic.Types.html#CharPattern"><span class="hs-identifier hs-var">CharPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621680217134"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' Desugared
</span><a href="Elara.AST.Generic.Types.html#WildcardPattern"><span class="hs-identifier hs-var">WildcardPattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed
forall {a} (ast :: a). Pattern' ast
</span><a href="Elara.AST.Generic.Types.html#WildcardPattern"><span class="hs-identifier hs-var">WildcardPattern</span></a></span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern' Desugared
</span><a href="Elara.AST.Generic.Types.html#UnitPattern"><span class="hs-identifier hs-var">UnitPattern</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed
forall {a} (ast :: a). Pattern' ast
</span><a href="Elara.AST.Generic.Types.html#UnitPattern"><span class="hs-identifier hs-var">UnitPattern</span></a></span><span>
</span><span id="line-560"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListPattern"><span class="hs-identifier hs-type">ListPattern</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a. a -&gt; Eff r a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Pattern' Renamed -&gt; Eff r (Pattern' Renamed))
-&gt; Pattern' Renamed -&gt; Eff r (Pattern' Renamed)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ASTLocate Renamed (Select ConPat Renamed)
-&gt; [RenamedPattern] -&gt; Pattern' Renamed
forall {a} (ast :: a).
ASTLocate ast (Select ConPat ast) -&gt; [Pattern ast] -&gt; Pattern' ast
</span><a href="Elara.AST.Generic.Types.html#ConstructorPattern"><span class="hs-identifier hs-var">ConstructorPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216991"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
forall s. IsString s =&gt; Qualified s
</span><a href="Elara.Prim.Core.html#emptyListCtorName"><span class="hs-identifier hs-var">emptyListCtorName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-561"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListPattern"><span class="hs-identifier hs-type">ListPattern</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680217139"><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217139"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680217140"><span class="annot"><span class="annottext">[Pattern Desugared]
</span><a href="#local-6989586621680217140"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-562"></span><span>        </span><span class="hs-comment">-- turn [x, y, z] into Cons x (Cons y (Cons z Nil))</span><span>
</span><span id="line-563"></span><span>        </span><span id="local-6989586621680217141"><span class="annot"><a href="#local-6989586621680217141"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Pattern Desugared -&gt; Eff r RenamedPattern)
-&gt; NonEmpty (Pattern Desugared) -&gt; Eff r (NonEmpty RenamedPattern)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Pattern Desugared -&gt; Eff r RenamedPattern
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Pattern Desugared -&gt; Eff r RenamedPattern
</span><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-var">renamePattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217139"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern Desugared
-&gt; [Pattern Desugared] -&gt; NonEmpty (Pattern Desugared)
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[Pattern Desugared]
</span><a href="#local-6989586621680217140"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217142"><span class="annot"><a href="#local-6989586621680217142"><span class="hs-identifier hs-var">lastCons</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">Pattern</span></span><span> </span><span class="annot"><span class="hs-identifier">Renamed</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-565"></span><span>                </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span>
</span><span id="line-566"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ConstructorPattern"><span class="hs-identifier hs-type">ConstructorPattern</span></a></span><span>
</span><span id="line-567"></span><span>                        </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216991"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="Elara.Prim.Core.html#emptyListCtorName"><span class="hs-identifier hs-type">emptyListCtorName</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>                        </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-569"></span><span>                        </span><span class="annot"><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-type">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">last</span></span><span> </span><span class="annot"><a href="#local-6989586621680217141"><span class="hs-identifier hs-type">xs'</span></a></span><span>
</span><span id="line-570"></span><span>                    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span>
</span><span id="line-571"></span><span>                    </span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217143"><span class="annot"><a href="#local-6989586621680217143"><span class="hs-identifier hs-var hs-var">cons</span></a></span></span><span> </span><span id="local-6989586621680217144"><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217144"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621680217145"><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217145"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ASTLocate Renamed (Pattern' Renamed), Select PatternType Renamed)
-&gt; RenamedPattern
forall {a} (ast :: a).
(ASTLocate ast (Pattern' ast), Select PatternType ast)
-&gt; Pattern ast
</span><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-var">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTLocate Renamed (Select ConPat Renamed)
-&gt; [RenamedPattern] -&gt; Pattern' Renamed
forall {a} (ast :: a).
ASTLocate ast (Select ConPat ast) -&gt; [Pattern ast] -&gt; Pattern' ast
</span><a href="Elara.AST.Generic.Types.html#ConstructorPattern"><span class="hs-identifier hs-var">ConstructorPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; Qualified TypeName -&gt; Located (Qualified TypeName)
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680216991"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
forall s. IsString s =&gt; Qualified s
</span><a href="Elara.Prim.Core.html#consCtorName"><span class="hs-identifier hs-var">consCtorName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217144"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217145"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Pattern' Renamed -&gt; RenamedPattern -&gt; Located (Pattern' Renamed)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217144"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RenamedType
Select PatternType Renamed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-573"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621680217146"><span class="hs-identifier hs-type">createConses</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Renamed"><span class="hs-identifier hs-type">Renamed</span></a></span><span>
</span><span id="line-574"></span><span>            </span><span id="local-6989586621680217146"><span class="annot"><a href="#local-6989586621680217146"><span class="hs-identifier hs-var hs-var">createConses</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217142"><span class="hs-identifier hs-var">lastCons</span></a></span><span>
</span><span id="line-575"></span><span>            </span><span class="annot"><a href="#local-6989586621680217146"><span class="hs-identifier hs-var">createConses</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680217147"><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217147"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680217148"><span class="annot"><span class="annottext">[RenamedPattern]
</span><a href="#local-6989586621680217148"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RenamedPattern -&gt; RenamedPattern -&gt; RenamedPattern
</span><a href="#local-6989586621680217143"><span class="hs-identifier hs-var">cons</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217147"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[RenamedPattern] -&gt; RenamedPattern
</span><a href="#local-6989586621680217146"><span class="hs-identifier hs-var">createConses</span></a></span><span> </span><span class="annot"><span class="annottext">[RenamedPattern]
</span><a href="#local-6989586621680217148"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-576"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680217146"><span class="hs-identifier hs-type">createConses</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">init</span></span><span> </span><span class="annot"><a href="#local-6989586621680217141"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-577"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ConsPattern"><span class="hs-identifier hs-type">ConsPattern</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680217151"><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217151"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680217152"><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217152"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-578"></span><span>        </span><span id="local-6989586621680217153"><span class="annot"><a href="#local-6989586621680217153"><span class="hs-identifier hs-var">p1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pattern Desugared -&gt; Eff r RenamedPattern
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Pattern Desugared -&gt; Eff r RenamedPattern
</span><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-var">renamePattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217151"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-579"></span><span>        </span><span id="local-6989586621680217154"><span class="annot"><a href="#local-6989586621680217154"><span class="hs-identifier hs-var">p2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-type">renamePattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217152"><span class="hs-identifier hs-type">p2</span></a></span><span>
</span><span id="line-580"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ConstructorPattern"><span class="hs-identifier hs-type">ConstructorPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216991"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="Elara.Prim.Core.html#consCtorName"><span class="hs-identifier hs-type">consCtorName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680217153"><span class="hs-identifier hs-type">p1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680217154"><span class="hs-identifier hs-type">p2'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-581"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TuplePattern"><span class="hs-identifier hs-type">TuplePattern</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680217156"><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217156"><span class="hs-identifier hs-var">p1</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span id="local-6989586621680217157"><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217157"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-582"></span><span>        </span><span class="hs-comment">-- turn (x, y) into Elara.Prim.Tuple2 x y</span><span>
</span><span id="line-583"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217159"><span class="annot"><span class="annottext">tupleCtorName :: Qualified TypeName
</span><a href="#local-6989586621680217159"><span class="hs-identifier hs-var hs-var hs-var">tupleCtorName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; TypeName
</span><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-var">TypeName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; TypeName) -&gt; Qualified Text -&gt; Qualified TypeName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified Text
</span><a href="Elara.Prim.Core.html#tuple2CtorName"><span class="hs-identifier hs-var">tuple2CtorName</span></a></span><span>
</span><span id="line-584"></span><span>        </span><span id="local-6989586621680217160"><span class="annot"><a href="#local-6989586621680217160"><span class="hs-identifier hs-var">p1'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pattern Desugared -&gt; Eff r RenamedPattern
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Pattern Desugared -&gt; Eff r RenamedPattern
</span><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-var">renamePattern</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217156"><span class="hs-identifier hs-var">p1</span></a></span><span>
</span><span id="line-585"></span><span>        </span><span id="local-6989586621680217161"><span class="annot"><a href="#local-6989586621680217161"><span class="hs-identifier hs-var">p2'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-type">renamePattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217157"><span class="hs-identifier hs-type">p2</span></a></span><span>
</span><span id="line-586"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ConstructorPattern"><span class="hs-identifier hs-type">ConstructorPattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680216991"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217159"><span class="hs-identifier hs-type">tupleCtorName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621680217160"><span class="hs-identifier hs-type">p1'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680217161"><span class="hs-identifier hs-type">p2'</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TuplePattern"><span class="hs-identifier hs-type">TuplePattern</span></a></span><span> </span><span class="annot"><span class="annottext">Select TuplePattern Desugared
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Eff r (Pattern' Renamed)
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;renamePattern': TuplePattern more than length 2&quot;</span></span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#VarPattern"><span class="hs-identifier hs-type">VarPattern</span></a></span><span> </span><span id="local-6989586621680217163"><span class="annot"><span class="annottext">CleanupLocated (ASTLocate' Desugared (Select VarPat Desugared))
</span><a href="#local-6989586621680217163"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-589"></span><span>        </span><span id="local-6989586621680217164"><span class="annot"><a href="#local-6989586621680217164"><span class="hs-identifier hs-var">vn'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located LowerAlphaName -&gt; Eff r (Located (Unique LowerAlphaName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r) =&gt;
Located name -&gt; Eff r (Located (Unique name))
</span><a href="Elara.Rename.html#uniquify"><span class="hs-identifier hs-var">uniquify</span></a></span><span> </span><span class="annot"><span class="annottext">Located LowerAlphaName
CleanupLocated (ASTLocate' Desugared (Select VarPat Desugared))
</span><a href="#local-6989586621680217163"><span class="hs-identifier hs-var">vn</span></a></span><span>
</span><span id="line-590"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Eff.modify</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;varNames&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680217163"><span class="hs-identifier hs-type">vn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">to</span></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier hs-type">NormalVarName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">one</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier hs-type">NormalVarName</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&lt;$&gt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680217164"><span class="hs-identifier hs-type">vn'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#VarPattern"><span class="hs-identifier hs-type">VarPattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217164"><span class="hs-identifier hs-type">vn'</span></a></span><span>
</span><span id="line-592"></span><span>    </span><span class="annot"><a href="#local-6989586621680216992"><span class="hs-identifier hs-var">renamePattern'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#ConstructorPattern"><span class="hs-identifier hs-type">ConstructorPattern</span></a></span><span> </span><span id="local-6989586621680217165"><span class="annot"><span class="annottext">CleanupLocated (ASTLocate' Desugared (Select ConPat Desugared))
</span><a href="#local-6989586621680217165"><span class="hs-identifier hs-var">cn</span></a></span></span><span> </span><span id="local-6989586621680217166"><span class="annot"><span class="annottext">[Pattern Desugared]
</span><a href="#local-6989586621680217166"><span class="hs-identifier hs-var">ps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-593"></span><span>        </span><span id="local-6989586621680217167"><span class="annot"><a href="#local-6989586621680217167"><span class="hs-identifier hs-var">cn'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Rock Query :&gt; r) =&gt;
Located (MaybeQualified TypeName)
-&gt; Eff r (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#qualifyTypeName"><span class="hs-identifier hs-var">qualifyTypeName</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
CleanupLocated (ASTLocate' Desugared (Select ConPat Desugared))
</span><a href="#local-6989586621680217165"><span class="hs-identifier hs-var">cn</span></a></span><span>
</span><span id="line-594"></span><span>        </span><span id="local-6989586621680217168"><span class="annot"><a href="#local-6989586621680217168"><span class="hs-identifier hs-var">ps'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-type">renamePattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217166"><span class="hs-identifier hs-type">ps</span></a></span><span>
</span><span id="line-595"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ConstructorPattern"><span class="hs-identifier hs-type">ConstructorPattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217167"><span class="hs-identifier hs-type">cn'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217168"><span class="hs-identifier hs-type">ps'</span></a></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="annot"><span class="hs-comment">{- | Estimates a var name from a pattern
This isn't really necessary as names will be uniquified anyway, but it could make dumped code more readable
-}</span></span><span>
</span><span id="line-600"></span><span class="annot"><a href="Elara.Rename.html#patternToVarName"><span class="hs-identifier hs-type">patternToVarName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredPattern"><span class="hs-identifier hs-type">DesugaredPattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span>
</span><span id="line-601"></span><span id="patternToVarName"><span class="annot"><span class="annottext">patternToVarName :: Pattern Desugared -&gt; VarName
</span><a href="Elara.Rename.html#patternToVarName"><span class="hs-identifier hs-var hs-var">patternToVarName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680217182"><span class="annot"><span class="annottext">Pattern' Desugared
</span><a href="#local-6989586621680217182"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Select PatternType Desugared
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-602"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217183"><span class="annot"><span class="annottext">mn :: Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var hs-var">mn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LowerAlphaName -&gt; VarName
</span><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier hs-var">NormalVarName</span></a></span><span> </span><span class="annot"><span class="annottext">(LowerAlphaName -&gt; VarName)
-&gt; (Text -&gt; LowerAlphaName) -&gt; Text -&gt; VarName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; LowerAlphaName
</span><a href="Elara.AST.Name.html#LowerAlphaName"><span class="hs-identifier hs-var">LowerAlphaName</span></a></span><span>
</span><span id="line-603"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Pattern' Desugared
</span><a href="#local-6989586621680217182"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-604"></span><span>            </span><span class="annot"><span class="annottext">Pattern' Desugared
</span><a href="Elara.AST.Generic.Types.html#WildcardPattern"><span class="hs-identifier hs-var">WildcardPattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;wildcard&quot;</span></span><span>
</span><span id="line-605"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListPattern"><span class="hs-identifier hs-type">ListPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Select ListPattern Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;list&quot;</span></span><span>
</span><span id="line-606"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#VarPattern"><span class="hs-identifier hs-type">VarPattern</span></a></span><span> </span><span id="local-6989586621680217185"><span class="annot"><span class="annottext">CleanupLocated (ASTLocate' Desugared (Select VarPat Desugared))
</span><a href="#local-6989586621680217185"><span class="hs-identifier hs-var">vn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">LowerAlphaName -&gt; VarName
</span><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier hs-var">NormalVarName</span></a></span><span> </span><span class="annot"><span class="annottext">(LowerAlphaName -&gt; VarName) -&gt; LowerAlphaName -&gt; VarName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Located LowerAlphaName
CleanupLocated (ASTLocate' Desugared (Select VarPat Desugared))
</span><a href="#local-6989586621680217185"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="annot"><span class="annottext">Located LowerAlphaName
-&gt; Optic' A_Lens '[] (Located LowerAlphaName) LowerAlphaName
-&gt; LowerAlphaName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] (Located LowerAlphaName) LowerAlphaName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-607"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#IntegerPattern"><span class="hs-identifier hs-type">IntegerPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;int&quot;</span></span><span>
</span><span id="line-608"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#FloatPattern"><span class="hs-identifier hs-type">FloatPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;float&quot;</span></span><span>
</span><span id="line-609"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#StringPattern"><span class="hs-identifier hs-type">StringPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;string&quot;</span></span><span>
</span><span id="line-610"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#CharPattern"><span class="hs-identifier hs-type">CharPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;char&quot;</span></span><span>
</span><span id="line-611"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ConstructorPattern"><span class="hs-identifier hs-type">ConstructorPattern</span></a></span><span> </span><span class="annot"><span class="annottext">CleanupLocated (ASTLocate' Desugared (Select ConPat Desugared))
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Pattern Desugared]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;constructor&quot;</span></span><span>
</span><span id="line-612"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ConsPattern"><span class="hs-identifier hs-type">ConsPattern</span></a></span><span> </span><span class="annot"><span class="annottext">Select ConsPattern Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cons&quot;</span></span><span>
</span><span id="line-613"></span><span>            </span><span class="annot"><span class="annottext">Pattern' Desugared
</span><a href="Elara.AST.Generic.Types.html#UnitPattern"><span class="hs-identifier hs-var">UnitPattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">VarName
</span><span class="hs-string">&quot;unit&quot;</span></span><span>
</span><span id="line-614"></span><span>            </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TuplePattern"><span class="hs-identifier hs-type">TuplePattern</span></a></span><span> </span><span class="annot"><span class="annottext">Select TuplePattern Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; VarName
</span><a href="#local-6989586621680217183"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;tuple&quot;</span></span><span>
</span><span id="line-615"></span><span>
</span><span id="line-616"></span><span class="annot"><span class="hs-comment">-- | Turn a pattern and a body into a variable and a match expression. Used for renaming lambdas who use patterns as binders.</span></span><span>
</span><span id="line-617"></span><span id="local-6989586621680213194"><span class="annot"><a href="Elara.Rename.html#patternToMatch"><span class="hs-identifier hs-type">patternToMatch</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-618"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213194"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213194"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213194"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-619"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Pattern to turn into a match</span></span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredPattern"><span class="hs-identifier hs-type">DesugaredPattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-621"></span><span>    </span><span class="annot"><span class="hs-comment">-- | Body of the lambda</span></span><span>
</span><span id="line-622"></span><span>    </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredExpr"><span class="hs-identifier hs-type">DesugaredExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-623"></span><span>    </span><span class="annot"><span class="hs-comment">-- | The variable to bind the match to, and the match expression</span></span><span>
</span><span id="line-624"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213194"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Data.Unique.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#VarName"><span class="hs-identifier hs-type">VarName</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedExpr"><span class="hs-identifier hs-type">RenamedExpr</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-625"></span><span id="patternToMatch"><span class="annot"><span class="annottext">patternToMatch :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Pattern Desugared
-&gt; Expr Desugared -&gt; Eff r (Located (Unique VarName), RenamedExpr)
</span><a href="Elara.Rename.html#patternToMatch"><span class="hs-identifier hs-var hs-var">patternToMatch</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#VarPattern"><span class="hs-identifier hs-type">VarPattern</span></a></span><span> </span><span id="local-6989586621680217312"><span class="annot"><span class="annottext">CleanupLocated (ASTLocate' Desugared (Select VarPat Desugared))
</span><a href="#local-6989586621680217312"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Select PatternType Desugared
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680217313"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217313"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>    </span><span class="hs-comment">-- Special case, no match needed</span><span>
</span><span id="line-627"></span><span>    </span><span class="hs-comment">-- We can just turn \x -&gt; x into \x -&gt; x</span><span>
</span><span id="line-628"></span><span>    </span><span id="local-6989586621680217314"><span class="annot"><a href="#local-6989586621680217314"><span class="hs-identifier hs-var">uniqueVn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located VarName -&gt; Eff r (Located (Unique VarName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r) =&gt;
Located name -&gt; Eff r (Located (Unique name))
</span><a href="Elara.Rename.html#uniquify"><span class="hs-identifier hs-var">uniquify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LowerAlphaName -&gt; VarName
</span><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier hs-var">NormalVarName</span></a></span><span> </span><span class="annot"><span class="annottext">(LowerAlphaName -&gt; VarName)
-&gt; Located LowerAlphaName -&gt; Located VarName
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Located LowerAlphaName
CleanupLocated (ASTLocate' Desugared (Select VarPat Desugared))
</span><a href="#local-6989586621680217312"><span class="hs-identifier hs-var">vn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>    </span><span id="local-6989586621680217315"><span class="annot"><a href="#local-6989586621680217315"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Effectful.State.Extra.html#locally"><span class="hs-identifier hs-type">locally</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;varNames&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680217312"><span class="hs-identifier hs-type">vn</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">to</span></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#NormalVarName"><span class="hs-identifier hs-type">NormalVarName</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">one</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217314"><span class="hs-identifier hs-type">uniqueVn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217313"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680217314"><span class="hs-identifier hs-type">uniqueVn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680217315"><span class="hs-identifier hs-type">body'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-631"></span><span class="annot"><a href="Elara.Rename.html#patternToMatch"><span class="hs-identifier hs-var">patternToMatch</span></a></span><span> </span><span id="local-6989586621680217316"><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217316"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621680217317"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217317"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-632"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217318"><span class="annot"><span class="annottext">vn :: VarName
</span><a href="#local-6989586621680217318"><span class="hs-identifier hs-var hs-var hs-var">vn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern Desugared -&gt; VarName
</span><a href="Elara.Rename.html#patternToVarName"><span class="hs-identifier hs-var">patternToVarName</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217316"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-633"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217319"><span class="annot"><span class="annottext">patLocation :: SourceRegion
</span><a href="#local-6989586621680217319"><span class="hs-identifier hs-var hs-var hs-var">patLocation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217316"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern Desugared
-&gt; Optic' A_Lens '[] (Pattern Desugared) SourceRegion
-&gt; SourceRegion
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Pattern Desugared)
  (Pattern Desugared)
  (Located (Pattern' Desugared), Maybe DesugaredType)
  (Located (Pattern' Desugared), Maybe DesugaredType)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Pattern Desugared)
  (Pattern Desugared)
  (Located (Pattern' Desugared), Maybe DesugaredType)
  (Located (Pattern' Desugared), Maybe DesugaredType)
-&gt; Optic
     A_Lens
     '[]
     (Located (Pattern' Desugared), Maybe DesugaredType)
     (Located (Pattern' Desugared), Maybe DesugaredType)
     (Located (Pattern' Desugared))
     (Located (Pattern' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Pattern Desugared)
     (Pattern Desugared)
     (Located (Pattern' Desugared))
     (Located (Pattern' Desugared))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Pattern' Desugared), Maybe DesugaredType)
  (Located (Pattern' Desugared), Maybe DesugaredType)
  (Located (Pattern' Desugared))
  (Located (Pattern' Desugared))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Pattern Desugared)
  (Pattern Desugared)
  (Located (Pattern' Desugared))
  (Located (Pattern' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Pattern' Desugared))
     (Located (Pattern' Desugared))
     SourceRegion
     SourceRegion
-&gt; Optic' A_Lens '[] (Pattern Desugared) SourceRegion
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Pattern' Desugared))
  (Located (Pattern' Desugared))
  SourceRegion
  SourceRegion
forall a. HasSourceRegion a =&gt; Lens' a SourceRegion
</span><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier hs-var">sourceRegion</span></a></span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217320"><span class="annot"><span class="annottext">bodyLocation :: SourceRegion
</span><a href="#local-6989586621680217320"><span class="hs-identifier hs-var hs-var hs-var">bodyLocation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217317"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
-&gt; Optic' A_Lens '[] (Expr Desugared) SourceRegion -&gt; SourceRegion
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Expr Desugared)
  (Expr Desugared)
  (Located (Expr' Desugared), Maybe DesugaredType)
  (Located (Expr' Desugared), Maybe DesugaredType)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Expr Desugared)
  (Expr Desugared)
  (Located (Expr' Desugared), Maybe DesugaredType)
  (Located (Expr' Desugared), Maybe DesugaredType)
-&gt; Optic
     A_Lens
     '[]
     (Located (Expr' Desugared), Maybe DesugaredType)
     (Located (Expr' Desugared), Maybe DesugaredType)
     (Located (Expr' Desugared))
     (Located (Expr' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Expr Desugared)
     (Expr Desugared)
     (Located (Expr' Desugared))
     (Located (Expr' Desugared))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Expr' Desugared), Maybe DesugaredType)
  (Located (Expr' Desugared), Maybe DesugaredType)
  (Located (Expr' Desugared))
  (Located (Expr' Desugared))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Expr Desugared)
  (Expr Desugared)
  (Located (Expr' Desugared))
  (Located (Expr' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Expr' Desugared))
     (Located (Expr' Desugared))
     SourceRegion
     SourceRegion
-&gt; Optic' A_Lens '[] (Expr Desugared) SourceRegion
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Expr' Desugared))
  (Located (Expr' Desugared))
  SourceRegion
  SourceRegion
forall a. HasSourceRegion a =&gt; Lens' a SourceRegion
</span><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier hs-var">sourceRegion</span></a></span><span>
</span><span id="line-635"></span><span>    </span><span id="local-6989586621680217321"><span class="annot"><a href="#local-6989586621680217321"><span class="hs-identifier hs-var">uniqueVn</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located VarName -&gt; Eff r (Located (Unique VarName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r) =&gt;
Located name -&gt; Eff r (Located (Unique name))
</span><a href="Elara.Rename.html#uniquify"><span class="hs-identifier hs-var">uniquify</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SourceRegion -&gt; VarName -&gt; Located VarName
forall a. SourceRegion -&gt; a -&gt; Located a
</span><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-var">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680217319"><span class="hs-identifier hs-var">patLocation</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621680217318"><span class="hs-identifier hs-var">vn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217322"><span class="annot"><a href="#local-6989586621680217322"><span class="hs-identifier hs-var hs-var">varRef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarRefImpl LocatedVarRefKind (Unique VarName) -&gt; VarRef VarName
forall (c :: VarRefKind) n. VarRefImpl c (Unique n) -&gt; VarRef' c n
</span><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-var">Local</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Unique VarName)
VarRefImpl LocatedVarRefKind (Unique VarName)
</span><a href="#local-6989586621680217321"><span class="hs-identifier hs-var">uniqueVn</span></a></span><span> </span><span class="annot"><span class="annottext">VarRef VarName
-&gt; Located (Unique VarName) -&gt; Located (VarRef VarName)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Unique VarName)
</span><a href="#local-6989586621680217321"><span class="hs-identifier hs-var">uniqueVn</span></a></span><span>
</span><span id="line-637"></span><span>    </span><span id="local-6989586621680217323"><span class="annot"><a href="#local-6989586621680217323"><span class="hs-identifier hs-var">pat'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renamePattern"><span class="hs-identifier hs-type">renamePattern</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217316"><span class="hs-identifier hs-type">pat</span></a></span><span>
</span><span id="line-638"></span><span>    </span><span id="local-6989586621680217324"><span class="annot"><a href="#local-6989586621680217324"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217317"><span class="hs-identifier hs-type">body</span></a></span><span>
</span><span id="line-639"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217325"><span class="annot"><a href="#local-6989586621680217325"><span class="hs-identifier hs-var hs-var">match</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-640"></span><span>            </span><span class="annot"><span class="annottext">RenamedExpr -&gt; [(RenamedPattern, RenamedExpr)] -&gt; Expr' Renamed
forall a (ast :: a).
Expr ast -&gt; [(Pattern ast, Expr ast)] -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Match"><span class="hs-identifier hs-var">Match</span></a></span><span>
</span><span id="line-641"></span><span>                </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(ASTLocate Renamed (Expr' Renamed),
 Select (ASTType ForExpr) Renamed)
-&gt; RenamedExpr
forall a (ast :: a).
(ASTLocate ast (Expr' ast), Select (ASTType ForExpr) ast)
-&gt; Expr ast
</span><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTLocate Renamed (Select ASTVarRef Renamed) -&gt; Expr' Renamed
forall a (ast :: a).
ASTLocate ast (Select ASTVarRef ast) -&gt; Expr' ast
</span><a href="Elara.AST.Generic.Types.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">Located (VarRef VarName)
ASTLocate Renamed (Select ASTVarRef Renamed)
</span><a href="#local-6989586621680217322"><span class="hs-identifier hs-var">varRef</span></a></span><span> </span><span class="annot"><span class="annottext">Expr' Renamed
-&gt; Located (Unique VarName) -&gt; Located (Expr' Renamed)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">Located (Unique VarName)
</span><a href="#local-6989586621680217321"><span class="hs-identifier hs-var">uniqueVn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Maybe RenamedType
Select (ASTType ForExpr) Renamed
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>                </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RenamedPattern
</span><a href="#local-6989586621680217323"><span class="hs-identifier hs-var">pat'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RenamedExpr
</span><a href="#local-6989586621680217324"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-643"></span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680217321"><span class="hs-identifier hs-type">uniqueVn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#enclosingRegion%27"><span class="hs-identifier hs-type">enclosingRegion'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217319"><span class="hs-identifier hs-type">patLocation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217320"><span class="hs-identifier hs-type">bodyLocation</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680217325"><span class="hs-identifier hs-type">match</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="annot"><span class="hs-comment">{- | Rename a lambda expression.
This is a little bit special because patterns have to be converted to match expressions.

For example,
@\(a, b) -&gt; a@  becomes @\ab_ -&gt; match ab_ with (a, b) -&gt; a@
-}</span></span><span>
</span><span id="line-652"></span><span id="local-6989586621680213164"><span class="annot"><a href="Elara.Rename.html#renameLambda"><span class="hs-identifier hs-type">renameLambda</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213164"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213164"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213164"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredPattern"><span class="hs-identifier hs-type">DesugaredPattern</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredExpr"><span class="hs-identifier hs-type">DesugaredExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213164"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedExpr%27"><span class="hs-identifier hs-type">RenamedExpr'</span></a></span></span><span>
</span><span id="line-653"></span><span id="renameLambda"><span class="annot"><span class="annottext">renameLambda :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Pattern Desugared -&gt; Expr Desugared -&gt; Eff r (Expr' Renamed)
</span><a href="Elara.Rename.html#renameLambda"><span class="hs-identifier hs-var hs-var">renameLambda</span></a></span></span><span> </span><span id="local-6989586621680217363"><span class="annot"><span class="annottext">p :: Pattern Desugared
</span><a href="#local-6989586621680217363"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CleanupLocated (ASTLocate' Desugared (Pattern' Desugared))
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680217364"><span class="annot"><span class="annottext">Select PatternType Desugared
</span><a href="#local-6989586621680217364"><span class="hs-identifier hs-var">argType</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621680217365"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217365"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-654"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621680217366"><span class="annot"><a href="#local-6989586621680217366"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621680217367"><span class="annot"><a href="#local-6989586621680217367"><span class="hs-identifier hs-var">match</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Pattern Desugared
-&gt; Expr Desugared -&gt; Eff r (Located (Unique VarName), RenamedExpr)
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Pattern Desugared
-&gt; Expr Desugared -&gt; Eff r (Located (Unique VarName), RenamedExpr)
</span><a href="Elara.Rename.html#patternToMatch"><span class="hs-identifier hs-var">patternToMatch</span></a></span><span> </span><span class="annot"><span class="annottext">Pattern Desugared
</span><a href="#local-6989586621680217363"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217365"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-655"></span><span>    </span><span id="local-6989586621680217368"><span class="annot"><a href="#local-6989586621680217368"><span class="hs-identifier hs-var">argType'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="annot"><a href="Elara.Rename.html#renameSimpleType"><span class="hs-identifier hs-type">renameSimpleType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217364"><span class="hs-identifier hs-type">argType</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217369"><span class="annot"><a href="#local-6989586621680217369"><span class="hs-identifier hs-var hs-var">arg'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Unique VarName -&gt; (Unique VarName, Maybe RenamedType))
-&gt; Located (Unique VarName)
-&gt; Located (Unique VarName, Maybe RenamedType)
forall a b. (a -&gt; b) -&gt; Located a -&gt; Located b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><span class="annottext">Maybe RenamedType
</span><a href="#local-6989586621680217368"><span class="hs-identifier hs-var">argType'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Located (Unique VarName)
</span><a href="#local-6989586621680217366"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-657"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Lambda"><span class="hs-identifier hs-type">Lambda</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypedLambdaParam"><span class="hs-identifier hs-type">TypedLambdaParam</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680217369"><span class="hs-identifier hs-type">arg'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680217367"><span class="hs-identifier hs-type">match</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>
</span><span id="line-659"></span><span id="local-6989586621680213153"><span class="annot"><a href="Elara.Rename.html#desugarBlock"><span class="hs-identifier hs-type">desugarBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#InnerRename"><span class="hs-identifier hs-type">InnerRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680213153"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff.Reader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213153"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Rock.html#Rock"><span class="hs-identifier hs-type">Rock.Rock</span></a></span><span> </span><span class="annot"><a href="Elara.Query.html#Query"><span class="hs-identifier hs-type">Elara.Query.Query</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621680213153"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredExpr"><span class="hs-identifier hs-type">DesugaredExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eff</span></span><span> </span><span class="annot"><a href="#local-6989586621680213153"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedExpr"><span class="hs-identifier hs-type">RenamedExpr</span></a></span></span><span>
</span><span id="line-660"></span><span id="desugarBlock"><span class="annot"><span class="annottext">desugarBlock :: forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
NonEmpty (Expr Desugared) -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#desugarBlock"><span class="hs-identifier hs-var hs-var">desugarBlock</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680217565"><span class="annot"><span class="annottext">e :: Expr Desugared
</span><a href="#local-6989586621680217565"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr%27"><span class="hs-identifier hs-type">Expr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621680217566"><span class="annot"><a href="#local-6989586621680217566"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (es :: [(* -&gt; *) -&gt; * -&gt; *]).
(HasCallStack, Reader r :&gt; es) =&gt;
Eff es r
</span><span class="hs-identifier hs-var">Eff.ask</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html#DesugaredDeclaration"><span class="hs-identifier hs-type">DesugaredDeclaration</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">throwError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.Error.html#BlockEndsWithLet"><span class="hs-identifier hs-type">BlockEndsWithLet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217565"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;body&quot;</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680217566"><span class="hs-identifier hs-type">decl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-663"></span><span class="annot"><a href="Elara.Rename.html#desugarBlock"><span class="hs-identifier hs-var">desugarBlock</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680217569"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217569"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217569"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-664"></span><span class="annot"><a href="Elara.Rename.html#desugarBlock"><span class="hs-identifier hs-var">desugarBlock</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680217570"><span class="annot"><span class="annottext">exp :: Expr Desugared
</span><a href="#local-6989586621680217570"><span class="hs-identifier hs-var">exp</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680217571"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680217571"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621680217572"><span class="annot"><span class="annottext">ASTLocate Desugared (Select LetParamName Desugared)
</span><a href="#local-6989586621680217572"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621680217573"><span class="annot"><span class="annottext">Select LetPattern Desugared
</span><a href="#local-6989586621680217573"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621680217574"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217574"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621680217575"><span class="annot"><span class="annottext">Select (ASTType ForExpr) Desugared
</span><a href="#local-6989586621680217575"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621680217576"><span class="annot"><span class="annottext">Expr Desugared
</span><a href="#local-6989586621680217576"><span class="hs-identifier hs-var">xs1</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621680217577"><span class="annot"><span class="annottext">[Expr Desugared]
</span><a href="#local-6989586621680217577"><span class="hs-identifier hs-var">xs'</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-665"></span><span>    </span><span id="local-6989586621680217578"><span class="annot"><a href="#local-6989586621680217578"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located VarName -&gt; Eff r (Located (Unique VarName))
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]) name.
(UniqueGen :&gt; r) =&gt;
Located name -&gt; Eff r (Located (Unique name))
</span><a href="Elara.Rename.html#uniquify"><span class="hs-identifier hs-var">uniquify</span></a></span><span> </span><span class="annot"><span class="annottext">Located VarName
ASTLocate Desugared (Select LetParamName Desugared)
</span><a href="#local-6989586621680217572"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-comment">-- TODO this is almost identical to the normal let case</span><span>
</span><span id="line-667"></span><span>    </span><span class="annot"><a href="Effectful.State.Extra.html#locally"><span class="hs-identifier hs-type">locally</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">the</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;varNames&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map.insert</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680217572"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">^.</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">one</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217578"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-668"></span><span>        </span><span id="local-6989586621680217579"><span class="annot"><a href="#local-6989586621680217579"><span class="hs-identifier hs-var">val'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-type">renameExpr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217574"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-669"></span><span>        </span><span id="local-6989586621680217580"><span class="annot"><a href="#local-6989586621680217580"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">traverse</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">traverseOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">_Unwrapped</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">_1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">%</span></span><span> </span><span class="annot"><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-type">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.html#renameType"><span class="hs-identifier hs-type">renameType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621680217575"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-670"></span><span>        </span><span id="local-6989586621680217581"><span class="annot"><a href="#local-6989586621680217581"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Elara.Rename.html#desugarBlock"><span class="hs-identifier hs-type">desugarBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621680217576"><span class="hs-identifier hs-type">xs1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span class="annot"><a href="#local-6989586621680217577"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217571"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#LetIn"><span class="hs-identifier hs-type">LetIn</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217578"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217573"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217579"><span class="hs-identifier hs-type">val'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217581"><span class="hs-identifier hs-type">block</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621680217580"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span class="annot"><a href="Elara.Rename.html#desugarBlock"><span class="hs-identifier hs-var">desugarBlock</span></a></span><span> </span><span id="local-6989586621680217582"><span class="annot"><span class="annottext">NonEmpty (Expr Desugared)
</span><a href="#local-6989586621680217582"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-673"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680217583"><span class="annot"><span class="annottext">loc :: SourceRegion
</span><a href="#local-6989586621680217583"><span class="hs-identifier hs-var hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NonEmpty SourceRegion -&gt; SourceRegion
</span><a href="Elara.AST.Region.html#spanningRegion%27"><span class="hs-identifier hs-var">spanningRegion'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty (Expr Desugared)
</span><a href="#local-6989586621680217582"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Expr Desugared)
-&gt; (Expr Desugared -&gt; SourceRegion) -&gt; NonEmpty SourceRegion
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr Desugared
-&gt; Optic' A_Lens '[] (Expr Desugared) SourceRegion -&gt; SourceRegion
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Expr Desugared)
  (Expr Desugared)
  (Located (Expr' Desugared), Maybe DesugaredType)
  (Located (Expr' Desugared), Maybe DesugaredType)
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Expr Desugared)
  (Expr Desugared)
  (Located (Expr' Desugared), Maybe DesugaredType)
  (Located (Expr' Desugared), Maybe DesugaredType)
-&gt; Optic
     A_Lens
     '[]
     (Located (Expr' Desugared), Maybe DesugaredType)
     (Located (Expr' Desugared), Maybe DesugaredType)
     (Located (Expr' Desugared))
     (Located (Expr' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Expr Desugared)
     (Expr Desugared)
     (Located (Expr' Desugared))
     (Located (Expr' Desugared))
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Expr' Desugared), Maybe DesugaredType)
  (Located (Expr' Desugared), Maybe DesugaredType)
  (Located (Expr' Desugared))
  (Located (Expr' Desugared))
forall s t a b. Field1 s t a b =&gt; Lens s t a b
</span><span class="hs-identifier hs-var">_1</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Expr Desugared)
  (Expr Desugared)
  (Located (Expr' Desugared))
  (Located (Expr' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Expr' Desugared))
     (Located (Expr' Desugared))
     SourceRegion
     SourceRegion
-&gt; Optic' A_Lens '[] (Expr Desugared) SourceRegion
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Expr' Desugared))
  (Located (Expr' Desugared))
  SourceRegion
  SourceRegion
forall a. HasSourceRegion a =&gt; Lens' a SourceRegion
</span><a href="Elara.AST.Region.html#sourceRegion"><span class="hs-identifier hs-var">sourceRegion</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>    </span><span id="local-6989586621680217585"><span class="annot"><a href="#local-6989586621680217585"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Expr Desugared -&gt; Eff r RenamedExpr)
-&gt; NonEmpty (Expr Desugared) -&gt; Eff r (NonEmpty RenamedExpr)
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; NonEmpty a -&gt; f (NonEmpty b)
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Expr Desugared -&gt; Eff r RenamedExpr
forall (r :: [(* -&gt; *) -&gt; * -&gt; *]).
(InnerRename r, Reader (Maybe (Declaration Desugared)) :&gt; r,
 Rock Query :&gt; r) =&gt;
Expr Desugared -&gt; Eff r RenamedExpr
</span><a href="Elara.Rename.html#renameExpr"><span class="hs-identifier hs-var">renameExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Expr Desugared)
</span><a href="#local-6989586621680217582"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-675"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Elara.AST.Generic.Types.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217583"><span class="hs-identifier hs-type">loc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span> </span><span class="annot"><a href="#local-6989586621680217585"><span class="hs-identifier hs-type">xs'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>
</span><span id="line-677"></span><span class="annot"><span class="hs-comment">-- | Checks if a type is recursive with respect to a target type, returning the use of the target type if so</span></span><span>
</span><span id="line-678"></span><span class="annot"><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-type">typeIsRecursive</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Renamed.html#RenamedType"><span class="hs-identifier hs-type">RenamedType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#TypeName"><span class="hs-identifier hs-type">TypeName</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span id="typeIsRecursive"><span class="annot"><span class="annottext">typeIsRecursive :: Qualified TypeName
-&gt; RenamedType -&gt; Maybe (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-var hs-var">typeIsRecursive</span></a></span></span><span> </span><span id="local-6989586621680217596"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217596"><span class="hs-identifier hs-var">targetType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Generic.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span id="local-6989586621680217597"><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680217597"><span class="hs-identifier hs-var">useSiteLocation</span></a></span></span><span> </span><span id="local-6989586621680217598"><span class="annot"><span class="annottext">Type' Renamed
</span><a href="#local-6989586621680217598"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Select TypeKind Renamed
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type' Renamed
</span><a href="#local-6989586621680217598"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-680"></span><span>    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeVar"><span class="hs-identifier hs-type">TypeVar</span></a></span><span> </span><span class="annot"><span class="annottext">ASTLocate Renamed (Select ASTTypeVar Renamed)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Located (Qualified TypeName))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-681"></span><span>    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#FunctionType"><span class="hs-identifier hs-type">FunctionType</span></a></span><span> </span><span id="local-6989586621680217599"><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217599"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680217600"><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217600"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; RenamedType -&gt; Maybe (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-var">typeIsRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217596"><span class="hs-identifier hs-var">targetType</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217599"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Located (Qualified TypeName))
-&gt; Maybe (Located (Qualified TypeName))
-&gt; Maybe (Located (Qualified TypeName))
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; RenamedType -&gt; Maybe (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-var">typeIsRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217596"><span class="hs-identifier hs-var">targetType</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217600"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#UnitType"><span class="hs-identifier hs-type">UnitType</span></a></span><span> </span><span class="annot"><span class="annottext">Select UnitTypeInfo Renamed
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Located (Qualified TypeName))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#TypeConstructorApplication"><span class="hs-identifier hs-type">TypeConstructorApplication</span></a></span><span> </span><span id="local-6989586621680217602"><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217602"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621680217603"><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217603"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; RenamedType -&gt; Maybe (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-var">typeIsRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217596"><span class="hs-identifier hs-var">targetType</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217602"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Located (Qualified TypeName))
-&gt; Maybe (Located (Qualified TypeName))
-&gt; Maybe (Located (Qualified TypeName))
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; RenamedType -&gt; Maybe (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-var">typeIsRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217596"><span class="hs-identifier hs-var">targetType</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217603"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#UserDefinedType"><span class="hs-identifier hs-type">UserDefinedType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621680217604"><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217604"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-685"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217604"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName -&gt; Qualified TypeName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217596"><span class="hs-identifier hs-var">targetType</span></a></span><span>
</span><span id="line-686"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Located (Qualified TypeName)
-&gt; Maybe (Located (Qualified TypeName))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217604"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName -&gt; SourceRegion -&gt; Located (Qualified TypeName)
forall b a. HasSourceRegion b =&gt; a -&gt; b -&gt; Located a
</span><a href="Elara.AST.Region.html#withLocationOf"><span class="hs-operator hs-var">`withLocationOf`</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><a href="#local-6989586621680217597"><span class="hs-identifier hs-var">useSiteLocation</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-687"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe (Located (Qualified TypeName))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-688"></span><span>    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#RecordType"><span class="hs-identifier hs-type">RecordType</span></a></span><span> </span><span id="local-6989586621680217605"><span class="annot"><span class="annottext">NonEmpty (ASTLocate Renamed LowerAlphaName, RenamedType)
</span><a href="#local-6989586621680217605"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Maybe (Located (Qualified TypeName)))
-&gt; Maybe (Located (Qualified TypeName))
forall (t :: * -&gt; *) (f :: * -&gt; *) a.
(Foldable t, Alternative f) =&gt;
t (f a) -&gt; f a
</span><span class="hs-identifier hs-var">asum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Located LowerAlphaName, RenamedType)
 -&gt; Maybe (Located (Qualified TypeName)))
-&gt; NonEmpty (Located LowerAlphaName, RenamedType)
-&gt; NonEmpty (Maybe (Located (Qualified TypeName)))
forall a b. (a -&gt; b) -&gt; NonEmpty a -&gt; NonEmpty b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; RenamedType -&gt; Maybe (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-var">typeIsRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217596"><span class="hs-identifier hs-var">targetType</span></a></span><span> </span><span class="annot"><span class="annottext">(RenamedType -&gt; Maybe (Located (Qualified TypeName)))
-&gt; ((Located LowerAlphaName, RenamedType) -&gt; RenamedType)
-&gt; (Located LowerAlphaName, RenamedType)
-&gt; Maybe (Located (Qualified TypeName))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Located LowerAlphaName, RenamedType) -&gt; RenamedType
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Located LowerAlphaName, RenamedType)
NonEmpty (ASTLocate Renamed LowerAlphaName, RenamedType)
</span><a href="#local-6989586621680217605"><span class="hs-identifier hs-var">fields</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>    </span><span class="annot"><a href="Elara.AST.Generic.Types.html#ListType"><span class="hs-identifier hs-type">ListType</span></a></span><span> </span><span id="local-6989586621680217608"><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217608"><span class="hs-identifier hs-var">t'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
-&gt; RenamedType -&gt; Maybe (Located (Qualified TypeName))
</span><a href="Elara.Rename.html#typeIsRecursive"><span class="hs-identifier hs-var">typeIsRecursive</span></a></span><span> </span><span class="annot"><span class="annottext">Qualified TypeName
</span><a href="#local-6989586621680217596"><span class="hs-identifier hs-var">targetType</span></a></span><span> </span><span class="annot"><span class="annottext">RenamedType
</span><a href="#local-6989586621680217608"><span class="hs-identifier hs-var">t'</span></a></span><span>
</span><span id="line-690"></span></pre></body></html>