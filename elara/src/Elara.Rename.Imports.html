<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="annot"><span class="hs-comment">-- | This module mostly just exists to be a circuit breaker :)</span></span><span>
</span><span id="line-2"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Elara.Rename.Imports.html"><span class="hs-identifier">Elara.Rename.Imports</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.Rename.Imports.html#isImportedBy"><span class="hs-identifier">isImportedBy</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics.Product</span></span><span>
</span><span id="line-5"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics.Wrapped</span></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Desugared.html"><span class="hs-identifier">Elara.AST.Desugared</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Module.html"><span class="hs-identifier">Elara.AST.Module</span></a></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Name.html"><span class="hs-identifier">Elara.AST.Name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier">MaybeQualified</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier">ModuleName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier">Qualified</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Region.html"><span class="hs-identifier">Elara.AST.Region</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.Select.html"><span class="hs-identifier">Elara.AST.Select</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html"><span class="hs-identifier">Elara.AST.VarRef</span></a></span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="annot"><span class="hs-comment">{- | Tests that m imports n
This is determined by 2 conditions:
n's module name is in the import list of m
n is exposed by the import
-}</span></span><span>
</span><span id="line-18"></span><span class="annot"><a href="Elara.Rename.Imports.html#isImportedBy"><span class="hs-identifier hs-type">isImportedBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.VarRef.html#VarRef"><span class="hs-identifier hs-type">VarRef</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-19"></span><span id="isImportedBy"><span class="annot"><span class="annottext">isImportedBy :: Module Desugared -&gt; VarRef Name -&gt; Bool
</span><a href="Elara.Rename.Imports.html#isImportedBy"><span class="hs-identifier hs-var hs-var">isImportedBy</span></a></span></span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Local"><span class="hs-identifier hs-type">Local</span></a></span><span> </span><span class="annot"><span class="annottext">VarRefImpl LocatedVarRefKind (Unique Name)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-comment">-- we always assume a local variable exists, even if it doesn't. this condition is checked elsewhere</span><span>
</span><span id="line-20"></span><span class="annot"><a href="Elara.Rename.Imports.html#isImportedBy"><span class="hs-identifier hs-var">isImportedBy</span></a></span><span> </span><span id="local-6989586621680158557"><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680158557"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.VarRef.html#Global"><span class="hs-identifier hs-type">Global</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Region.html#Located"><span class="hs-identifier hs-type">Located</span></a></span><span> </span><span class="annot"><span class="annottext">SourceRegion
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#Qualified"><span class="hs-identifier hs-type">Qualified</span></a></span><span> </span><span id="local-6989586621680158561"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680158561"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621680158562"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158562"><span class="hs-identifier hs-var">nameMod</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-21"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158562"><span class="hs-identifier hs-var">nameMod</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ModuleName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680158557"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module' Desugared)
     (Module' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Module Desugared -&gt; Name -&gt; ModuleName -&gt; Bool
</span><a href="#local-6989586621680158569"><span class="hs-identifier hs-var">isImportedBy'</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680158557"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680158561"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158562"><span class="hs-identifier hs-var">nameMod</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>    </span><span class="annot"><a href="#local-6989586621680158569"><span class="hs-identifier hs-type">isImportedBy'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Module"><span class="hs-identifier hs-type">Module</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-24"></span><span>    </span><span id="local-6989586621680158569"><span class="annot"><span class="annottext">isImportedBy' :: Module Desugared -&gt; Name -&gt; ModuleName -&gt; Bool
</span><a href="#local-6989586621680158569"><span class="hs-identifier hs-var hs-var">isImportedBy'</span></a></span></span><span> </span><span id="local-6989586621680158570"><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680158570"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span id="local-6989586621680158571"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680158571"><span class="hs-identifier hs-var">n'</span></a></span></span><span> </span><span id="local-6989586621680158572"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158572"><span class="hs-identifier hs-var">nameMod</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-25"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680158573"><span class="annot"><span class="annottext">mn :: ModuleName
</span><a href="#local-6989586621680158573"><span class="hs-identifier hs-var hs-var hs-var">mn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680158570"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName -&gt; ModuleName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module' Desugared)
     (Module' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;name&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Module Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-26"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680158574"><span class="annot"><span class="annottext">imports' :: [Import Desugared]
</span><a href="#local-6989586621680158574"><span class="hs-identifier hs-var hs-var">imports'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Module Desugared
</span><a href="#local-6989586621680158570"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Module Desugared
-&gt; Optic' A_Lens '[] (Module Desugared) [Import Desugared]
-&gt; [Import Desugared]
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Module Desugared)
  (Module Desugared)
  (Located (Module' Desugared))
  (Located (Module' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Module' Desugared))
     (Located (Module' Desugared))
     (Module' Desugared)
     (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module Desugared)
     (Module Desugared)
     (Module' Desugared)
     (Module' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Module' Desugared))
  (Located (Module' Desugared))
  (Module' Desugared)
  (Module' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Module Desugared)
  (Module Desugared)
  (Module' Desugared)
  (Module' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Module' Desugared)
     (Module' Desugared)
     [Import Desugared]
     [Import Desugared]
-&gt; Optic' A_Lens '[] (Module Desugared) [Import Desugared]
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;imports&quot;</span></span><span>
</span><span id="line-27"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; [Import Desugared] -&gt; Maybe (Import Desugared)
</span><a href="#local-6989586621680158575"><span class="hs-identifier hs-var">findImport</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158572"><span class="hs-identifier hs-var">nameMod</span></a></span><span> </span><span class="annot"><span class="annottext">[Import Desugared]
</span><a href="#local-6989586621680158574"><span class="hs-identifier hs-var">imports'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-28"></span><span>            </span><span class="annot"><span class="annottext">Maybe (Import Desugared)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-29"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621680158576"><span class="annot"><span class="annottext">Import Desugared
</span><a href="#local-6989586621680158576"><span class="hs-identifier hs-var">imp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-30"></span><span>                </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621680158577"><span class="annot"><span class="annottext">exposing' :: Exposing Desugared
</span><a href="#local-6989586621680158577"><span class="hs-identifier hs-var hs-var">exposing'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Import Desugared
</span><a href="#local-6989586621680158576"><span class="hs-identifier hs-var">imp</span></a></span><span> </span><span class="annot"><span class="annottext">Import Desugared
-&gt; Optic' A_Lens '[] (Import Desugared) (Exposing Desugared)
-&gt; Exposing Desugared
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Import' Desugared))
     (Located (Import' Desugared))
     (Import' Desugared)
     (Import' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Import Desugared)
     (Import Desugared)
     (Import' Desugared)
     (Import' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Import' Desugared))
  (Located (Import' Desugared))
  (Import' Desugared)
  (Import' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Import Desugared)
  (Import Desugared)
  (Import' Desugared)
  (Import' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Import' Desugared)
     (Import' Desugared)
     (Exposing Desugared)
     (Exposing Desugared)
-&gt; Optic' A_Lens '[] (Import Desugared) (Exposing Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;exposing&quot;</span></span><span>
</span><span id="line-31"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Exposing Desugared
</span><a href="#local-6989586621680158577"><span class="hs-identifier hs-var">exposing'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-32"></span><span>                    </span><span class="annot"><span class="annottext">Exposing Desugared
</span><a href="Elara.AST.Module.html#ExposingAll"><span class="hs-identifier hs-var">ExposingAll</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-33"></span><span>                    </span><span class="annot"><a href="Elara.AST.Module.html#ExposingSome"><span class="hs-identifier hs-type">ExposingSome</span></a></span><span> </span><span id="local-6989586621680158580"><span class="annot"><span class="annottext">[Exposition Desugared]
</span><a href="#local-6989586621680158580"><span class="hs-identifier hs-var">es</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Exposition Desugared -&gt; Bool) -&gt; [Exposition Desugared] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Name -&gt; Exposition Desugared -&gt; Bool
</span><a href="#local-6989586621680158582"><span class="hs-identifier hs-var">isExposition</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158573"><span class="hs-identifier hs-var">mn</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621680158571"><span class="hs-identifier hs-var">n'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Exposition Desugared]
</span><a href="#local-6989586621680158580"><span class="hs-identifier hs-var">es</span></a></span><span>
</span><span id="line-34"></span><span>    </span><span class="annot"><a href="#local-6989586621680158575"><span class="hs-identifier hs-type">findImport</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Elara.AST.Module.html#Import"><span class="hs-identifier hs-type">Import</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#Import"><span class="hs-identifier hs-type">Import</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>    </span><span id="local-6989586621680158575"><span class="annot"><span class="annottext">findImport :: ModuleName -&gt; [Import Desugared] -&gt; Maybe (Import Desugared)
</span><a href="#local-6989586621680158575"><span class="hs-identifier hs-var hs-var">findImport</span></a></span></span><span> </span><span id="local-6989586621680158583"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158583"><span class="hs-identifier hs-var">mn'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Import Desugared -&gt; Bool)
-&gt; [Import Desugared] -&gt; Maybe (Import Desugared)
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><span class="hs-identifier hs-var">find</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158583"><span class="hs-identifier hs-var">mn'</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName -&gt; ModuleName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ModuleName -&gt; Bool)
-&gt; (Import Desugared -&gt; ModuleName) -&gt; Import Desugared -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] (Import Desugared) ModuleName
-&gt; Import Desugared -&gt; ModuleName
forall k (is :: IxList) s a.
Is k A_Getter =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
forall s t a b. Wrapped s t a b =&gt; Iso s t a b
</span><span class="hs-identifier hs-var">_Unwrapped</span></span><span> </span><span class="annot"><span class="annottext">Iso
  (Import Desugared)
  (Import Desugared)
  (Located (Import' Desugared))
  (Located (Import' Desugared))
-&gt; Optic
     A_Lens
     '[]
     (Located (Import' Desugared))
     (Located (Import' Desugared))
     (Import' Desugared)
     (Import' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Import Desugared)
     (Import Desugared)
     (Import' Desugared)
     (Import' Desugared)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located (Import' Desugared))
  (Located (Import' Desugared))
  (Import' Desugared)
  (Import' Desugared)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Import Desugared)
  (Import Desugared)
  (Import' Desugared)
  (Import' Desugared)
-&gt; Optic
     A_Lens
     '[]
     (Import' Desugared)
     (Import' Desugared)
     (Located ModuleName)
     (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Import Desugared)
     (Import Desugared)
     (Located ModuleName)
     (Located ModuleName)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">forall (field :: Symbol) s a. HasField' field s a =&gt; Lens s s a a
</span><span class="hs-identifier hs-var">field'</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;importing&quot;</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Import Desugared)
  (Import Desugared)
  (Located ModuleName)
  (Located ModuleName)
-&gt; Optic
     A_Lens
     '[]
     (Located ModuleName)
     (Located ModuleName)
     ModuleName
     ModuleName
-&gt; Optic' A_Lens '[] (Import Desugared) ModuleName
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Lens
  '[]
  (Located ModuleName)
  (Located ModuleName)
  ModuleName
  ModuleName
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><a href="#local-6989586621680158582"><span class="hs-identifier hs-type">isExposition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#ModuleName"><span class="hs-identifier hs-type">ModuleName</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Name.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Elara.AST.Module.html#Exposition"><span class="hs-identifier hs-type">Exposition</span></a></span><span> </span><span class="annot"><a href="Elara.AST.Select.html#Desugared"><span class="hs-identifier hs-type">Desugared</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-38"></span><span>    </span><span id="local-6989586621680158582"><span class="annot"><span class="annottext">isExposition :: ModuleName -&gt; Name -&gt; Exposition Desugared -&gt; Bool
</span><a href="#local-6989586621680158582"><span class="hs-identifier hs-var hs-var">isExposition</span></a></span></span><span> </span><span id="local-6989586621680158587"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158587"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NVarName"><span class="hs-identifier hs-type">NVarName</span></a></span><span> </span><span id="local-6989586621680158589"><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621680158589"><span class="hs-identifier hs-var">vn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedValue"><span class="hs-identifier hs-type">ExposedValue</span></a></span><span> </span><span id="local-6989586621680158591"><span class="annot"><span class="annottext">FullASTQual Desugared VarName
</span><a href="#local-6989586621680158591"><span class="hs-identifier hs-var">vn'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">VarName -&gt; Maybe ModuleName -&gt; MaybeQualified VarName
forall name. name -&gt; Maybe ModuleName -&gt; MaybeQualified name
</span><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-var">MaybeQualified</span></a></span><span> </span><span class="annot"><span class="annottext">VarName
</span><a href="#local-6989586621680158589"><span class="hs-identifier hs-var">vn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Maybe ModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158587"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaybeQualified VarName -&gt; MaybeQualified VarName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
FullASTQual Desugared VarName
</span><a href="#local-6989586621680158591"><span class="hs-identifier hs-var">vn'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified VarName)
-&gt; Optic'
     A_Lens
     '[]
     (Located (MaybeQualified VarName))
     (MaybeQualified VarName)
-&gt; MaybeQualified VarName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  '[]
  (Located (MaybeQualified VarName))
  (MaybeQualified VarName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="#local-6989586621680158582"><span class="hs-identifier hs-var">isExposition</span></a></span><span> </span><span id="local-6989586621680158593"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158593"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-type">NTypeName</span></a></span><span> </span><span id="local-6989586621680158595"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680158595"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedType"><span class="hs-identifier hs-type">ExposedType</span></a></span><span> </span><span id="local-6989586621680158597"><span class="annot"><span class="annottext">FullASTQual Desugared TypeName
</span><a href="#local-6989586621680158597"><span class="hs-identifier hs-var">tn'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Maybe ModuleName -&gt; MaybeQualified TypeName
forall name. name -&gt; Maybe ModuleName -&gt; MaybeQualified name
</span><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-var">MaybeQualified</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680158595"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Maybe ModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158593"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaybeQualified TypeName -&gt; MaybeQualified TypeName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
FullASTQual Desugared TypeName
</span><a href="#local-6989586621680158597"><span class="hs-identifier hs-var">tn'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Optic'
     A_Lens
     '[]
     (Located (MaybeQualified TypeName))
     (MaybeQualified TypeName)
-&gt; MaybeQualified TypeName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  '[]
  (Located (MaybeQualified TypeName))
  (MaybeQualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="#local-6989586621680158582"><span class="hs-identifier hs-var">isExposition</span></a></span><span> </span><span id="local-6989586621680158598"><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158598"><span class="hs-identifier hs-var">mn</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Name.html#NTypeName"><span class="hs-identifier hs-type">NTypeName</span></a></span><span> </span><span id="local-6989586621680158599"><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680158599"><span class="hs-identifier hs-var">tn</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Elara.AST.Module.html#ExposedTypeAndAllConstructors"><span class="hs-identifier hs-type">ExposedTypeAndAllConstructors</span></a></span><span> </span><span id="local-6989586621680158601"><span class="annot"><span class="annottext">FullASTQual Desugared TypeName
</span><a href="#local-6989586621680158601"><span class="hs-identifier hs-var">tn'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeName -&gt; Maybe ModuleName -&gt; MaybeQualified TypeName
forall name. name -&gt; Maybe ModuleName -&gt; MaybeQualified name
</span><a href="Elara.AST.Name.html#MaybeQualified"><span class="hs-identifier hs-var">MaybeQualified</span></a></span><span> </span><span class="annot"><span class="annottext">TypeName
</span><a href="#local-6989586621680158599"><span class="hs-identifier hs-var">tn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModuleName -&gt; Maybe ModuleName
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><a href="#local-6989586621680158598"><span class="hs-identifier hs-var">mn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MaybeQualified TypeName -&gt; MaybeQualified TypeName -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
FullASTQual Desugared TypeName
</span><a href="#local-6989586621680158601"><span class="hs-identifier hs-var">tn'</span></a></span><span> </span><span class="annot"><span class="annottext">Located (MaybeQualified TypeName)
-&gt; Optic'
     A_Lens
     '[]
     (Located (MaybeQualified TypeName))
     (MaybeQualified TypeName)
-&gt; MaybeQualified TypeName
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic'
  A_Lens
  '[]
  (Located (MaybeQualified TypeName))
  (MaybeQualified TypeName)
forall a b. Lens (Located a) (Located b) a b
</span><a href="Elara.AST.Region.html#unlocated"><span class="hs-identifier hs-var">unlocated</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="#local-6989586621680158582"><span class="hs-identifier hs-var">isExposition</span></a></span><span> </span><span class="annot"><span class="annottext">ModuleName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Exposition Desugared
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-42"></span></pre></body></html>